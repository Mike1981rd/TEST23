@{
    Layout = null;
    var reasons = (List<CancelReason>)ViewBag.CancelReasons;
    var tables = (List<AreaObject>)ViewBag.AnotherTables;
    var products = (List<Product>)ViewBag.Products;
    var areas = (List<Area>)ViewBag.AnotherAreas;
    var discountType = (string)ViewBag.DiscountType;
    var discounts = (List<Discount>)ViewBag.Discounts;
}
@model Order

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0">
    <meta name="description" content="POS - Alfa Software">
    <meta name="keywords" content="admin, estimates, bootstrap, business, corporate, creative, management, minimal, modern,  html5, responsive">
    <meta name="author" content="Dreamguys - Bootstrap Admin Template">
    <meta name="robots" content="noindex, nofollow">
    <title>ALFA POS</title>
    <!-- Favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="/vendor/img/favicon.png">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="/vendor/css/bootstrap.min.css">

    <!-- Datatable CSS -->
    <link rel="stylesheet" href="/vendor/css/dataTables.bootstrap4.min.css">

    <!-- Fontawesome CSS -->
    <link rel="stylesheet" href="/vendor/plugins/fontawesome/css/fontawesome.min.css">
    <link rel="stylesheet" href="/vendor/plugins/fontawesome/css/all.min.css">

    <!-- Select2 CSS -->
    <link rel="stylesheet" href="/vendor/plugins/select2/css/select2.min.css">

    <!-- Main CSS -->
    <link rel="stylesheet" href="/vendor/css/style.css">


    <!-- jQuery -->
    <script src="/vendor/js/jquery-3.6.0.min.js"></script>
    <!-- Feather Icon JS -->
    <script src="/vendor/js/feather.min.js"></script>

    <!-- Slimscroll JS -->
    <script src="/vendor/js/jquery.slimscroll.min.js"></script>

    <!-- Bootstrap Core JS -->
    <script src="/vendor/js/bootstrap.bundle.min.js"></script>

    <!-- Datatable JS -->
    <script src="/vendor/js/jquery.dataTables.min.js"></script>
    <script src="/vendor/js/dataTables.bootstrap4.min.js"></script>

    <!-- Select2 JS -->
    <script src="/vendor/plugins/select2/js/select2.min.js"></script>

    <!-- Owl JS -->
    <script src="/vendor/plugins/owlcarousel/owl.carousel.min.js"></script>

    <!-- Sweetalert 2 -->
    <script src="/vendor/plugins/sweetalert/sweetalert2.all.min.js"></script>
    <script src="/vendor/plugins/sweetalert/sweetalerts.min.js"></script>

    <!-- Toatr CSS -->
    <link rel="stylesheet" href="~/vendor/plugins/toastr/toatr.css">    

    <!-- Mask JS -->
    <script src="~/vendor/plugins/toastr/toastr.min.js"></script>
    <script src="~/vendor/plugins/toastr/toastr.js"></script>
    <script src="~/vendor/js/jquery.mask.js"></script>
    <!-- Custom JS -->
    <script src="/vendor/js/script.js"></script>
    <style>
        ::-webkit-scrollbar {
            width: 0px;
            height: 0px !important;
        }

        .contenedor {
            position: relative;
            background-color: transparent;
            border: 2px solid rgba(145, 158, 171, 0.32);
            border-radius: 15px;
            padding: 20px;
            padding-top: 40px;
        }

        .titulo {
            position: absolute;
            top: -20px;
            left: 10px;
            background-color: #1d1d1d;
            z-index: 2;
            padding: 5px 10px;
        }


        .contenedor::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 40px;
            height: 40px;
            background-color: transparent;
            border-top-left-radius: 20px;
            z-index: 1;
        }

        .main-page-sales {
            display: flex;
            flex-direction: column;
            width: 100vw;
            height: 100vh;
            background: #000100;
            gap: 4px;
        }

        .header-info {
            width: 100%;
            height: 8%;
            background: #222d42;
            display: flex;
            padding: 4px;
            flex-direction: row;
            justify-content: left;
            align-items: center;
        }

        .main-content {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: row;
            padding-left: 4px;
            padding-right: 4px;
            overflow: hidden;
        }

        .footer-menu {
            width: 100%;
            height: 10%;
            display: flex;
            flex-direction: row;
            background: #171525;
            gap: 4px;
        }

        .cuenta-side-menu {
            width: 40%;
            height: 100%;
            display: flex;
            flex-direction: column;
            gap: 4px;
            border-radius: 4px;
            background: #171525;
        }

        .elements-main-menu {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            gap: 4px;
            overflow: hidden;
        }

        .user-info-container {
            all: unset;
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: space-around;
            height: auto;
            background: #1f2b41;
            gap: 4px;
            background: #202b41;
            padding: 2px;
        }

        .order-info-menu {
            all: unset;
            display: flex;
            height: 100%;
            flex-direction: column;
            justify-content: space-between;
            border-radius: 4px;
            overflow: hidden;
            padding: 6px;
        }

        .table-body {
            all: unset;
            overflow: hidden;
            overflow-y: scroll;
            background: none;
            border-radius: 0;
            background: #171525;
        }

        .order-table {
            margin: 0;
            height: 100%;
            overflow: hidden;
        }

            .order-table > .table {
                overflow-x: hidden;
                overflow-y: auto;
                height: 100%;
            }

        .order-summary {
            all: unset;
            /* border-top: solid 1px #A0A0A0; */
            padding: 4px;
        }

        .order-info-options {
            width: 100%;
            padding: 4px;
        }

        .bottom-grid {
            all: unset;
            display: flex;
            flex-direction: row;
            gap: 4px;
        }


        .btn-modern {
            background-color: #171525 !important;
            color: white;
            width: 100%;
            border-radius: 0px;
        }

        .btn-modern-small {
            width: 130px;
        }

        #order-cancel, #order-save, #order-print, #order-pay {
            background-color: #425dcf !important;
        }

            #order-cancel:hover, #order-save:hover, #order-print:hover, #order-pay:hover {
                background-color: #434e64 !important;
            }

        #order-cancel {
            background-color: #413d5a !important;
            color: red;
        }

        #order-pay {
            background-color: #00906a !important;
        }

        .btn-modern:hover {
            background-color: #413d5a !important;
            color: white;
        }

        .user-cuenta-container {
            display: flex;
            flex-direction: column;
            width: 100%;
            height: 100%;
            justify-content: space-between;
            background: #171525;
            border-radius: 4px;
            overflow: hidden;
            flex-wrap: wrap;
        }

        .kiosk-category-panel {
            display: flex;
            flex-direction: column;
            width: 20%;
            height: 100%;
            padding: 0;
            overflow-x: hidden;
            overflow-y: hidden;
            background: #171525;
            border-radius: 4px;
        }

        .category-item-container {
            width: 100%;
            height: 100%;
            padding: 0;
            border-radius: 4px;
        }

        .category-item-kiosk {
            background: none;
            border: none;
            border-bottom: solid 1px #A0A0A0;
            border-radius: 0;
        }

        .active {
            background: #425dcf !important;
        }

        .category-item-kiosk:hover {
            background: #425dcf !important;
            color: white;
        }

        .items-qty-container {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .qty-panel-container {
            display: flex;
            flex-direction: row;
            background: #171525;
            padding: 4px;
            gap: 4px;
            border-radius: 4px;
        }

        .kiosk-qty {
            min-width: 15%;
            padding: 0px;
            border-radius: 4px;
            margin-bottom: 0;
            font-size: 16px !important;
        }

        .kiosk-qty-keyboard {
            background: #202c42;
            border: 0;
            border-radius: 4px;
            padding: 0;
            font-size: 16px !important;
            margin: 0;
        }

            .kiosk-qty-keyboard:hover {
                background: #425dcf;
                color: white;
            }

        .product-panels-container {
            display: flex;
            flex-direction: column;
            width: 100%;
            height: 100%;
            overflow: hidden;
            gap: 8px;
        }

        .product-panel-main-kiosk {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr;
            grid-template-rows: repeat(auto-fill, minmax(100px, auto)); /* Fila mínima de 20px */
            height: 100%;
            overflow: hidden;
            overflow-y: auto;
            overflow-x: hidden;
            gap: 8px;
        }

        .static-product-panel-main {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: repeat(auto-fill, minmax(auto, auto)); /* Fila mínima de 20px */
            height: 100%;
            overflow: hidden;
            overflow-y: scroll !important;
            overflow-x: hidden;
            gap: 8px;
        }

        .product-item-kiosk {
            all: unset;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            width: 100%;
            /* border-radius: 4px; */
            border-top: none !important;
            border-left: none !important;
            border-right: none !important;
            border-bottom: solid 4px #9E1B32;
            background: #343f54 !important;
            min-height: 100px;
            position: relative;
            overflow: hidden; /* Asegura que nada se desborde */
        }

            .product-item-kiosk > h5 {
                margin: 0;
                text-align: center;
                padding: 8px;
            }

            .product-item-kiosk > img {
                width: 100%; /* Hace que la imagen ocupe todo el ancho del div */
                height: 100%; /* Hace que la imagen ocupe toda la altura del div */
                object-fit: cover; /* Asegura que la imagen cubra el área sin distorsionarse */
                object-position: center; /* Centra la imagen dentro del div */
            }

        .total {
            color: #425dcf;
            font-size: 20px !important;
            font-weight: bold;
        }
        
        .sub-total > span {
            color: #c1c1c1;
        }

        .sub-total:hover {
            background: #425dcf;
        }

        .product-item-kiosk > .card-img-overlay {
            background: rgba(52,63,84,0.8) !important;
            transition: all 0.1s ease-in;
        }

        .product-item-kiosk:hover > .card-img-overlay {
            background: #434e64 !important;
            border-radius: 0px;
        }

        .product-item-kiosk:hover {
            background: #434e64 !important;
            cursor: pointer;
            border-bottom: solid 4px white !important;

        }

        .product-title {
            text-align: center;
        }

        .card-img {
            border-radius: 0px;
        }

        .order-item:hover {
            background: rgba(255,255,255,0.1);
            cursor: pointer;
        }

        .order-item {
            background: #222e44;
        }

        .btn-primary {
            background-color: #425dcf !important;
            border-color: #425dcf !important;
        }

        .btn-label-secondary {
            background-color: #171525 !important;
            color: white;
            border-radius: 4px;
        }

        .serving-size-item {
            background: #343f54 !important;
        }

            .serving-size-item:hover {
                background: #434e64 !important;
                cursor: pointer;
            }
        .sales-order-persons {

        }

        .tr {
            border-bottom: solid 4px #171525;
        }

        .user-info-option {
            display: flex;
            flex-direction: row;
            justify-content: center;
            align-items: center;
            padding: 4px;
            flex-wrap: wrap;
            font-weight: bold;
            height: 90%;
        }

        .info-option {
            display: flex;
            flex-direction: row;
            justify-content: center;
            align-items: center;
            padding: 4px;
            background: rgba(255,255,255,0.01);
            flex-wrap: wrap;
            height: 90%;
            font-weight: bold;
        }

        .btn-nostyle {
            all: unset;
            display: flex;
            flex-direction: row;
            justify-content: center;
            align-items: center;
            padding: 4px;
            font-weight: bold;
            height: fit-content;
        }

        .btn-nostyle:hover {
            /* background-color: rgba(255,255,255,0.2) !important; */
            border-bottom: 2px solid white;
                        color: #425dcf !important;


        }

        .active {
            color: #425dcf !important;
            background-color: unset !important;
            border-bottom: 2px solid white;
        }

        .primary-menu-tab {
            width: 100%;
            display: flex;
            flex-direction: row;
            padding: 8px;
            gap: 8px;
            overflow: hidden;
            justify-content: space-between;
            align-items: center;
        }

        #mode, #group-panel-main{
            padding: 0px;
            display: flex;
            gap: 8px;
            flex-direction: row;
            align-items: center;

        }

        .secondary-menu-tab {
            width: 100%;
            display: flex;
            flex-direction: row;
            align-items: flex-end;
            padding: 8px;
            padding-bottom: 0px;
            background: #7a89a6;
            gap: -5px;
            overflow: hidden;
            overflow-x: auto;
        }

        .button3 {
            border-radius: 6px 6px 0px 0px;
            min-width: 150px;
            clip-path: polygon(20% 0%, 80% 0%, 100% 100%, 0% 100%); /* Forma de trapecio */
            background: #343f54;
            border: none;
            font-weight: bold;
            padding: .2rem 1rem;
            height: 100%;
            transition: all ease-in 0.05s;
        }

        .btn.button3.active, .btn.button3:hover {
            background: #000100 !important;
            color: #425dcf !important;
            /* border-top: 2px solid white; */
            padding: .375rem 1rem;

        }

        .sub-category > div{
            flex-direction: row;
        }

        .sub-category {
            width: 100% !important;
            overflow: hidden;
            height: fit-content !important;
        }

        .main {
            overflow: hidden;
            width: 100% !important;
            height: 100%;
        }

        .product-card-title {
            padding: 0;
            height: auto;
        }

        .products-footer {
            display:flex;
            width: 100%;
            flex-direction: row;
            justify-content: space-between;
            align-items: center;
            padding: 4px;
        }


        .more-menu-container {
            position: relative;
            
        }

        .more-menu {
            position: fixed;
            background: #171525;
            display: flex;
            flex-direction: column;
            justify-content: left;
            align-items: flex-start;
            border-radius: 12px;
            padding: 16px;
            gap: 8px;
            top: 0;
            transform: translate(-100%,5%);
            z-index: 2;
        }

        .button-icon-container {
            display: flex;
            flex-direction: row;
            justify-content: center;
            align-items: center;
            gap: 2px;
        }
    </style>
</head>
<body data-theme="dark">
    <div id="global-loader">
        <div class="whirly-loader"> </div>
    </div>

    <div class="main-page-sales">
        <div class="main-content">
            <div class="details show cuenta-side-menu">
                <div class="top user-info-container">
                    <div class="user-info-option">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 32 32"><path fill="#fff" d="M18 30h-4a2 2 0 0 1-2-2v-7a2 2 0 0 1-2-2v-6a3 3 0 0 1 3-3h6a3 3 0 0 1 3 3v6a2 2 0 0 1-2 2v7a2 2 0 0 1-2 2m-5-18a.94.94 0 0 0-1 1v6h2v9h4v-9h2v-6a.94.94 0 0 0-1-1zm3-3a4 4 0 1 1 4-4a4 4 0 0 1-4 4m0-6a2 2 0 1 0 2 2a2 2 0 0 0-2-2" stroke-width="1" stroke="#fff" /></svg>

                        @ViewLocalizer["Cliente"]: <span class="order-client">@Model.ClientName</span></div>
                    <div class="user-info-option">@ViewLocalizer["Comprobante"]: <span class="order-comprobante">@Model.ComprobanteName</span></div>
                    <div class="seat-add-div user-info-option">
                        <div class="seat-add">
                            <img src="/vendor/img/icons/plus1.svg" />
                        </div>
                    </div>
                    <a class="sales-order-persons user-info-option" href="javascript:void(0);">
                        <img id="order-person" class="sales-setting" src="/vendor/img/comensales.png" alt="" width=30% height=30%>
                        <div id="div-person" class="user-info-option">
                            @Model.Person
                        </div>
                    </a>


                    <input type="hidden" id="divide-num" value="0" />
                    <a class="search-product user-info-option" href="javascript:void(0);" style="width: 12%; height: auto;">
                        <img class="sales-logo" src="/vendor/img/logo-04.png" alt="" >
                    </a>
                </div>
                <div class="content order-item-content order-info-menu">            
                    <div class="order-table" style="height:initial">
                        <div id="order-item-table" class="table">
                            <div class="table-header">
                                <div class="tr">
                                    <div class="td">@ViewLocalizer["Item"]</div>
                                    <div class="td"></div>
                                    <div class="td">@ViewLocalizer["Qty"]</div>
                                    <div class="td">@ViewLocalizer["Price"]</div>
                                    <div class="td">@ViewLocalizer["Amt"]</div>
                                </div>
                            </div>
                            <div id="order-item-list" class="table-body" @* style="min-height:initial; max-height:initial; height: calc(100vh - 450px);" *@>
                            </div>
                        </div>
                    </div>
                    <div class="order-summary">
                        <div class="sub-total"><span>@ViewLocalizer["Subtotal"]:</span><span id="order-subtotal">00.00</span></div>
                        <div class="sub-total"><span>@ViewLocalizer["Discount"]:</span><span id="order-discount">00.00</span></div>
                        <div class="order-discount-items">
                        </div>
                        <div class="sub-total">
                            <span>@ViewLocalizer["Tax"]:</span><span id="order-tax">0</span>
                        </div>
                        <div class="order-tax-items">
                        </div>
                        <div class="sub-total">
                            <span>@ViewLocalizer["Propina"]:</span><span id="order-propina">0</span>
                        </div>
                        <div class="order-propina-items">
                        </div>

                        <div class="sub-total" style="display:none"><span>@ViewLocalizer["TIP"]:</span><span id="order-tip">0</span></div>
                        @if (Model.OrderType == OrderType.Delivery)
                        {
                            <div class="sub-total"><span>@ViewLocalizer["Delivery"]:</span><span id="order-delivery-cost">$0.00</span></div>
                            <div class="sub-total"><span>@ViewLocalizer["Time"]:</span><span id="order-delivery-time"></span></div>
                        }
                        <div class="total" id="order-total">00.00</div>
                        <div class="justify-content-between d-flex" style="display:none !important"><span id="payment-status" class="pt-2" style="font-size: large">@Model.PaymentStatus</span><span class="total text-success" id="order-paid-total">@Model.PayAmount</span></div>
                    </div>
    
                </div>
                <div class="order-info-options">
                    <div class="bottom-grid">
                        <button id="order-cancel" class="btn btn-modern">@ViewLocalizer["Cancel"]</button>
                        <button id="order-save" class="btn btn-modern">@ViewLocalizer["Send"]</button>
                        <button id="order-print" class="btn btn-modern">@ViewLocalizer["Print"]</button>
                        <button id="order-pay" class="btn btn-modern">@ViewLocalizer["Pagar"]</button>
                    </div>
                </div>
                <span id="hambugur"> || </span>

            </div>
            <div class="products elements-main-menu">
                <div class="primary-menu-tab">
                    <div id="group-panel-main" @* class="inner" *@>
                    </div>
                    <div id="mode" @* class="inner py-2" *@>
                            @if (Model.OrderType == OrderType.Delivery)
                            {
                                <button id="order-mesa" class="btn button2 " style="min-width: 150px;">
                                    @if (Model.PrepareType != null)
                                    {
                                        @Model.PrepareType.Name
                                    }
                                    else
                                    {
                                        @ViewLocalizer["Mesa"]
                                    }

                                </button>
                            }
                        <button id="order-express" class="btn btn-nostyle">@ViewLocalizer["Express"]</button>
                        <button id="order-mode" class="btn btn-nostyle">@ViewLocalizer[Model.OrderMode.ToString()]</button>
                        <div class="more-menu-container">
                            <a class="sales-setting-container" id="more-menu-open" href="javascript:void(0);">
                                <svg id="order-tools" class="sales-setting" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><g fill="none"><path d="m12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035q-.016-.005-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427q-.004-.016-.017-.018m.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093q.019.005.029-.008l.004-.014l-.034-.614q-.005-.018-.02-.022m-.715.002a.02.02 0 0 0-.027.006l-.006.014l-.034.614q.001.018.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01z"/><path fill="#fff" d="M12 16.5a1.5 1.5 0 1 1 0 3a1.5 1.5 0 0 1 0-3m0-6a1.5 1.5 0 1 1 0 3a1.5 1.5 0 0 1 0-3m0-6a1.5 1.5 0 1 1 0 3a1.5 1.5 0 0 1 0-3" stroke-width="0.5" stroke="#fff"/></g></svg>
                                @* <img id="order-tools" class="sales-setting" src="/vendor/img/settings.png" alt=""> *@

                            </a>
                            <div class="more-menu" id="more-menu" style="display: none;">
                                <div class="button-icon-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 32 32"><path fill="#fff" d="M18 30h-4a2 2 0 0 1-2-2v-7a2 2 0 0 1-2-2v-6a3 3 0 0 1 3-3h6a3 3 0 0 1 3 3v6a2 2 0 0 1-2 2v7a2 2 0 0 1-2 2m-5-18a.94.94 0 0 0-1 1v6h2v9h4v-9h2v-6a.94.94 0 0 0-1-1zm3-3a4 4 0 1 1 4-4a4 4 0 0 1-4 4m0-6a2 2 0 1 0 2 2a2 2 0 0 0-2-2" stroke-width="1" stroke="#fff" /></svg>
                                    <button id="order-info" class="btn btn-nostyle">@ViewLocalizer["Client Info"]</button>
                                </div>
                                @if (discountType != "item" && @Model.OrderMode != OrderMode.Divide)
                                {
                                    <div class="button-icon-container">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><path fill="#fff" d="M12.79 21L3 11.21v2c0 .53.21 1.04.59 1.41l7.79 7.79c.78.78 2.05.78 2.83 0l6.21-6.21c.78-.78.78-2.05 0-2.83z" stroke-width="0.5" stroke="#fff"/><path fill="#fff" d="M11.38 17.41c.39.39.9.59 1.41.59s1.02-.2 1.41-.59l6.21-6.21c.78-.78.78-2.05 0-2.83L12.62.58C12.25.21 11.74 0 11.21 0H5C3.9 0 3 .9 3 2v6.21c0 .53.21 1.04.59 1.41zM5 2h6.21L19 9.79L12.79 16L5 8.21z" stroke-width="0.5" stroke="#fff"/><circle cx="7.25" cy="4.25" r="1.25" fill="#fff" stroke-width="0.5" stroke="#fff"/></svg>
                                        <button id="btn-order-discount" class="btn btn-nostyle">@ViewLocalizer["Discount"]</button>
                                    </div>
                                }
                                <div class="button-icon-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><path fill="#fff" d="M12 4c-4.411 0-8 3.589-8 8s3.589 8 8 8s8-3.589 8-8s-3.589-8-8-8m-5 8c0-.832.224-1.604.584-2.295l6.711 6.711A4.94 4.94 0 0 1 12 17c-2.757 0-5-2.243-5-5m9.416 2.295L9.705 7.584A4.94 4.94 0 0 1 12 7c2.757 0 5 2.243 5 5c0 .832-.224 1.604-.584 2.295" stroke-width="0.5" stroke="#fff"/></svg>
                                    <button id="btn-order-void" class="btn btn-nostyle">@ViewLocalizer["Void"]</button>
                                </div>
                                @if (Model.Status != OrderStatus.Temp && Model.OrderType == OrderType.DiningRoom)
                                {
                                    <div class="button-icon-container">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><g fill="none" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M16 3h5v5M8 3H3v5" /><path d="M12 22v-8.3a4 4 0 0 0-1.172-2.872L3 3m12 6l6-6" /></g></svg>

                                        <button id="order-split" class="btn btn-nostyle">@ViewLocalizer["Split"]</button>
                                    </div>
                                }
                                <div class="button-icon-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><g fill="none" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" color="#fff"><path d="M21.544 11.045c.304.426.456.64.456.955c0 .316-.152.529-.456.955C20.178 14.871 16.689 19 12 19c-4.69 0-8.178-4.13-9.544-6.045C2.152 12.529 2 12.315 2 12c0-.316.152-.529.456-.955C3.822 9.129 7.311 5 12 5c4.69 0 8.178 4.13 9.544 6.045"/><path d="M15 12a3 3 0 1 0-6 0a3 3 0 0 0 6 0"/></g></svg>
                                    <button id="btn-change-visual-mode" class="btn btn-nostyle" onclick="changeVisualMode();">@ViewLocalizer["Visual Mode"]</button>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
                <div class="grid categories">
                    <div id="category-panel-main" class="secondary-menu-tab">
                    </div>
                </div>
                <div class="sub-category">
                    <div id="subcategory-panel-main" class="inner">
                    </div>
                </div>
                <div class="products elements-main-menu">
            <div class="product-content product-panels-container">
                <div id="forcedquestioncustommodal" class="custommodal" style="display: none; width: 100%; overflow-y: scroll;">
                    <!-- Forced question modal -->
                    <div class="" id="forcedquestionmodal" data-bs-backdrop="static" role="dialog" aria-hidden="true" data-id="" style="border: none; border-bottom: 1px solid #353535; background-color: #1d1d1d; position: absolute; width: 100%; left: 0; height: 100%; top:0 ">
                        <div class="" role="document" style="border:none">
                            <div class="modal-content" style="height: 100vh !important;">

                                <!-- Modal-header

                                <div class="modal-header" style="padding: 5px;">
                                    <h5 class="smartbuton-modal-title">@ViewLocalizer["Forced Questions"]</h5>
                                    <div class="">
                                        <button id="question-cancel" type="button" class="btn btn-danger">@ViewLocalizer["Cancel"]</button>
                                        <button id="question-submit" disabled type="button" class="btn btn-success">@ViewLocalizer["Submit"]</button>
                                    </div>
                                </div>

                                    -->
                                <div class="" style="display:flex">
                                    <div class="w-100">
                                        <div class="modal-body question-body" style="max-height: 95vh;">
                                        </div>
                                    </div>
                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                    <div>
                                        <div style="padding-bottom: 15px; margin-top: 20px; text-align: center;">
                                            <h5 id="QuestionTitleModal" class="smartbuton-modal-title" style="color: orange;">@ViewLocalizer["Forced Questions"]</h5>
                                            <div class="">
                                                <button id="question-submit" disabled type="button" class="btn btn-success" style="width: 100%; padding: 15px; margin-top: 10px; margin-bottom: 15px;">@ViewLocalizer["Submit"]</button>
                                                <button id="question-cancel" type="button" class="btn btn-danger" style="width: 100%; padding: 15px; margin-top: 10px; margin-bottom: 15px;">@ViewLocalizer["Cancel"]</button>
                                            </div>
                                        </div>

                                        <div class="textmen" style="margin-top: 0px;">

                                            <!-- Columna del 25% -->
                                            <!-- Contenido -->
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="modifiercustommodal" class="custommodal" style="display: none; width: 100%; overflow-y: scroll;">
                    <!-- Modifier modal -->
                    <div class="" id="modifiermodal" data-bs-backdrop="static" role="dialog" aria-hidden="true" data-id="" style="border: none; border-bottom: 1px solid #353535; background-color: #1d1d1d; position: absolute; width: 100%; left: 0; height: 100%; top:0 ">
                        <div class="" role="document">
                            <div class="modal-content">

                                <div class="" style="display:flex">
                                    <div class="w-100">
                                        <div class="modal-body modifier-body" style="max-height: 95vh;">
                                        </div>
                                    </div>
                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                    <div>
                                        <div style="padding-bottom: 15px; margin-top: 20px; text-align: center;">
                                            <h5 id="ModifierTitleModal" class="smartbuton-modal-title" style="color: orange;">@ViewLocalizer["Modifiers"]</h5>
                                            <div class="">
                                                <button id="modifier-submit" type="button" class="btn btn-success" style="width: 100%; padding: 15px; margin-top: 10px; margin-bottom: 15px;">@ViewLocalizer["Submit"]</button>
                                                <button id="modifier-cancel" type="button" class="btn btn-danger" style="width: 100%; padding: 15px; margin-top: 10px; margin-bottom: 15px;">@ViewLocalizer["Cancel"]</button>
                                            </div>
                                        </div>

                                        <div class="textmen" style="margin-top: 0px;">

                                            <!-- Columna del 25% -->
                                            <!-- Contenido -->
                                        </div>
                                    </div>

                                </div>

                            </div>
                        </div>
                    </div>
                </div>
                <div class="main">
                    <div id="product-panel-main" class="product-panel-main-kiosk">
                    </div>

                </div>
                <div class="products-footer">
                    <div>
                        @if (Model.Table != null)
                        {
                            <div class="info-option"><span>Mesa: </span><span> @Model.Table.Name</span></div>
                        }
                        else
                        {
                            if (Model.PrepareType != null)
                            {
                                <div class="info-option"><span>Mesa: </span> <span id="order-mesa-header"> @Model.PrepareType.Name</span></div>
                            }
                            else
                            {
                                <div class="info-option"><span>Mesa: </span><span id="order-mesa-header"> @ViewLocalizer["TO GO"]</span></div>
                            }

                        }
                    </div >
                    <div class="info-option" id="fecha-hora"></div>
                    <div class="info-option">@ViewLocalizer["Waiter"]: <span class="order-waiter">@Model.WaiterName</span></div>
                </div>        
            </div>
        </div>
            </div>
        </div>
    </div>

    @* <div class="main-wrapper d-flex text-white">
        <div class="details show">
            <div class="top">
                <a class="search-product" href="javascript:void(0);">
                    <img class="sales-logo" src="/vendor/img/logo-04.png" alt="">
                </a>
                <div class="col-6 mx-2">
                    @if (Model.Table != null)
                    {
                        <div><span>@Model.Table.Name</span></div>
                    }
                    else
                    {
                        if (Model.PrepareType!=null)
                        {
                            <div><span id="order-mesa-header">@Model.PrepareType.Name</span></div>
                        }
                        else
                        {
                            <div><span id="order-mesa-header">@ViewLocalizer["TO GO"]</span></div>
                        }

                    }
                    <div>@ViewLocalizer["Waiter"]: <span class="order-waiter">@Model.WaiterName</span></div>
                    <div>@ViewLocalizer["Cliente"]: <span class="order-client">@Model.ClientName</span></div>
                    <div>@ViewLocalizer["Comprobante"]: <span class="order-comprobante">@Model.ComprobanteName</span></div>
                </div>
                <div class="seat-add-div">
                    <div class="seat-add">
                        <img src="/vendor/img/icons/plus1.svg" />
                    </div>
                </div>
                <a class="sales-order-persons" href="javascript:void(0);">
                    <img id="order-person" class="sales-setting mt-2" src="/vendor/img/comensales.png" alt="">
                </a>
                <div id="div-person" style="padding: 20px;font-size: 20px;">
                    @Model.Person
                </div>
                <a class="sales-setting-container" href="javascript:void(0);">
                    <img id="order-tools" class="sales-setting mt-2" src="/vendor/img/settings.png" alt="">
                </a>
                <input type="hidden" id="divide-num" value="0" />
            </div>
            <div class="content order-item-content">            
                <div class="order-table" style="height:initial">
                    <div id="order-item-table" class="table">
                        <div class="table-header">
                            <div class="tr">
                                <div class="td">@ViewLocalizer["Item"]</div>
                                <div class="td"></div>
                                <div class="td">@ViewLocalizer["Qty"]</div>
                                <div class="td">@ViewLocalizer["Price"]</div>
                                <div class="td">@ViewLocalizer["Amt"]</div>
                            </div>
                        </div>
                        <div id="order-item-list" class="table-body" style="min-height:initial; max-height:initial; height: calc(100vh - 450px);">
                        </div>
                    </div>
                </div>
                <div class="order-summary">
                    <div class="sub-total"><span>@ViewLocalizer["Subtotal"]:</span><span id="order-subtotal">00.00</span></div>
                    <div class="sub-total"><span>@ViewLocalizer["Discount"]:</span><span id="order-discount">00.00</span></div>
                    <div class="order-discount-items">
                    </div>
                    <div class="sub-total">
                        <span>@ViewLocalizer["Tax"]:</span><span id="order-tax">0</span>
                    </div>
                    <div class="order-tax-items">
                    </div>
                    <div class="sub-total">
                        <span>@ViewLocalizer["Propina"]:</span><span id="order-propina">0</span>
                    </div>
                    <div class="order-propina-items">
                    </div>

                    <div class="sub-total" style="display:none"><span>@ViewLocalizer["TIP"]:</span><span id="order-tip">0</span></div>
                    @if (Model.OrderType == OrderType.Delivery)
                    {
                        <div class="sub-total"><span>@ViewLocalizer["Delivery"]:</span><span id="order-delivery-cost">$0.00</span></div>
                        <div class="sub-total"><span>@ViewLocalizer["Time"]:</span><span id="order-delivery-time"></span></div>
                    }
                    <div class="total" id="order-total">00.00</div>
                    <div class="justify-content-between d-flex" style="display:none !important"><span id="payment-status" class="pt-2" style="font-size: large">@Model.PaymentStatus</span><span class="total text-success" id="order-paid-total">@Model.PayAmount</span></div>
                </div>
                <div class="bottom-grid">
                    <button id="order-cancel" class="btn button1 red">@ViewLocalizer["Cancel"]</button>
                    <button id="order-save" class="btn button1 gray">@ViewLocalizer["Send"]</button>
                    <button id="order-print" class="btn button1 blue">@ViewLocalizer["Print"]</button>
                    <button id="order-pay" class="btn button1 green">@ViewLocalizer["Pagar"]</button>
                </div>
            </div>
            <span id="hambugur"> || </span>
        </div>
        <div class="products w-100">
            <div class="top group d-flex justify-content-between">
                <div id="group-panel-main" class="inner">
                </div>
                <div id="mode" class="inner py-2">
                    @if (Model.OrderType == OrderType.Delivery)
                    {
                        <button id="order-mesa" class="btn button2 " style="min-width: 150px;">
                            @if (Model.PrepareType != null)
                            {
                                @Model.PrepareType.Name
                            }
                            else
                            {
                                @ViewLocalizer["Mesa"]
                            }

                        </button>
                    }
                    <button id="order-express" class="btn button2 ">@ViewLocalizer["Express"]</button>
                    <button id="order-mode" class="btn button2 ">@ViewLocalizer[Model.OrderMode.ToString()]</button>
                </div>
            </div>
            <div class="product-content">
                <div id="forcedquestioncustommodal" class="custommodal" style="display: none; width: 100%; overflow-y: scroll;">
                    <!-- Forced question modal -->
                    <div class="" id="forcedquestionmodal" data-bs-backdrop="static" role="dialog" aria-hidden="true" data-id="" style="border: none; border-bottom: 1px solid #353535; background-color: #1d1d1d; position: absolute; width: 100%; left: 0; height: 100%; top:0 ">
                        <div class="" role="document" style="border:none">
                            <div class="modal-content" style="height: 100vh !important;">

                                <!-- Modal-header

    <div class="modal-header" style="padding: 5px;">
        <h5 class="smartbuton-modal-title">@ViewLocalizer["Forced Questions"]</h5>
        <div class="">
            <button id="question-cancel" type="button" class="btn btn-danger">@ViewLocalizer["Cancel"]</button>
            <button id="question-submit" disabled type="button" class="btn btn-success">@ViewLocalizer["Submit"]</button>
        </div>
    </div>

        -->
                                <div class="" style="display:flex">
                                    <div class="w-100">
                                        <div class="modal-body question-body" style="max-height: 95vh;">
                                        </div>
                                    </div>
                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                    <div>
                                        <div style="padding-bottom: 15px; margin-top: 20px; text-align: center;">
                                            <h5 id="QuestionTitleModal" class="smartbuton-modal-title" style="color: orange;">@ViewLocalizer["Forced Questions"]</h5>
                                            <div class="">
                                                <button id="question-submit" disabled type="button" class="btn btn-success" style="width: 100%; padding: 15px; margin-top: 10px; margin-bottom: 15px;">@ViewLocalizer["Submit"]</button>
                                                <button id="question-cancel" type="button" class="btn btn-danger" style="width: 100%; padding: 15px; margin-top: 10px; margin-bottom: 15px;">@ViewLocalizer["Cancel"]</button>
                                            </div>
                                        </div>

                                        <div class="textmen" style="margin-top: 0px;">

                                            <!-- Columna del 25% -->
                                            <!-- Contenido -->
                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="modifiercustommodal" class="custommodal" style="display: none; width: 100%; overflow-y: scroll;">
                    <!-- Modifier modal -->
                    <div class="" id="modifiermodal" data-bs-backdrop="static" role="dialog" aria-hidden="true" data-id="" style="border: none; border-bottom: 1px solid #353535; background-color: #1d1d1d; position: absolute; width: 100%; left: 0; height: 100%; top:0 ">
                        <div class="" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="smartbuton-modal-title">@viewlocalizer["modifiers"]</h5>
                                    <div class="">
                                        <button id="modifier-submit" type="button" class="btn btn-success">@viewlocalizer["submit"]</button>
                                        <button id="modifier-cancel" type="button" class="btn btn-danger">@viewlocalizer["cancel"]</button>
                                    </div>
                                </div>
                                <div class="modal-body modifier-body">
                                </div>

                                <div class="" style="display:flex">
                                    <div class="w-100">
                                        <div class="modal-body modifier-body" style="max-height: 95vh;">
                                        </div>
                                    </div>
                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                    <div>
                                        <div style="padding-bottom: 15px; margin-top: 20px; text-align: center;">
                                            <h5 id="ModifierTitleModal" class="smartbuton-modal-title" style="color: orange;">@ViewLocalizer["Modifiers"]</h5>
                                            <div class="">
                                                <button id="modifier-submit" type="button" class="btn btn-success" style="width: 100%; padding: 15px; margin-top: 10px; margin-bottom: 15px;">@ViewLocalizer["Submit"]</button>
                                                <button id="modifier-cancel" type="button" class="btn btn-danger" style="width: 100%; padding: 15px; margin-top: 10px; margin-bottom: 15px;">@ViewLocalizer["Cancel"]</button>
                                            </div>
                                        </div>

                                        <div class="textmen" style="margin-top: 0px;">

                                            <!-- Columna del 25% -->
                                            <!-- Contenido -->
                                        </div>
                                    </div>

                                </div>
                                
                            </div>
                        </div>
                    </div>
                </div>
                <div class="main w-100">
                    <div id="product-panel-main" class="gird-products">
                    </div>
                    <div class="grid categories">
                        <div id="category-panel-main" class="inner">
                        </div>
                    </div>
                </div>
                <div class="sub-category">
                    <div id="subcategory-panel-main" class="inner">
                    </div>
                </div>
            </div>
        </div>
    </div> *@

    <!-- Permission Error -->
    <div class="modal fade" id="permissionerrormodal" data-bs-backdrop="static" role="dialog" aria-hidden="true" data-id="">
        <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="smartbuton-modal-title text-danger">@ViewLocalizer["Permission Error!"]</h5>
                </div>
                <div class="modal-body">
                    <h6>@ViewLocalizer["You have no permission to access the resource. Please contact with Admin to get it."]</h6>
                </div>
                <div class="modal-footer justify-content-center">
                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal">@ViewLocalizer["Cancel"]</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Seat number select modal -->
    <div class="modal fade" id="seatcountmodal" data-bs-backdrop="static" role="dialog" aria-hidden="true" data-id="">
        <div class="modal-dialog modal-dialog-centered modal-simple" role="document">
            <div class="modal-content">
@*                 <div class="modal-header">
                    <h5 class="smartbuton-modal-title">@ViewLocalizer["Seat Number"]</h5>
                    <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div> *@
                <div class="modal-body">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				    <div class="text-center mb-6">
                            <h4 class="smartbuton-modal-title mb-2">
                                @ViewLocalizer["Seat Number"]
					    </h4>
				    </div>
                    <div class="row">
                        <div class="form-group text-center">
                            <input id="seat-number" class="keyboard-pad w-50" onkeypress="return onlyDecimalKey(event)" value="" type="text" readonly>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col text-center p-2"><button type="button" class="seat-keyboard btn-keyboard btn btn-secondary">7</button></div>
                        <div class="col text-center p-2"><button type="button" class="seat-keyboard btn-keyboard btn btn-secondary">8</button></div>
                        <div class="col text-center p-2"><button type="button" class="seat-keyboard btn-keyboard btn btn-secondary">9</button></div>
                        <div class="col text-center p-2"><button type="button" class="seat-keyboard btn-keyboard btn btn-outline-danger">&#8592</button></div>
                    </div>
                    <div class="row">
                        <div class="col  text-center p-2"><button type="button" class="seat-keyboard btn-keyboard btn btn-secondary">4</button></div>
                        <div class="col  text-center p-2"><button type="button" class="seat-keyboard btn-keyboard btn btn-secondary">5</button></div>
                        <div class="col  text-center p-2"><button type="button" class="seat-keyboard btn-keyboard btn btn-secondary">6</button></div>
                        <div class="col  text-center p-2"><button type="button" class="seat-keyboard btn-keyboard btn btn-outline-primary">C</button></div>
                    </div>
                    <div class="row">
                        <div class="col text-center p-2"><button type="button" class="seat-keyboard btn-keyboard btn btn-secondary">1</button></div>
                        <div class="col text-center p-2"><button type="button" class="seat-keyboard btn-keyboard btn btn-secondary">2</button></div>
                        <div class="col text-center p-2"><button type="button" class="seat-keyboard btn-keyboard btn btn-secondary">3</button></div>
                        <div class="col text-center p-2"><button type="button" class="seat-keyboard btn-keyboard btn btn-secondary">0</button></div>
                    </div>
                </div>
                <div class="modal-footer justify-content-center">
                    <button id="submit-seatnum" type="button" class="btn btn-primary me-3 waves-effect waves-light">@ViewLocalizer["Submit"]</button>
                    <button type="button" class="btn btn-danger waves-effect" data-bs-dismiss="modal">@ViewLocalizer["Cancel"]</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Quantity modal -->
    <div class="modal fade" id="quantitymodal" data-bs-backdrop="static" role="dialog" aria-hidden="true" data-id="">
        <div class="modal-dialog modal-dialog-centered modal-simple" role="document">
            <div class="modal-content">
@*                 <div class="modal-header">
                    <h5 class="smartbuton-modal-title">@ViewLocalizer["Quantity"]</h5>
                    <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div> *@
                <div class="modal-body">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				    <div class="text-center mb-6">
                            <h4 class="smartbuton-modal-title mb-2">
                               @ViewLocalizer["Quantity"]
					    </h4>
				    </div>
                    <div class="row">
                        <div class="form-group text-center">
                            <input id="qty-number" class="keyboard-pad w-50" onkeypress="return onlyDecimalKey(event)" value="" type="text" readonly>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col text-center p-2"><button type="button" class="qty-keyboard btn-keyboard btn btn-secondary">7</button></div>
                        <div class="col text-center p-2"><button type="button" class="qty-keyboard btn-keyboard btn btn-secondary">8</button></div>
                        <div class="col text-center p-2"><button type="button" class="qty-keyboard btn-keyboard btn btn-secondary">9</button></div>
                        <div class="col text-center p-2"><button type="button" class="qty-keyboard btn-keyboard btn btn-outline-danger">&#8592</button></div>
                    </div>
                    <div class="row">
                        <div class="col  text-center p-2"><button type="button" class="qty-keyboard btn-keyboard btn btn-secondary">4</button></div>
                        <div class="col  text-center p-2"><button type="button" class="qty-keyboard btn-keyboard btn btn-secondary">5</button></div>
                        <div class="col  text-center p-2"><button type="button" class="qty-keyboard btn-keyboard btn btn-secondary">6</button></div>
                        <div class="col  text-center p-2"><button type="button" class="qty-keyboard btn-keyboard btn btn-outline-primary">C</button></div>
                    </div>
                    <div class="row">
                        <div class="col text-center p-2"><button type="button" class="qty-keyboard btn-keyboard btn btn-secondary">1</button></div>
                        <div class="col text-center p-2"><button type="button" class="qty-keyboard btn-keyboard btn btn-secondary">2</button></div>
                        <div class="col text-center p-2"><button type="button" class="qty-keyboard btn-keyboard btn btn-secondary">3</button></div>
                        <div class="col text-center p-2"><button type="button" class="qty-keyboard btn-keyboard btn btn-secondary">0</button></div>
                    </div>
                </div>
                <div class="modal-footer justify-content-center">
                    <button id="submit-qty" type="button" class="btn btn-primary me-3 waves-effect waves-light">@ViewLocalizer["Submit"]</button>
                    <button type="button" class="btn btn-danger waves-effect" data-bs-dismiss="modal">@ViewLocalizer["Cancel"]</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Inventory Count Down modal -->
    <div class="modal fade" id="inventorycountdownmodal" data-bs-backdrop="static" role="dialog" aria-hidden="true" data-id="">
        <div class="modal-dialog modal-dialog-centered modal-simple" role="document">
            <div class="modal-content">
@*                 <div class="modal-header">
                    <h5 class="smartbuton-modal-title">@ViewLocalizer["Inventory Count Update"]</h5>
                    <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div> *@
                <div class="modal-body">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				    <div class="text-center mb-6">
                            <h4 class="smartbuton-modal-title mb-2">
                            @ViewLocalizer["Inventory Count Update"]
					    </h4>
				    </div>
                    <div class="row">
                        <div class="form-group text-center">
                            <input id="invqty-number" class="keyboard-pad w-50" onkeypress="return onlyDecimalKey(event)" value="" type="text" readonly>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col text-center p-2"><button type="button" class="invqty-keyboard btn-keyboard btn btn-secondary">7</button></div>
                        <div class="col text-center p-2"><button type="button" class="invqty-keyboard btn-keyboard btn btn-secondary">8</button></div>
                        <div class="col text-center p-2"><button type="button" class="invqty-keyboard btn-keyboard btn btn-secondary">9</button></div>
                        <div class="col text-center p-2"><button type="button" class="invqty-keyboard btn-keyboard btn btn-outline-danger">&#8592</button></div>
                    </div>
                    <div class="row">
                        <div class="col  text-center p-2"><button type="button" class="invqty-keyboard btn-keyboard btn btn-secondary">4</button></div>
                        <div class="col  text-center p-2"><button type="button" class="invqty-keyboard btn-keyboard btn btn-secondary">5</button></div>
                        <div class="col  text-center p-2"><button type="button" class="invqty-keyboard btn-keyboard btn btn-secondary">6</button></div>
                        <div class="col  text-center p-2"><button type="button" class="invqty-keyboard btn-keyboard btn btn-outline-primary">C</button></div>
                    </div>
                    <div class="row">
                        <div class="col text-center p-2"><button type="button" class="invqty-keyboard btn-keyboard btn btn-secondary">1</button></div>
                        <div class="col text-center p-2"><button type="button" class="invqty-keyboard btn-keyboard btn btn-secondary">2</button></div>
                        <div class="col text-center p-2"><button type="button" class="invqty-keyboard btn-keyboard btn btn-secondary">3</button></div>
                        <div class="col text-center p-2"><button type="button" class="invqty-keyboard btn-keyboard btn btn-secondary">0</button></div>
                    </div>
                    <div class="form-group">
                        <label>@ViewLocalizer["Active"]</label>
                        <select id="inventory-active" class="select ">
                            <option value="1">@ViewLocalizer["Yes"]</option>
                            <option value="2">@ViewLocalizer["No"]</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer justify-content-center">
                    <button id="submit-invqty" type="button" class="btn btn-primary me-3 waves-effect waves-light">@ViewLocalizer["Submit"]</button>
                    <button type="button" class="btn btn-danger waves-effect" data-bs-dismiss="modal">@ViewLocalizer["Cancel"]</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Order Menu modal -->
    <div class="modal fade" id="ordermenuoptionmodal" data-bs-backdrop="static" role="dialog" aria-hidden="true" data-id="">
        <div class="modal-dialog modal-dialog-centered modal-simple" role="document">
            <div class="modal-content">
@*                 <div class="modal-header">
                    <h5 class="group-modal-title">@ViewLocalizer["Order Tools"]</h5>
                    <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div> *@
                <div class="modal-body">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				    <div class="text-center mb-6">
                            <h4 class="group-modal-title mb-2">
                            @ViewLocalizer["Order Tools"]
					    </h4>
				    </div>
                    <div class="row">
                        <div class="col-3 p-2"><button id="order-info" class="btn-menu btn btn-primary">@ViewLocalizer["Client Info"]</button></div>
                        @if (discountType != "item" && @Model.OrderMode != OrderMode.Divide)
                        {
                            <div class="col-3 p-2"><button id="btn-order-discount" class="btn-menu btn btn-primary">@ViewLocalizer["Discount"]</button></div>
                        }                        
                        <div class="col-3 p-2"><button id="btn-order-void" class="btn-menu btn btn-primary">@ViewLocalizer["Void"]</button></div>
                        @if (Model.Status != OrderStatus.Temp && Model.OrderType == OrderType.DiningRoom)
                        {
                            <div class="col-3 p-2"><button id="order-split" class="btn-menu btn btn-primary">@ViewLocalizer["Split"]</button></div>
                        }
                        <div class="col-3 p-2"><button id="btn-change-visual-mode" class="btn-menu btn btn-primary" onclick="changeVisualMode();">@ViewLocalizer["Change Visual Mode"]</button></div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-label-secondary waves-effect" data-bs-dismiss="modal">@ViewLocalizer["Cancel"]</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="permissionpinmodal" data-bs-backdrop="static" role="dialog" aria-hidden="true" data-id="">
        <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
            <div class="modal-content" style="border: 0">
                <div class="panel">
                    <div style=" ">
                        <div id="input-pin" class="d-flex justify-content-center" data-value="" style="height:100px; padding-left:14px;">
                            <div class="display-pin"></div>
                            <div class="display-pin"></div>
                            <div class="display-pin"></div>
                            <div class="display-pin"></div>
                        </div>
                    </div>
                    <div class="d-flex justify-content-center">
                        <div>
                            <div class="pin" data-num="1" style="">
                                1
                            </div>
                            <div class="pin" data-num="4" style="">
                                4
                            </div>
                            <div class="pin" data-num="7" style="">
                                7
                            </div>
                            <div class="pin" data-num="" style="">
                                *
                            </div>
                        </div>
                        <div>
                            <div class="pin" data-num="2" style="">
                                2
                            </div>
                            <div class="pin" data-num="5" style="">
                                5
                            </div>
                            <div class="pin" data-num="8" style="">
                                8
                            </div>
                            <div class="pin" data-num="0" style="">
                                0
                            </div>
                        </div>
                        <div>
                            <div class="pin" data-num="3" style="">
                                3
                            </div>
                            <div class="pin" data-num="6" style="">
                                6
                            </div>
                            <div class="pin" data-num="9" style="">
                                9
                            </div>
                            <div class="pin" data-num="del" style="">
                                DEL
                            </div>
                        </div>
                    </div>
                    <div class="d-flex justify-content-center">
                        <div id="cancel-pin" class="pin" data-num="cancel" style="width:400px;">
                            CANCEL
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Menu modal -->
    <div class="modal fade" id="menuoptionmodal" data-bs-backdrop="static" role="dialog" aria-hidden="true" data-id="">
        <div class="modal-dialog modal-dialog-centered modal-simple" role="document">
            <div class="modal-content">
@*                 <div class="modal-header">
                    <h5 class="group-modal-title">@ViewLocalizer["Menu Options"]</h5>
                    <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div> *@
                <div class="modal-body">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				    <div class="text-center mb-6">
					    <h4 class="group-modal-title mb-2">
                            @ViewLocalizer["Menu Options"]
					    </h4>
				    </div>
                    <div class="row">
                        <div class="col-3 p-2"><button id="btn-void" class="btn-menu btn " style="background-color:darkred; color:white;  border-radius: 10px">@ViewLocalizer["Void"]</button></div>
                        <div class="col-3 p-2"><button id="btn-hold" class="btn-menu btn btn-primary " style=" border-radius: 10px">@ViewLocalizer["Hold"]</button></div>
                        <div class="col-3 p-2"><button id="btn-seperate" class="btn-menu btn btn-primary" style=" border-radius: 10px">@ViewLocalizer["Separate"]</button></div>
                        @if (discountType != "order")
                        {
                            <div class="col-3 p-2"><button id="btn-discountitem" class="btn-menu btn btn-primary" style=" border-radius: 10px">@ViewLocalizer["Discount"]</button></div>
                        }                       
                        <div class="col-3 p-2"><button id="btn-qty" class="btn-menu btn " style="background-color:forestgreen;  color:white;  border-radius: 10px">@ViewLocalizer["Quantity"]</button></div>
                        <div class="col-3 p-2"><button id="btn-movetable" class="btn-menu btn btn-primary" style=" border-radius: 10px">@ViewLocalizer["Move to Another Table"]</button></div>
                        <div class="col-3 p-2"><button id="btn-moveseat" class="btn-menu btn btn-primary" style=" border-radius: 10px">@ViewLocalizer["Move to Another Seat"]</button></div>
                        <div class="col-3 p-2"><button id="btn-inventory" class="btn-menu btn btn-primary" style=" border-radius: 10px">@ViewLocalizer["Inventory Count Down"]</button></div>
                        <div class="col-3 p-2"><button id="btn-modifier" class="btn-menu btn " style="background-color:midnightblue;  color:white;  border-radius: 10px">@ViewLocalizer["Modificar"]</button></div>
                        <div class="col-3 p-2"><button id="btn-reorder" class="btn-menu btn btn-primary" style=" border-radius: 10px">@ViewLocalizer["Reorder"]</button></div>
                        <div class="col-3 p-2"><button id="btn-fire" class="btn-menu btn btn-primary" style=" border-radius: 10px">@ViewLocalizer["Fire"]</button></div>
                        <div class="col-3 p-2"><button id="btn-note" class="btn-menu btn btn-primary" style=" border-radius: 10px">@ViewLocalizer["Course and note"]</button></div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-label-secondary waves-effect" data-bs-dismiss="modal" style=" border-radius: 10px">@ViewLocalizer["Cancel"]</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Seat Menu modal -->
    <div class="modal fade" id="seatmenumodal" data-bs-backdrop="static" role="dialog" aria-hidden="true" data-id="">
        <div class="modal-dialog modal-dialog-centered modal-simple" role="document">
            <div class="modal-content">
@*                 <div class="modal-header">
                    <h5 class="group-modal-title">@ViewLocalizer["Seat Menu Options"]</h5>
                    <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div> *@
                <div class="modal-body">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				    <div class="text-center mb-6">
					    <h4 class="group-modal-title mb-2">
                            @ViewLocalizer["Seat Menu Options"]
					    </h4>
				    </div>
                    <div class="row">
                        <div class="col-3 p-2"><button id="btn-combineseat" class="btn-menu btn btn-primary">@ViewLocalizer["Combine With Seat"]</button></div>
                        <div class="col-3 p-2"><button id="btn-seatpay" class="btn-menu btn btn-primary">@ViewLocalizer["Pay"]</button></div>
                        @* <div class="col-3 p-2"><button id="btn-seatinfo" class="btn-menu btn btn-primary">@ViewLocalizer["Client's Name"]</button></div> *@
                        <div class="col-3 p-2"><button id="btn-moveseattotable" class="btn-menu btn btn-primary">@ViewLocalizer["Move Seat to Another Table"]</button></div>
                        <div class="col-3 p-2"><button id="btn-printseat" class="btn-menu btn btn-primary">@ViewLocalizer["Print"]</button></div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-label-secondary waves-effect" data-bs-dismiss="modal">@ViewLocalizer["Cancel"]</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Mesa Menu modal -->
    <div class="modal fade" id="mesamenumodal" role="dialog" aria-hidden="true" data-id="">
        <div class="modal-dialog modal-dialog-centered modal-simple" role="document">
            <div class="modal-content">
                <div class="modal-body">
                    <div id="MesaMenuModelOptions" class="row">

                        <!-- Prepare Types Values -->

                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-label-secondary waves-effect" data-bs-dismiss="modal">@ViewLocalizer["Cancel"]</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Order Mode modal -->
    <div class="modal fade" id="changemodemodal" data-bs-backdrop="static" role="dialog" aria-hidden="true" data-id="">
        <div class="modal-dialog modal-dialog-centered modal-simple" role="document">
            <div class="modal-content">
@*                 <div class="modal-header">
                    <h5 class="group-modal-title">@ViewLocalizer["Change Mode"]</h5>
                    <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div> *@
                <div class="modal-body">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				    <div class="text-center mb-6">
					    <h4 class="group-modal-title mb-2">
                            @ViewLocalizer["Change Mode"]
					    </h4>
				    </div>
                    <div class="row">
                        <div class="col-6 p-2"><button id="btn-modeseat" class="btn-menu btn btn-primary">@ViewLocalizer["Seat Mode"]</button></div>
                        <div class="col-6 p-2"><button id="btn-modestandard" class="btn-menu btn btn-primary">@ViewLocalizer["Standard Mode"]</button></div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-label-secondary waves-effect" data-bs-dismiss="modal">@ViewLocalizer["Cancel"]</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Cancel modal -->
    <div class="modal fade" id="cancelitemmodal" data-bs-backdrop="static" role="dialog" aria-hidden="true" data-id="">
        <div class="modal-dialog modal-lg modal-dialog-centered modal-simple" role="document">
            <div class="modal-content">
@*                 <div class="modal-header">
                    <h5 class="group-modal-title">@ViewLocalizer["Void Item"]</h5>
                    <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div> *@
                <div class="modal-body">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				    <div class="text-center mb-6">
					    <h4 class="group-modal-title mb-2">
                            @ViewLocalizer["Void Item"]
					    </h4>
				    </div>
                    <div class="form-group p-5">
                        <label>@ViewLocalizer["Void Reason"]</label>

                        <div id="void-reason" class="d-flex mx-2">
                            @foreach (var reason in reasons)
                            {
                                <button class='select-reason w-25 m-3 btn button2' data-id='@reason.ID'>@reason.Reason</button>
                            }
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="void-submit" type="button" class="btn btn-primary me-3 waves-effect waves-light">@ViewLocalizer["Submit"]</button>
                    <button type="button" class="btn btn-label-secondary waves-effect" data-bs-dismiss="modal">@ViewLocalizer["Cancel"]</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Cancel order modal -->
    <div class="modal fade" id="voidordermodal" data-bs-backdrop="static" role="dialog" aria-hidden="true" data-id="">
        <div class="modal-dialog modal-lg modal-dialog-centered modal-simple" role="document">
            <div class="modal-content">
@*                 <div class="modal-header">
                    <h5 class="group-modal-title">@ViewLocalizer["Void Order"]</h5>
                    <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div> *@
                <div class="modal-body">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				    <div class="text-center mb-6">
					    <h4 class="group-modal-title mb-2">
                            @ViewLocalizer["Void Order"]
					    </h4>
				    </div>
                    <div class="form-group p-5">
                        <label class="form-label">@ViewLocalizer["Void Reason"]</label>

                        <div id="void-reason-order" class="d-flex mx-2">
                            @foreach (var reason in reasons)
                            {
                                <button class='select-reason-order w-25 m-3 btn button2' data-id='@reason.ID'>@reason.Reason</button>
                            }
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="void-order-submit" type="button" class="btn btn-primary me-3 waves-effect waves-light">@ViewLocalizer["Submit"]</button>
                    <button type="button" class="btn btn-label-secondary waves-effect" data-bs-dismiss="modal">@ViewLocalizer["Cancel"]</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Course note modal -->
    <div class="modal fade" id="coursenotemodal" data-bs-backdrop="static" role="dialog" aria-hidden="true" data-id="">
        <div class="modal-dialog modal-lg modal-dialog-centered modal-simple" role="document">
            <div class="modal-content">
@*                 <div class="modal-header">
                    <h5 class="group-modal-title">@ViewLocalizer["Course & Note"]</h5>
                    <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div> *@
                <div class="modal-body">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				    <div class="text-center mb-6">
					    <h4 class="group-modal-title mb-2">
                            @ViewLocalizer["Course & Note"]
					    </h4>
				    </div>
                    <div id="item-course" class="d-flex p-2">
                    </div>
                    <div class="form-group p-3">
                        <label>@ViewLocalizer["Note"]</label>
                        <textarea id="item-note" rows="3"></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="coursenote-submit" type="button" class="btn btn-primary me-3 waves-effect waves-light">@ViewLocalizer["Submit"]</button>
                    <button type="button" class="btn btn-label-secondary waves-effect" data-bs-dismiss="modal">@ViewLocalizer["Cancel"]</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Divider modal -->
    <div class="modal fade" id="dividemodal" data-bs-backdrop="static" role="dialog" aria-hidden="true" data-id="">
        <div class="modal-dialog modal-lg modal-dialog-centered divide" role="document">
            <div class="modal-content">
                <div class="modal-header " style="justify-content: space-around !important;">
                    <div class="d-flex">
                        <button id="divide-combine" type="button" class="btn btn-secondary btndivide">@ViewLocalizer["Combine All"]</button>
                        <button id="divide-seatsplit" type="button" class="btn btn-secondary btndivide">@ViewLocalizer["Split By Seat"]</button>
                        <button id="divide-selectedproduct" type="button" class="btn btn-secondary btndivide">@ViewLocalizer["Divide Selected"]</button>
                        <button id="divide-splitwhole" type="button" class="btn btn-secondary btndivide">@ViewLocalizer["Divide Whole"]</button>
                    </div>
                    <div>
                        <button id="divide-print" type="button" class="btn btn-success btndivide">@ViewLocalizer["Print All"]</button>
                    </div>
                    <div>
                        <button id="divide-save" type="button" class="btn btn-success btndivide">@ViewLocalizer["Save"]</button>
                        <button id="divide-cancel" type="button" class="btn btn-cancel btndivide">@ViewLocalizer["Cancel"]</button>
                    </div>
                </div>
                <div class="divide-main-panel modal-body" style="display:-webkit-box;">
                    <div class="divide-account card m-2">
                        <div class="divide-account-header p-1">Client #1</div>
                        <div class="divide-body" style="height:50vh;">
                            <div class="divide-item">
                                <div class="row">
                                    <span class="col-2">1</span>
                                    <span class="col-6">Test Product</span>
                                    <span class="col-3">2.0</span>
                                </div>
                                <div class="item-modifiers">
                                    <div class="justify-content-around d-flex w-100">
                                        <span class="">Sauth</span>
                                        <span class="">3</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="divide-account-footer p-1">
                            <button id="divide-remove" type="button" class="btn btn-success button2">@ViewLocalizer["Remove"]</button>
                            <button id="divide-print" type="button" class="btn btn-success button2">@ViewLocalizer["Print"]</button>
                        </div>
                    </div>
                    <div class="divide-account card m-2">
                        <div class="divide-body" style="height:100%;">
                            <div class="divide-item-add">
                                <img src="/vendor/img/icons/plus1.svg" />
                            </div>
                        </div>
                        <div class="divide-account-footer p-1">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Divide Quantity modal -->
    <div class="modal fade" id="dividequantitymodal" data-bs-backdrop="static" role="dialog" aria-hidden="true" data-id="">
        <div class="modal-dialog modal-dialog-centered modal-simple" role="document">
            <div class="modal-content">
@*                 <div class="modal-header">
                    <h5 class="smartbuton-modal-title">@ViewLocalizer["Quantity"]</h5>
                    <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div> *@
                <div class="modal-body">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    <div class="text-center mb-6">
                        <h4 class="group-modal-title mb-2">
                            @ViewLocalizer["Quantity"]
                        </h4>
                    </div>
                    <div class="row">
                        <div class="form-group text-center">
                            <input id="divideqty-number" class="keyboard-pad w-50" onkeypress="return onlyDecimalKey(event)" value="" type="text" readonly>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col text-center p-2"><button type="button" class="divideqty-keyboard btn-keyboard btn btn-secondary">7</button></div>
                        <div class="col text-center p-2"><button type="button" class="divideqty-keyboard btn-keyboard btn btn-secondary">8</button></div>
                        <div class="col text-center p-2"><button type="button" class="divideqty-keyboard btn-keyboard btn btn-secondary">9</button></div>
                        <div class="col text-center p-2"><button type="button" class="divideqty-keyboard btn-keyboard btn btn-outline-danger">&#8592</button></div>
                    </div>
                    <div class="row">
                        <div class="col  text-center p-2"><button type="button" class="divideqty-keyboard btn-keyboard btn btn-secondary">4</button></div>
                        <div class="col  text-center p-2"><button type="button" class="divideqty-keyboard btn-keyboard btn btn-secondary">5</button></div>
                        <div class="col  text-center p-2"><button type="button" class="divideqty-keyboard btn-keyboard btn btn-secondary">6</button></div>
                        <div class="col  text-center p-2"><button type="button" class="divideqty-keyboard btn-keyboard btn btn-outline-primary">C</button></div>
                    </div>
                    <div class="row">
                        <div class="col text-center p-2"><button type="button" class="divideqty-keyboard btn-keyboard btn btn-secondary">1</button></div>
                        <div class="col text-center p-2"><button type="button" class="divideqty-keyboard btn-keyboard btn btn-secondary">2</button></div>
                        <div class="col text-center p-2"><button type="button" class="divideqty-keyboard btn-keyboard btn btn-secondary">3</button></div>
                        <div class="col text-center p-2"><button type="button" class="divideqty-keyboard btn-keyboard btn btn-secondary">0</button></div>
                    </div>

                </div>
                <div class="modal-footer justify-content-center">
                    <button id="submit-divideqty" type="button" class="btn btn-success">@ViewLocalizer["Submit"]</button>
                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal">@ViewLocalizer["Cancel"]</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Hold modal -->
    <div class="modal fade" id="holdordermodal" data-bs-backdrop="static" role="dialog" aria-hidden="true" data-id="">
        <div class="modal-dialog modal-dialog-centered modal-simple" role="document">
            <div class="modal-content">
@*                 <div class="modal-header">
                    <h5 class="group-modal-title">@ViewLocalizer["Hold Order Item"]</h5>
                    <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div> *@
                <div class="modal-body">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    <div class="text-center mb-6">
                        <h4 class="group-modal-title mb-2">
                            @ViewLocalizer["Hold Order Item"]
                        </h4>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Type</label>
                        <select id="hold-type" class="select">
                            <option value="1">@ViewLocalizer["Manually"]</option>
                            <option value="2">@ViewLocalizer["Automatically"]</option>
                        </select>
                    </div>
                    <div class="auto-time row">
                        <div class="col form-group">
                            <label class="form-label">Hours</label>
                            <select id="hold-hour" class="select">
                                <option value="0">0</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                                <option value="6">6</option>
                                <option value="7">7</option>
                                <option value="8">8</option>
                                <option value="9">9</option>
                                <option value="10">10</option>
                                <option value="11">11</option>
                                <option value="12">12</option>
                            </select>
                        </div>
                        <div class="col form-group">
                            <label class="form-label">Minutes</label>
                            <select id="hold-minutes" class="select">
                                <option value="0">0</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="5">5</option>
                                <option value="10">10</option>
                                <option value="15">15</option>
                                <option value="20">20</option>
                                <option value="30">30</option>
                                <option value="40">40</option>
                                <option value="45">45</option>
                                <option value="50">50</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="hold-submit" type="button" class="btn btn-primary me-3 waves-effect waves-light">@ViewLocalizer["Submit"]</button>
                    <button type="button" class="btn btn-label-secondary waves-effect" data-bs-dismiss="modal">@ViewLocalizer["Cancel"]</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Move item to another table modal -->
    <div class="modal fade" id="movetablemodal" data-bs-backdrop="static" role="dialog" aria-hidden="true" data-id="">
        <div class="modal-dialog modal-dialog-centered modal-simple" role="document">
            <div class="modal-content">
@*                 <div class="modal-header">
                    <h5 class="group-modal-title">@ViewLocalizer["Move Item To Another Table"]</h5>
                    <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div> *@
                <div class="modal-body">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    <div class="text-center mb-6">
                        <h4 class="group-modal-title mb-2">
                            @ViewLocalizer["Move Item To Another Table"]
                        </h4>
                    </div>
                    <div class="auto-time row">
                        <div class="form-group">
                            <label class="form-label">Another Tables</label>
                            <div id="another-tables" >
                                @foreach (var table in tables)
                                {
                                    <button class='select-table w-25 m-3 btn button2' data-id='@table.ID'>@table.Name</button>
                                }
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="movetable-submit" type="button" class="btn btn-primary me-3 waves-effect waves-light" data-bs-dismiss="modal">@ViewLocalizer["Submit"]</button>
                    <button type="button" class="btn btn-label-secondary waves-effect" data-bs-dismiss="modal">@ViewLocalizer["Cancel"]</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Move item to another area's table modal -->
    <div class="modal fade" id="moveareatablemodal" data-bs-backdrop="static" role="dialog" aria-hidden="true" data-id="">
        <div class="modal-dialog modal-dialog-centered modal-simple" role="document">
            <div class="modal-content">
@*                 <div class="modal-header">
                    <h5 class="group-modal-title">@ViewLocalizer["Move Item To Another Area's Table"]</h5>
                    <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div> *@
                <div class="modal-body">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    <div class="text-center mb-6">
                        <h4 class="group-modal-title mb-2">
                            @ViewLocalizer["Move Item To Another Area's Table"]
                        </h4>
                    </div>
                    <div class="auto-time row">
                        <div class="form-group">
                            <label class="form-label">Another Area</label>
                            <select id="another-area" class="select">
                                <option value="">@ViewLocalizer["Choose the target area"]</option>
                                @foreach (var area in areas)
                                {
                                    <option value="@area.ID">@area.Name</option>
                                }
                            </select>
                        </div>
                    </div>
                    <div class="auto-time row">
                        <div class="form-group">
                            <label class="form-label">Another Tables</label>
                            <select id="another-area-tables" class="select">
                            </select>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="moveareatable-submit" type="button" class="btn btn-primary me-3 waves-effect waves-light" data-bs-dismiss="modal">@ViewLocalizer["Submit"]</button>
                    <button type="button" class="btn btn-label-secondary waves-effect" data-bs-dismiss="modal">@ViewLocalizer["Cancel"]</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Move seat to another table modal -->
    <div class="modal fade" id="moveseattablemodal" data-bs-backdrop="static" role="dialog" aria-hidden="true" data-id="">
        <div class="modal-dialog modal-dialog-centered modal-simple" role="document">
            <div class="modal-content">
@*                 <div class="modal-header">
                    <h5 class="group-modal-title">@ViewLocalizer["Move Seat To Another Table"]</h5>
                    <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div> *@
                <div class="modal-body">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    <div class="text-center mb-6">
                        <h4 class="group-modal-title mb-2">
                            @ViewLocalizer["Move Seat To Another Table"]
                        </h4>
                    </div>
                    <div class="auto-time row">
                        <div class="form-group">
                            <label class="form-label">@ViewLocalizer["Another Tables"]:</label>
                            <select id="seat-another-tables" class="select">
                                <option value="">@ViewLocalizer["Choose the target table"]</option>
                                @foreach (var table in tables)
                                {
                                    <option value="@table.ID">@table.Name</option>
                                }
                            </select>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="moveseattable-submit" type="button" class="btn btn-primary me-3 waves-effect waves-light" data-bs-dismiss="modal">@ViewLocalizer["Submit"]</button>
                    <button type="button" class="btn btn-label-secondary waves-effect" data-bs-dismiss="modal">@ViewLocalizer["Cancel"]</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Move item to another seat modal -->
    <div class="modal fade" id="moveseatmodal" data-bs-backdrop="static" role="dialog" aria-hidden="true" data-id="">
        <div class="modal-dialog modal-dialog-centered modal-simple" role="document">
            <div class="modal-content">
@*                 <div class="modal-header">
                    <h5 class="group-modal-title">@ViewLocalizer["Move Item To Another Seat"]</h5>
                    <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div> *@
                <div class="modal-body">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    <div class="text-center mb-6">
                        <h4 class="group-modal-title mb-2">
                            @ViewLocalizer["Move Item To Another Seat"]
                        </h4>
                    </div>
                    <div class="auto-time row">
                        <div class="form-group">
                            <label class="form-label">Another Seats</label>
                            <select id="another-seats-move" class="select">
                            </select>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="moveseat-submit" type="button" class="btn btn-primary me-3 waves-effect waves-light" data-bs-dismiss="modal">@ViewLocalizer["Submit"]</button>
                    <button type="button" class="btn btn-label-secondary waves-effect" data-bs-dismiss="modal">@ViewLocalizer["Cancel"]</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Reorder item modal -->
    <div class="modal fade" id="reordermodal" data-bs-backdrop="static" role="dialog" aria-hidden="true" data-id="">
        <div class="modal-dialog modal-dialog-centered modal-simple" role="document">
            <div class="modal-content">
@*                 <div class="modal-header">
                    <h5 class="smartbuton-modal-title">@ViewLocalizer["Reorder Item"]</h5>
                    <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div> *@
                <div class="modal-body">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    <div class="text-center mb-6">
                        <h4 class="group-modal-title mb-2">
                            @ViewLocalizer["Reorder Item"]
                        </h4>
                    </div>
                    <div class="row">
                        <div class="form-group text-center">
                            <label class="form-label">Seat Num</label>
                            <input id="reorderseat-number" class="keyboard-pad w-50" onkeypress="return onlyDecimalKey(event)" value="" type="text" readonly>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col text-center p-2"><button type="button" class="reorder-keyboard btn-keyboard btn btn-secondary">7</button></div>
                        <div class="col text-center p-2"><button type="button" class="reorder-keyboard btn-keyboard btn btn-secondary">8</button></div>
                        <div class="col text-center p-2"><button type="button" class="reorder-keyboard btn-keyboard btn btn-secondary">9</button></div>
                        <div class="col text-center p-2"><button type="button" class="reorder-keyboard btn-keyboard btn btn-outline-danger">&#8592</button></div>
                    </div>
                    <div class="row">
                        <div class="col  text-center p-2"><button type="button" class="reorder-keyboard btn-keyboard btn btn-secondary">4</button></div>
                        <div class="col  text-center p-2"><button type="button" class="reorder-keyboard btn-keyboard btn btn-secondary">5</button></div>
                        <div class="col  text-center p-2"><button type="button" class="reorder-keyboard btn-keyboard btn btn-secondary">6</button></div>
                        <div class="col  text-center p-2"><button type="button" class="reorder-keyboard btn-keyboard btn btn-outline-primary">C</button></div>
                    </div>
                    <div class="row">
                        <div class="col text-center p-2"><button type="button" class="reorder-keyboard btn-keyboard btn btn-secondary">1</button></div>
                        <div class="col text-center p-2"><button type="button" class="reorder-keyboard btn-keyboard btn btn-secondary">2</button></div>
                        <div class="col text-center p-2"><button type="button" class="reorder-keyboard btn-keyboard btn btn-secondary">3</button></div>
                        <div class="col text-center p-2"><button type="button" class="reorder-keyboard btn-keyboard btn btn-secondary">0</button></div>
                    </div>
                </div>
                <div class="modal-footer justify-content-center">
                    <button id="reorder-submit" type="button" class="btn btn-primary me-3 waves-effect waves-light">@ViewLocalizer["Submit"]</button>
                    <button type="button" class="btn btn-danger waves-effect" data-bs-dismiss="modal">@ViewLocalizer["Cancel"]</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Discount item modal -->
    <div class="modal fade" id="discountmodal" data-bs-backdrop="static" role="dialog" aria-hidden="true" data-id="">
        <div class="modal-dialog modal-lg modal-dialog-centered modal-simple" role="document">
            <div class="modal-content">
@*                 <div class="modal-header">
                    <h5 class="group-modal-title">@ViewLocalizer["Discounts"]</h5>
                    <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div> *@
                <div class="modal-body">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    <div class="text-center mb-6">
                        <h4 class="group-modal-title mb-2">
                            @ViewLocalizer["Discounts"]
                        </h4>
                    </div>
                    <div id="discount-list" class="d-flex">
                        @foreach(var d in discounts)
                        {
                            <button class='select-discount w-25 m-3 btn button2' data-id='@d.ID'>@d.Name</button>
                        }
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="discount-apply" type="button" class="btn btn-primary me-3 waves-effect waves-light">@ViewLocalizer["Apply"]</button>
                    <button type="button" class="btn btn-danger waves-effect" data-bs-dismiss="modal">@ViewLocalizer["Cancel"]</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Order info modal -->
    <div class="modal fade" id="orderinfo" data-bs-backdrop="static" role="dialog" aria-hidden="true" data-id="">
        <div class="modal-dialog modal-dialog-centered modal-simple" role="document">
            <div class="modal-content">
@*                 <div class="modal-header">
                    <h5 class="group-modal-title">@ViewLocalizer["Order Information"]</h5>
                    <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div> *@
                <div class="modal-body">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    <div class="text-center mb-6">
                        <h4 class="group-modal-title mb-2">
                            @ViewLocalizer["Order Information"]
                        </h4>
                    </div>
                    <div class="row form-group">
                        <div class="form-group">
                            <label>@ViewLocalizer["Nombre de Cliente"]</label>
                            <div class="row">
                                <div class="col-lg-10 col-sm-10 col-10">
                                    <select id="customer-select" class="select">
                                        <option value="" selected>@ViewLocalizer["Choose customer"]</option>
                                    </select>
                                </div>
                                <div class="col-lg-2 col-sm-2 col-2 ps-0">
                                    <div class="add-icon">
                                        <a id="add-customer-modal" href="javascript:void(0);">
                                            <img src="/vendor/img/icons/plus1.svg" alt="img">
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row form-group">
                        <label class="form-label">@ViewLocalizer["Address"]</label>
                        <div class="col-lg-10 col-sm-10 col-10">
                            <input id="customer-address" class="form-control" readonly />
                        </div>
                    </div>
                    <div class="row form-group">
                        <label class="form-label">@ViewLocalizer["Zone"]</label>
                        <div class="col-lg-10 col-sm-10 col-10">
                            <select id="customer-zone1">
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <label class="form-label">@ViewLocalizer["Número de teléfono"]</label>
                        <div class="col-lg-10 col-sm-10 col-10">
                            <select id="customer-select-phone" class="select">
                                <option value="">@ViewLocalizer["Choose phone number"]</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="info-submit" type="button" class="btn btn-primary me-3 waves-effect waves-light" data-bs-dismiss="modal">@ViewLocalizer["Submit"]</button>
                    <button type="button" class="btn btn-danger waves-effect" data-bs-dismiss="modal">@ViewLocalizer["Cancel"]</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Seat Client modal -->
    <div class="modal fade" id="seatinfomodal" data-bs-backdrop="static" role="dialog" aria-hidden="true" data-id="">
        <div class="modal-dialog modal-dialog-centered modal-simple" role="document">
            <div class="modal-content">
@*                 <div class="modal-header">
                    <h5 class="group-modal-title">@ViewLocalizer["Seat Info"]</h5>
                    <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div> *@
                <div class="modal-body">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    <div class="text-center mb-6">
                        <h4 class="group-modal-title mb-2">
                            @ViewLocalizer["Seat Info"]
                        </h4>
                    </div>
                    <div class="row form-group">
                        <label class="form-label">@ViewLocalizer["Nombre de Cliente"]</label>
                        <div class="row">
                            <div class="col-lg-10 col-sm-10 col-10">
                                <select id="customer-select-seat" class="select ">
                                    <option value="">@ViewLocalizer["Choose customer"]</option>
                                </select>
                            </div>
                            <div class="col-lg-2 col-sm-2 col-2 ps-0">
                                <div class="add-icon">
                                    <a id="add-customer-modal-seat" href="javascript:void(0);">
                                        <img src="/vendor/img/icons/plus1.svg" alt="img">
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="seatinfo-submit" type="button" class="btn btn-primary me-3 waves-effect waves-light">@ViewLocalizer["Submit"]</button>
                    <button type="button" class="btn btn-label-secondary waves-effect" data-bs-dismiss="modal">@ViewLocalizer["Cancel"]</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Combine Seat modal -->
    <div class="modal fade" id="seatcombinemodal" data-bs-backdrop="static" role="dialog" aria-hidden="true" data-id="">
        <div class="modal-dialog modal-dialog-centered modal-simple" role="document">
            <div class="modal-content">
@*                 <div class="modal-header">
                    <h5 class="group-modal-title">@ViewLocalizer["Combine Seat"]</h5>
                    <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div> *@
                <div class="modal-body">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    <div class="text-center mb-6">
                        <h4 class="group-modal-title mb-2">
                            @ViewLocalizer["Combine Seat"]
                        </h4>
                    </div>
                    <div class="row form-group">
                        <div class="radio">
                            <label class="form-label">
                                @ViewLocalizer["Target Seat"]"
                            </label>
                            <select id="another-seats-combine" class="select">
                            </select>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="combine-submit" type="button" class="btn btn-primary me-3 waves-effect waves-light">@ViewLocalizer["Submit"]</button>
                    <button type="button" class="btn btn-label-secondary waves-effect" data-bs-dismiss="modal">@ViewLocalizer["Cancel"]</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="listcustomer" data-bs-backdrop="static" role="dialog" aria-hidden="true" data-id="">
        <div class="modal-dialog modal-lg modal-dialog-centered modal-simple" role="document">
            <div class="modal-content">
@*                 <div class="modal-header">
                    <h5 class="group-modal-title">@ViewLocalizer["Customer List"]</h5>
                    <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div> *@
                <div class="modal-body">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    <div class="text-center mb-6">
                        <h4 class="group-modal-title mb-2">
                            @ViewLocalizer["Customer List"]
                        </h4>
                    </div>
                    <div class="row">
                        <div class="col-12">
                            <a onclick="AddCustomer()" href="javascript:void(0);" class="btn btn-primary waves-effect waves-light"><i class="fa fa-plus me-2"></i>@ViewLocalizer["Add Customer"]</a>
                        </div>
                        <div class="col-12">
                            <div class="card-datatable table-responsive w-100" style="max-height:400px;">
                                <table id="customer-list" class="table" style="position:relative;">
                                    <thead class="table-light" style="position: sticky; top: 0; z-index:2;">
                                        <tr>
                                            <th>@ViewLocalizer["Action"]</th>                                            
                                            <th>@ViewLocalizer["Name"] </th>
                                            <th>@ViewLocalizer["Phone"] </th>
                                            <th>@ViewLocalizer["Dirección"]</th>
                                        </tr>
                                    </thead>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-label-secondary waves-effect" data-bs-dismiss="modal">@ViewLocalizer["Cancel"]</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="addcustomer" data-bs-backdrop="static" role="dialog" aria-hidden="true" data-id="">
        <div class="modal-dialog modal-lg modal-dialog-centered modal-simple" role="document">
            <div class="modal-content">
@*                 <div class="modal-header">
                    <h5 class="supplier-modal-title">@ViewLocalizer["Add/Edit Customer"]</h5>
                    <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div> *@
                <div class="modal-body">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    <div class="text-center mb-6">
                        <h4 class="group-modal-title mb-2">
                            @ViewLocalizer["Add/Edit Customer"]
                        </h4>
                    </div>
                    <div class="row">
                        <div class="mb-6" style="margin-bottom: 30px; margin-top: 20px">
						    <div class="contenedor">
                                <h5 class="titulo">Datos Fiscales</h5>
                                <div class="col-12">
                                    <div class="form-group">
                                        <label class="form-label">@ViewLocalizer["RNC"]<span class="manitory">*</span></label>
                                        <input id="customer-rnc" type="text" class="form-control mb-2" aria-describedby="basic-addon1" required>
                                        <a id="carga-datos-rnc" href="javascript:void(0);" class="btn btn-primary waves-effect waves-light">Validar</a>
                                        <div class="divloading mt-2" style="display: none">
                                            <div class="spinner-border text-primary " role="status" style="width: 15px; height: 15px">
                                                <span class="visually-hidden">Loading...</span>
                                            </div>
                                            Validando...
                                        </div>
                                        <label id="label-rnc-validado" class="form-label mt-1" style="color: green" hidden>El RNC es valido!<span class="manitory"></span></label>
                                        <label id="label-rnc-novalidado" class="form-label mt-1" style="color: red" hidden>El RNC no pudo ser validado!<span class="manitory"></span></label>
                                    </div>
                                </div>
                                <div class="col-12">
                                    <div class="form-group">
                                        <label class="form-label">@ViewLocalizer["Compañia"]<span class="manitory">*</span></label>
                                        <input id="compania-name" type="text" class="form-control" aria-describedby="basic-addon1" readonly>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="mb-6" style="">
						    <div class="contenedor">
                                <h5 class="titulo">Datos Generales</h5>
                                <div class="col-lg-6 col-sm-6 col-12">
                                    <div class="form-group">
                                        <label class="form-label">@ViewLocalizer["Name"]<span class="manitory">*</span></label>
                                        <input id="customer-name" type="text" class="form-control" aria-describedby="basic-addon1" required>
                                    </div>
                                </div>
                                <div class="col-lg-6 col-sm-6 col-12">
                                    <div class="form-group">
                                        <label class="form-label">@ViewLocalizer["Phone"]<span class="manitory">*</span></label>
                                        <input id="customer-phone" type="text" class="form-control" required>
                                    </div>
                                </div>
                                <div class="col-12">
                                    <div class="form-group">
                                        <label class="form-label">@ViewLocalizer["Dirección"]<span class="manitory">*</span></label>
                                        <input id="customer-address1" type="text" class="form-control" aria-describedby="basic-addon1" required>
                                    </div>
                                </div>
                                <div class="col-12">
                                    <div class="form-group">
                                        <label class="form-label">@ViewLocalizer["Dirección Complementaria"]</label>
                                        <input id="customer-address2" type="text" class="form-control" required>
                                    </div>
                                </div>
                                @*                         <div class="col-lg-6 col-sm-6 col-12">
                            <div class="form-group">
                                <label class="form-label">@ViewLocalizer["RNC"]<span class="manitory">*</span></label>
                                <input id="customer-rnc" type="text" class="form-control" required>
                            </div>
                        </div> *@
                                <div class="col-lg-6 col-sm-6 col-12">
                                    <div class="form-group">
                                        <label class="form-label">@ViewLocalizer["Comprobantes"]</label>
                                        <select id="customer-voucher" class="select ">
                                            <option value="">@ViewLocalizer["Choose comprobantes"]</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-lg-6 col-sm-6 col-12">
                                    <div class="form-group">
                                        <label class="form-label">@ViewLocalizer["Zona"]<span class="manitory">*</span></label>
                                        <select id="customer-zone" class="select ">
                                            <option value="">Zonas</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-lg-6 col-sm-6 col-12">
                                    <div class="form-group">
                                        <label class="form-label">@ViewLocalizer["Email"]</label>
                                        <input id="customer-email" type="text" class="form-control" required>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
                <div class="modal-footer">
                    <button id="edit-customer" type="button" class="btn btn-primary me-3 waves-effect waves-light">@ViewLocalizer["Submit"]</button>
                    <button type="button" class="btn btn-label-secondary waves-effect" data-bs-dismiss="modal">@ViewLocalizer["Cancel"]</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="orderdeliverymodal" data-bs-backdrop="static" role="dialog" aria-hidden="true" data-id="">
        <div class="modal-dialog modal-lg modal-dialog-centered modal-simple" role="document">
            <div class="modal-content">
@*                 <div class="modal-header">
                    <h5 class="supplier-modal-title">@ViewLocalizer["Información de envio"]</h5>
                    <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div> *@
                <div class="modal-body">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    <div class="text-center mb-6">
                        <h4 class="group-modal-title mb-2">
                            @ViewLocalizer["Información de envio"]
                        </h4>
                    </div>
                    <div class="row">
                        <div class="col-12">
                            <div class="form-group">
                                <label class="form-label">@ViewLocalizer["Dirección"]<span class="manitory">*</span></label>
                                <input id="delivery-address1" type="text" class="form-control" aria-describedby="basic-addon1" value="Para llevar" required>
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="form-group">
                                <label class="form-label">@ViewLocalizer["Dirección Complementaria"]</label>
                                <input id="delivery-address2" type="text" class="form-control" value="Para llevar" required>
                            </div>
                        </div>
                        <div class="col-lg-6 col-sm-6 col-12">
                            <div class="form-group">
                                <label class="form-label">@ViewLocalizer["Comentarios"]</label>
                                <input id="delivery-comments" type="text" class="form-control" value="Para llevar" required>
                            </div>
                        </div>
                        <div class="col-lg-6 col-sm-6 col-12">
                            <div class="form-group">
                                <label class="form-label">@ViewLocalizer["Zona"]<span class="manitory">*</span></label>
                                <select id="delivery-zone" class="select ">
                                    <option value="">Zonas</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="edit-order-delivery" type="button" class="btn btn-primary me-3 waves-effect waves-light">@ViewLocalizer["Submit"]</button>
                    <button type="button" class="btn btn-label-secondary waves-effect" data-bs-dismiss="modal">@ViewLocalizer["Cancel"]</button>
                </div>
            </div>
        </div>
    </div>


    <!-- Person Count -->
    <div class="modal fade" id="seatcount" data-bs-backdrop="static" tabindex="-1" role="dialog" aria-hidden="true" data-id="">
        <div class="modal-dialog modal-dialog-centered modal-simple" role="document">
            <div class="modal-content">
@*                 <div class="modal-header">
                    <h5 class="smartbuton-modal-title">@ViewLocalizer["Set Person Number"]</h5>
                    <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div> *@
                <div class="modal-body">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    <div class="text-center mb-6">
                        <h4 class="group-modal-title mb-2">
                            @ViewLocalizer["Set Person Number"]
                        </h4>
                    </div>
                    <div class="row">
                        <div class="form-group text-center">
                            <input id="person-number" class="keyboard-pad w-50" onkeypress="return onlyDecimalKey(event)" value="" type="text" readonly>
                            <label class="pt-2"><span class="text-success">Max Seat: </span> <span id="max-seat"></span></label>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col text-center p-2"><button type="button" class="btn-keyboard btn btn-secondary">7</button></div>
                        <div class="col text-center p-2"><button type="button" class="btn-keyboard btn btn-secondary">8</button></div>
                        <div class="col text-center p-2"><button type="button" class="btn-keyboard btn btn-secondary">9</button></div>
                        <div class="col text-center p-2"><button type="button" class="btn-keyboard btn btn-outline-danger">&#8592</button></div>
                    </div>
                    <div class="row">
                        <div class="col  text-center p-2"><button type="button" class="btn-keyboard btn btn-secondary">4</button></div>
                        <div class="col  text-center p-2"><button type="button" class="btn-keyboard btn btn-secondary">5</button></div>
                        <div class="col  text-center p-2"><button type="button" class="btn-keyboard btn btn-secondary">6</button></div>
                        <div class="col  text-center p-2"><button type="button" class="btn-keyboard btn btn-outline-primary">C</button></div>
                    </div>
                    <div class="row">
                        <div class="col text-center p-2"><button type="button" class="btn-keyboard btn btn-secondary">1</button></div>
                        <div class="col text-center p-2"><button type="button" class="btn-keyboard btn btn-secondary">2</button></div>
                        <div class="col text-center p-2"><button type="button" class="btn-keyboard btn btn-secondary">3</button></div>
                        <div class="col text-center p-2"><button type="button" class="btn-keyboard btn btn-secondary">0</button></div>
                    </div>
                </div>
                <div class="modal-footer justify-content-center">
                    <button id="submit-table" type="button" class="btn btn-primary me-3 waves-effect waves-light">@ViewLocalizer["Submit"]</button>
                    <button type="button" class="btn btn-label-secondary waves-effect" data-bs-dismiss="modal">@ViewLocalizer["Cancel"]</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Product List -->
    @{
             @await Component.InvokeAsync("ProductList", new { })
    }

</body>
</html>
<script>
    function mostrarFechaHora() {
      const opciones = { 
        year: '2-digit', 
        month: 'long', 
        day: 'numeric',
        hour: '2-digit', 
        minute: '2-digit'
      };
      
      const fecha = new Date();
      const fechaHora = fecha.toLocaleString('es-ES', opciones);
      
      const fechaHoraFormateada = fechaHora.replace(',', '').replace(' AM', '').replace(' PM', '');
      
      document.getElementById('fecha-hora').textContent = fechaHoraFormateada;
    }

    mostrarFechaHora();

    setInterval(mostrarFechaHora, 60000);

    let code = "";
    let CurrentSeat = 1;
    let reading = false;
    let showPopover = false;
    var productIdCounter = 0;
    var seatcolors = ["#E3242B", "#4E0707", "#493F5E", "#234F1E", "#002D62", "#880085", "#F25278", "#FE7D6A", "#4A2511", "#80471C", "#8A3324", "#B87333", "#CC7722", "#1A2421", "#010127", "#610C04", "#4E0707", "#B22222", "#ED820E", "#ED7117", "#F9E076", "#DCD7A0", "#C49102", "#354A21", "#4E2A84"];
    let itemMap = {};

    document.addEventListener('keypress', e => {
        if (e.keyCode === 13) {

            if (code.length >= 8) {
                AddOrderItem2(code);
                code = "";
            }
        } else {
            code += e.key; //while this is not an 'enter' it stores the every key
        }

        //run a timeout of 200ms at the first read and clear everything
        if (!reading) {
            reading = true;
            setTimeout(() => {
                code = "";
                reading = false;
            }, 200);  //200 works fine for me but you can adjust it
        }
    });

    document.getElementById('question-cancel').addEventListener('click', function () {
        var modal = document.getElementById('forcedquestionmodal');
        var bsModal = bootstrap.Modal.getInstance(modal);
        //bsModal.hide();
        CustomModalHide("#forcedquestioncustommodal");
        $(".popover").remove();
        showPopover = false;
        ShowLoader();
        //Borramos el item por que se cancelo
        $(".textmen").html("");
        var itemId = $("#forcedquestionmodal").data("itemid");
        var data = {
            ItemId: itemId,
            ReasonId: 0
        };

        var modifyItemId = $("#menuoptionmodal").data("itemid");
        
        if (itemId!=modifyItemId){
            $.ajax({
                url: "/POS/VoidOrderItem",
                type: "POST",
                data: JSON.stringify(data),
                contentType: 'application/json;',
                dataType: 'json',
                success: function (data, textStatus, jqXHR) {
                    LoadOrderItems();
                    $("#menuoptionmodal").modal("hide");
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                }
            });
        }else{
            LoadOrderItems();
            $("#menuoptionmodal").modal("hide");
        }

        
    });

    $(".search-product").click(function () {
        $("#listproduct").modal("show");
    });

    function SelectProduct(productId) {
        AddOrderItem(productId, 0, 1, 0);
        $("#listproduct").modal("hide");
    }

    function LoadPrepareTypes() {
        $.ajax({
            url: "/Setting/GetPrepareTypes?justData=true",
            type: "POST",
            success: function (data) {
                $("#MesaMenuModelOptions").empty();

                for (var i = 0; i < data.data.length; i++) {
                    var d = data.data[i];

                    var html =
                        `
                        <div class="col-4 p-2">
                        <button class="btn-menu btn-menumesa btn btn-primary" data-mesa="${d.id}">${d.name}</button>
                        </div>
                            `
                    $("#MesaMenuModelOptions").append(html);
                }

                $(".btn-menumesa").click(function () {
                        var type = $(this).data("mesa");

                        $.ajax({
                            url: "/POS/UpdatePrepareType?orderId=@Model.ID&type=" + type,
                            type: "POST",
                            success: function (data, textStatus, jqXHR) {
                                if (data.status == 0) {
                                    $("#mesamenumodal").modal("hide");
                                    $("#order-mesa").text(data.type);
                                    $("#order-mesa-header").text(data.type);
                                    LoadOrderItems();
                                }
                                else {
                                    if (data.status == 2) {
                                        toastr.error("@ViewLocalizer["En ordenes pagadas no se puede modificar el prepare type"]", {})
                                    } else {
                                        toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                                    }

                                }
                            },
                            error: function (jqXHR, textStatus, errorThrown) {
                                toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                            }
                        });
                    })

            },
            error: function (jqXHR) {
                toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
            }
        });
    }



    $(document).ready(function () {
        GetWorkDay();
        //SelectCustomer();
        //SelectCustomerPhone();
        SelectVoucher();
        SelectZones();
        AdjustHeight();
        LoadPrepareTypes();
        var defaultDeliveryValue = "Para llevar";
        setVisualMode();

        let more_menu_on = false;

        $("#carga-datos-rnc").click(function () {

            const rnc = $('#customer-rnc').val();

            $('#label-rnc-validado').prop('hidden', true);
            $('#label-rnc-novalidado').prop('hidden', true);
            $('.divloading').show();

            $.ajax({
                url: "/Setting/ObtenerDatosDGII",
                type: "POST",
                dataType: "json",
                data: { RNC: rnc },
                success: function (response) {
                    $('.divloading').hide();

                    if (response) {
                        console.log(response);

                        if(response.isValid === true) {
                            $('#compania-name').val(response.compania);
                            $('#customer-name').val(response.nombre);

                            voucher = {
								name: "Credito Fiscal",
								class: "B01",
								reorder: 0,
								secuencia: 11734,
								isPrimary: false,
								isRequireRNC: true,
								taxes: null,
								id: 2,
								createdDate: "2024-03-11T17:22:48.568779Z",
								updatedDate: "2024-09-03T21:01:30.182946Z",
								isActive: true,
								isDeleted: false,
								createdBy: "ADMIN",
								updatedBy: "ADMIN",
								forceDate: null,
								forceUpdatedBy: null
							}
							SelectVoucher(voucher);

                            toastr.success("El RNC es valido!", { showMethod: "fadeIn", hideMethod: "fadeOut", timeOut: 2000 });
                            $('#label-rnc-validado').prop('hidden', false);
                            $('#label-rnc-novalidado').prop('hidden', true);
                        } else {
                            $('#compania-name').val("");

                            toastr.error("El RNC no es valido", { showMethod: "fadeIn", hideMethod: "fadeOut", timeOut: 2000 });
                            $('#label-rnc-validado').prop('hidden', true);
                            $('#label-rnc-novalidado').prop('hidden', false);
                        }
                    } else {
                            $('#compania-name').val("");

                            toastr.error("Ocurrió un error inesperado", { showMethod: "fadeIn", hideMethod: "fadeOut", timeOut: 2000 });
                            $('#label-rnc-validado').prop('hidden', true);
                            $('#label-rnc-novalidado').prop('hidden', false);
                    }
                },
                error: function (xhr, status, error) {
                    $('.divloading').hide();
					$('#compania-name').val("");

                    //console.error("Error en la petición AJAX:", error);
                    toastr.error("Error en la petición AJAX" + error, { showMethod: "fadeIn", hideMethod: "fadeOut", timeOut: 2000 });
                    $('#label-rnc-validado').prop('hidden', true);
                    $('#label-rnc-novalidado').prop('hidden', false);
                }
            });

        });

        function LoadOrderItems2(itemId) {

            ShowLoader();
            $.ajax({
                url: "/POS/GetOrderItemsInBarcode?orderId=@Model.ID",
                type: "POST",
                success: function (data, textStatus, jqXHR) {
                    $("#order-item-list").empty();
                    HideLoader();

                    var html = ``;

                    for (var i = 0; i < data.items.length; i++) {
                        var d = data.items[i];
                        var barcode = d.product.barcode;
                        if (!barcode || barcode == "null") barcode = "";

                        var taxrates = "";
                        if (d.taxes.length > 0) {
                            for (var j = 0; j < d.taxes.length; j++) {
                                var t = d.taxes[j];
                                if (!t.isExempt) {
                                    if (taxrates !== "")
                                        taxrates += ", "
                                    taxrates += "" + t.percent + "%"
                                }
                            }
                        }

                        html += `
                                    <div class="order-item tr1" data-id="${d.id}" data-status="${d.status}">
                                    <div class="td1 text-start">${d.name}</div>
                                    <div class="td1"><input class="item-qty form-control text-center" value="${d.qty}" /></div>
                                    <div class="td1">${d.price.toFixed(2)}</div>
                                    <div class="td1">${d.subTotal.toFixed(2)}</div>
                                    <div class="td1">${d.tax.toFixed(2)}</div>
                                    <div class="td1">${taxrates}</div>
                                    <div class="td1"><img class="void-orderitem" src="/vendor/img/icons/delete.svg" /></div>
                                `;

                        if (d.discounts && d.discounts.length > 0) {
                            html += `<div class="sub-items sub-items-discount">`;
                            for (var k = 0; k < d.discounts.length; k++) {
                                var q = d.discounts[k];
                                html += `<div class="item"><span class="">${q.name}</span><span class="">-${q.amount.toFixed(2)}</span></div>`;
                            }
                            html += `</div>`;
                        }

                        html += `</div>`;
                    }

                    $("#order-item-list").append(html);

                    $(".order-item").each(function () {
                        var id = $(this).data("id");
                        if (id == itemId) {
                            $(this).addClass("active");
                            var inp = $(this).find(".item-qty");
                            var qty = inp.val();
                            inp.focus();
                            inp.val("");
                            inp.val(qty);
                        }
                    })

                    var total = numberWithCommas(data.order.totalPrice.toFixed(2))
                    $("#order-total").text("$" + total);
                    $("#order-tax").text("$" + data.order.tax.toFixed(2));
                    $(".order-tax-items").empty();
                    if (data.order.taxes && data.order.taxes.length > 0) {
                        html = `<div class="sub-items subitems-tax">`;
                        for (var k = 0; k < data.order.taxes.length; k++) {
                            var q = data.order.taxes[k];
                            html += `<div class="item px-3 d-flex justify-content-between"><span class="">${q.description}</span><span class="">$${q.amount.toFixed(2)}</span></div>`;
                        }
                        html += `</div>`;
                        $(".order-tax-items").append(html);
                    }
                    $("#order-propina").text("$" + data.order.propina.toFixed(2));
                    $(".order-propina-items").empty();
                    if (data.order.propinas && data.order.propinas.length > 0) {
                        html = `<div class="sub-items subitems-propina">`;
                        for (var k = 0; k < data.order.propinas.length; k++) {
                            var q = data.order.propinas[k];
                            html += `<div class="item px-3 d-flex justify-content-between"><span class="">${q.description}</span><span class="">$${q.amount.toFixed(2)}</span></div>`;
                        }
                        html += `</div>`;
                        $(".order-propina-items").append(html);
                    }

                    $("#order-subtotal").text("$" + data.order.subTotal.toFixed(2));
                    $("#order-discount").text("$" + data.order.discount.toFixed(2));
                    $(".order-discount-items").empty();
                    if (data.order.discounts && data.order.discounts.length > 0) {
                        html = `<div class="sub-items subitems-discount">`;
                        for (var k = 0; k < data.order.discounts.length; k++) {
                            var q = data.order.discounts[k];
                            html += `<div class="item px-3 d-flex justify-content-between"><span class="">${q.name}</span><span class="">$${q.amount.toFixed(2)}</span></div>`;
                        }
                        html += `</div>`;
                        $(".order-discount-items").append(html);
                    }
                    html = `<div class="sub-items subitems-discount">`;
                    for (var k = 0; k < data.transactions.length; k++) {
                        var q = data.transactions[k];
                        html += `<div class="item px-3 d-flex justify-content-between"><span class="">${q.method} ${q.note}</span><span class="">$${q.amount.toFixed(2)}</span></div>`;
                    }
                    html += `</div>`;
                    $("#order-discount-items").append(html);

                    $("#order-paid-total").text(data.order.payAmount);
                    if (data.order.paymentStatus == 0) {
                        $("#payment-status").text("Not Paid");
                    }
                    else if (data.order.paymentStatus == 1) {
                        $("#payment-status").text("Partly Paid");
                    }
                    else if (data.order.paymentStatus == 2) {
                        $("#payment-status").text("Paid");
                    }

                    $(".balance").data("balance", data.order.balance.toFixed(2));
                    $(".balance").text("$" + data.order.balance.toFixed(2));
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                }
            });
        }

        $("#product-select").change(function (e) {
            var prodId = $("#product-select").val();
            console.log(prodId);
            AddOrderItem(prodId, 0, 1, 0);

        });

        $(document).on('select2:open', () => {
            document.querySelector('.select2-search__field').focus();
        });

        $(document).on('focus', '.select2-selection.select2-selection--single', function (e) {
            $(this).closest(".select2-container").siblings('select:enabled').select2('open');
        });

        $("#add-customer-modal").click(function () {
            $("#listcustomer").modal("show");
        })

        $("#add-customer-modal-seat").click(function () {
            $("#listcustomer").modal("show");
        })
        

        //Para borrar al cliente de la orden
        $( ".order-client" ).on( "dblclick", function() {
            SelectCustomer(null,true);
        } );
        

        LoadGroup();

        if ('@Model.OrderMode' == 'Divide') {
            $.ajax({
                url: "/POS/GetOrderItemsAtDivide?orderId=@Model.ID",
                type: "POST",
                success: function (data, textStatus, jqXHR) {
                    if (data) {
                        $(".divide-main-panel").empty();
                        var rollprice = 0;
                        for (var i = 0; i < data.length; i++) {
                            var d = data[i];

                            var html = `<div class="divide-account card m-2" data-divideid=${d.divideId}>
                                                    <div class="divide-account-header p-1">Cuanta  #${d.divideId}</div>
                                                    <div class="divide-body">`;

                            for (var j = 0; j < d.items.length; j++) {
                                var item = d.items[j];
                                var seat = "";
                                if (item.seatNum > 0) seat = item.seatNum;

                                html += `<div class="divide-item" data-itemid="${item.id}" data-promotion="${item.hasPromotion}" data-name="${item.name}" data-seat="${item.seatNum}" data-qty="${item.qty}">
                                                        <div class="row">
                                                           <span class="col-2">#${seat}</span>
                                                           <span class="col-7">${item.name}</span>
                                                           <span class="col-3 divide-item-qty">${item.qty.toFixed(2)}</span>
                                                       </div><div class="item-modifiers">`
                                // questions
                                if (item.questions && item.questions.length > 0) {
                                    html += `<div class=" w-100">`;
                                    var divisor = 0;
                                    for (var k = 0; k < item.questions.length; k++) {
                                        var q = item.questions[k];
                                        var divisor_html = '';
                                        if (q.divisor != divisor) {
                                            if (q.divisor == 1) {
                                                divisor_html = `<div class="item justify-content-around d-flex"><span class="">Completa : </span><span class=""></span></div>`;
                                            }
                                            else if (q.divisor == 2) {
                                                divisor_html = `<div class="item justify-content-around d-flex"><span class="">1 Mitad :</span><span class=""></span></div>`;
                                            }
                                            else if (q.divisor == 3) {
                                                divisor_html = `<div class="item justify-content-around d-flex"><span class="">2 Mitad : </span><span class=""></span></div>`;
                                            }

                                            divisor = q.divisor;
                                        }
                                        var showDesc = false;
                                        if (q.isPreSelect) {
                                            if (!q.isActive) {
                                                html += divisor_html;
                                                html += `<div class="item mx-2 justify-content-around d-flex"><span class="">${q.description}</span><span class=""></span></div>`;
                                                showDesc = true;
                                            }
                                            // else if (q.divisor != 0 || q.qty > 1 || q.subDescription) {
                                            //     html += divisor_html;
                                            //     html += `<div class="item mx-2 justify-content-around d-flex"><span class="">${q.description}</span><span class=""></span></div>`;
                                            //     showDesc = true;
                                            // }
                                        }
                                        else {
                                            if (q.canRoll) {
                                                rollprice += q.price;
                                                html += divisor_html;
                                                html += `<div class="item mx-2 justify-content-around d-flex"><span class="">${q.description}</span><span class=""></span></div>`;
                                                showDesc = true;
                                            }
                                            else {
                                                var price = q.price * (q.qty - q.freeChoice);
                                                html += divisor_html;
                                                html += `<div class="item mx-2 justify-content-around d-flex"><span class="">${q.description}</span><span class=""></span></div>`;
                                                showDesc = true;
                                            }
                                        }
                                        if (showDesc && q.subDescription) {
                                            html += `<div class="item mx-2 justify-content-around d-flex"><span class="mx-3"> ${q.subDescription}</span><span class=""></span></div>`;
                                        }
                                    }
                                    html += `</div>`;
                                }
                                // discounts
                                if (item.discounts && item.discounts.length > 0) {
                                    html += `<div class="justify-content-around d-flex w-100">`;
                                    for (var k = 0; k < item.discounts.length; k++) {
                                        var q = item.discounts[k];
                                        html += `<span class="">${q.name}</span><span class=""></span>`;
                                    }
                                    html += `</div>`;
                                }

                                html += `</div></div>`;
                            }
                            if (i == 0) {
                                html += `</div><div class="divide-account-footer p-1">
                                            <button type="button" class="btn divide-print">@ViewLocalizer["Print"]</button>
                                    </div>`

                            }
                            else {
                                html += `</div><div class="divide-account-footer p-1">
                                                <button type="button" class="btn divide-remove">@ViewLocalizer["Delete"]</button>
                                                <button type="button" class="btn divide-print">@ViewLocalizer["Print"]</button>
                                        </div>`
                            }

                            html += `</div>`
                            $(".divide-main-panel").append(html);
                        }
                        var htmladd = `<div class="divide-account-add card m-2" >
                                                <div class="divide-body" style = "height:50vh;" >
                                                    <div class="divide-item-add" >
                                                        <img src="/vendor/img/icons/plus1.svg" />
                                                    </div>
                                                </div>
                                            </div>`;
                        $(".divide-main-panel").append(htmladd);
                    }
                    $("#dividemodal").modal("show");
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                }
            });
        }
        else {
            LoadOrderItems();
        }

        $("#order-info").click(function () {
            //$("#orderinfo").modal("show");
            $("#listcustomer").modal("show");
            $("#ordermenuoptionmodal").modal("hide");
        });

        $("#order-tools").click(function () {
            if(more_menu_on) {
                $('#more-menu').hide();
                more_menu_on = false;
            } else {
                $('#more-menu').show();
                more_menu_on = true;
            }
            
            //$("#ordermenuoptionmodal").modal("show");
        });

        document.addEventListener("click", function(event) {
            let menu = document.getElementById("order-tools");
            if (!menu.contains(event.target)) {
                console.log('a')
                console.log(event.target)
                $('#more-menu').hide();
                more_menu_on = false;
            }

        });

        $(".btn-keyboard").click(function () {
            var txt = $(this).text();
            var current = $("#person-number").val();

            if (txt == 'C') {
                current = "";
            }
            else if (txt == '←') {
                current = current.substring(0, current.length - 1);
            }
            else {
                current += txt;
            }

            var val = parseInt(current);
            if (!val || val == 0) {
                $("#person-number").val("");
            }
            else {
                $("#person-number").val(val);
            }
        });

        $("#order-person").click(function () {
            $("#seatcount").data("order", "@Model.ID");

            if (1 == @(Model.OrderType == OrderType.Delivery ? 1 : 0)) {
                $("#seatcount").data("table", "-1");
                $("#seatcount").data("seat", 10);
                $("#max-seat").text(10);
            } else {

                $("#seatcount").data("table", "@(Model.Table != null ? Model.Table.ID : -1)");
                $("#seatcount").data("seat", @(Model.Table != null ? Model.Table.SeatCount : 0));
                $("#max-seat").text(@(Model.Table != null ? Model.Table.SeatCount : 0));
                $("#person-number").val(0);
            }

            $("#seatcount").modal("show");
        });

        $("#submit-table").click(function(){
            var order = $("#seatcount").data("order");
            //var obj = $("#seatcount").data("table");
            var seat = parseInt($("#seatcount").data("seat"));
            var person = parseInt($("#person-number").val());

            if (!person || person > seat) {
                toastr.error("@ViewLocalizer["Invalid person number."]", {})
                return;
            }

            $.ajax({
                url: "/POS/updatePerson?orderId=@Model.ID" + "&person=" + person,
                type: "POST",
                success: function (response, textStatus, jqXHR) {
                    if (response.status == 1) {
                        $("#div-person").html(person);
                        $("#seatcount").modal("hide");
                    }
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                }
            });
        });

        $("#order-delivery").click(function () {
            $.ajax({
                url: "/POS/GetDelivery?orderId=@Model.ID",
                type: "POST",
                success: function (response, textStatus, jqXHR) {
                    if (response.status == 0) {
                        $("#delivery-address1").val(response.data.address1);
                        $("#delivery-address2").val(response.data.address2);
                        $("#delivery-comments").val(response.data.comments);
                        $("#delivery-zone").val(response.data.deliveryZoneID).change();
                    }
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                }
            });

            $("#orderdeliverymodal").modal("show");
        });

        $("#order-mode").click(function () {
            var items = $(".order-item");
            if (!items || items.length == 0) {
                if ('@Model.OrderType' == 'DiningRoom') {
                    $.ajax({
                        url: "/POS/ChangeModel?orderId=@Model.ID",
                        type: "POST",
                        success: function (data, textStatus, jqXHR) {
                            if (data.status == 0) {
                                window.location.replace("/POS/Sales?orderId=@Model.ID")
                            }
                        },
                        error: function (jqXHR, textStatus, errorThrown) {
                            toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                        }
                    });
                }
            }

        });

        $("#btn-modeseat").click(function () {
            $.ajax({
                url: "/POS/ChangeModel?orderId=@Model.ID",
                type: "POST",
                success: function (data, textStatus, jqXHR) {
                    if (data.status == 0) {
                        window.location.replace("/POS/Sales?orderId=@Model.ID")
                    }
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                }
            });
        });

        $("#btn-modestandard").click(function () {
            $.ajax({
                url: "/POS/ChangeModel?orderId=@Model.ID",
                type: "POST",
                success: function (data, textStatus, jqXHR) {
                    if (data.status == 0) {
                        window.location.replace("/POS/Sales?orderId=@Model.ID")
                    }
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                }
            });
        });

        $("#info-submit").click(function () {

            var clientName = $("#customer-select option:selected").text();
            var customerId = clientName !== "" ? parseInt($("#customer-select").val()) : parseInt($("#customer-select-phone").val());
            var phoneNumber = $("#customer-select-phone option:selected").val();
            var dividerid = parseInt($("#divide-num").val());
            if (!customerId) customerId = 0;
            if (!dividerid) dividerid = 0;
            var data = {
                OrderId: @Model.ID,
                ClientName: clientName,
                CustomerId: customerId,
                PhoneNumber: phoneNumber,
                DividerId: dividerid
            };
            ShowLoader();
            $.ajax({
                url: "/POS/UpdateOrderInfo",
                type: "POST",
                data: JSON.stringify(data),
                contentType: 'application/json;',
                dataType: 'json',
                success: function (data, textStatus, jqXHR) {
                    $(".order-client").text(data.customerName);
                    $(".order-comprobante").text(data.comprobanteName);
                    $("#orderinfo").modal("hide");
                    LoadOrderItems();
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                }
            });
        });

        $("body").on("click", ".divide-account-add", function () {

            $(".divide-main-panel").find(".divide-account-add").remove();

            var accounts = $(".divide-account").length + 1;
            var html = `<div class="divide-account card m-2" data-divideid=${accounts}>
                                                    <div class="divide-account-header p-1">Cuanta  #${accounts}</div>
                                                    <div class="divide-body"></div><div class="divide-account-footer p-1">
                                        <button type="button" class="btn divide-remove">@ViewLocalizer["Delete"]</button>
                                        <button type="button" class="btn divide-print">@ViewLocalizer["Print"]</button>
                                </div></div>`;

            $(".divide-main-panel").append(html);

            var htmladd = `<div class="divide-account-add card m-2" >
                                                        <div class="divide-body" style = "height:50vh;" >
                                                            <div class="divide-item-add" >
                                                                <img src="/vendor/img/icons/plus1.svg" />
                                                            </div>
                                                        </div>
                                                    </div>`;
            $(".divide-main-panel").append(htmladd);
        });

        $("#divide-selectedproduct").click(function () {
            var selectedItem = $(".divide-item.selected");
            if (selectedItem && selectedItem.length > 0) {
                $("#divideqty-number").val("");
                $("#dividequantitymodal").data("mode", "selected");
                $("#dividequantitymodal").modal("show");
            }
        })

        $("#divide-splitwhole").click(function () {
            $("#divideqty-number").val("");
            $("#dividequantitymodal").data("mode", "whole");
            $("#dividequantitymodal").modal("show");
        })

        $("#submit-divideqty").click(function () {
            var qty = parseInt($("#divideqty-number").val());
            if (!qty || qty <= 1) return;
            var mode = $("#dividequantitymodal").data("mode");
            if (mode == "whole") {
                $.ajax({
                    url: "/POS/GetOrderItemsAtDivideSplited?orderId=@Model.ID&qty=" + qty,
                    type: "POST",
                    success: function (data, textStatus, jqXHR) {
                        if (data) {
                            $(".divide-main-panel").empty();
                            for (var i = 0; i < data.length; i++) {
                                var d = data[i];

                                var html = `<div class="divide-account card m-2" data-divideid=${d.divideId}>
                                                    <div class="divide-account-header p-1">Cuanta  #${d.divideId}</div>
                                                    <div class="divide-body">`;

                                for (var j = 0; j < d.items.length; j++) {
                                    var item = d.items[j];
                                    var seat = "";
                                    if (item.seatNum > 0) seat = item.seatNum;

                                    html += `<div class="divide-item" data-itemid="${item.id}" data-name="${item.name}" data-seat="${item.seatNum}" data-qty="${item.qty}">
                                                    <div class="row">
                                                       <span class="col-2">#${seat}</span>
                                                       <span class="col-7">${item.name}</span>
                                                       <span class="col-3 divide-item-qty">${item.qty.toFixed(2)}</span>
                                                                 </div><div class="item-modifiers">`
                                    // questions
                                    if (item.questions && item.questions.length > 0) {
                                        html += `<div class=" w-100">`;
                                        var divisor = 0;
                                        for (var k = 0; k < item.questions.length; k++) {
                                            var q = item.questions[k];
                                            var divisor_html = '';
                                            if (q.divisor != divisor) {
                                                if (q.divisor == 1) {
                                                    divisor_html = `<div class="item justify-content-around d-flex"><span class="">Completa : </span><span class=""></span></div>`;
                                                }
                                                else if (q.divisor == 2) {
                                                    divisor_html = `<div class="item justify-content-around d-flex"><span class="">1 Mitad :</span><span class=""></span></div>`;
                                                }
                                                else if (q.divisor == 3) {
                                                    divisor_html = `<div class="item justify-content-around d-flex"><span class="">2 Mitad : </span><span class=""></span></div>`;
                                                }

                                                divisor = q.divisor;
                                            }
                                            var showDesc = false;
                                            if (q.isPreSelect) {
                                                if (!q.isActive) {
                                                    html += divisor_html;
                                                    html += `<div class="item mx-2 justify-content-around d-flex"><span class="">${q.description}</span><span class=""></span></div>`;
                                                    showDesc = true;
                                                }
                                                // else if (q.divisor != 0 || q.qty > 1 || q.subDescription) {
                                                //     html += divisor_html;
                                                //     html += `<div class="item mx-2 justify-content-around d-flex"><span class="">${q.description}</span><span class=""></span></div>`;
                                                //     showDesc = true;
                                                // }
                                            }
                                            else {
                                                if (q.canRoll) {
                                                    rollprice += q.price;
                                                    html += divisor_html;
                                                    html += `<div class="item mx-2 justify-content-around d-flex"><span class="">${q.description}</span><span class=""></span></div>`;
                                                    showDesc = true;
                                                }
                                                else {
                                                    var price = q.price * (q.qty - q.freeChoice);
                                                    html += divisor_html;
                                                    html += `<div class="item mx-2 justify-content-around d-flex"><span class="">${q.description}</span><span class=""></span></div>`;
                                                    showDesc = true;
                                                }
                                            }
                                            if (showDesc && q.subDescription) {
                                                html += `<div class="item mx-2 justify-content-around d-flex"><span class="mx-3"> ${q.subDescription}</span><span class=""></span></div>`;
                                            }
                                        }
                                        html += `</div>`;
                                    }
                                    // discounts
                                    if (item.discounts && item.discounts.length > 0) {
                                        html += `<div class="justify-content-around d-flex w-100">`;
                                        for (var k = 0; k < item.discounts.length; k++) {
                                            var q = item.discounts[k];
                                            html += `<span class="">${q.name}</span><span class=""></span>`;
                                        }
                                        html += `</div>`;
                                    }

                                    html += `</div></div>`;
                                }

                                if (i == 0) {
                                    html += `</div><div class="divide-account-footer p-1">
                                                    <button type="button" class="btn divide-print">@ViewLocalizer["Print"]</button>
                                            </div></div>`
                                }
                                else {
                                    html += `</div><div class="divide-account-footer p-1">
                                                <button type="button" class="btn divide-remove">@ViewLocalizer["Delete"]</button>
                                                <button type="button" class="btn divide-print">@ViewLocalizer["Print"]</button>
                                        </div></div>`
                                }
                                $(".divide-main-panel").append(html);
                            }
                            var htmladd = `<div class="divide-account-add card m-2" >
                                                    <div class="divide-body" style = "height:50vh;" >
                                                        <div class="divide-item-add" >
                                                            <img src="/vendor/img/icons/plus1.svg" />
                                                        </div>
                                                    </div>
                                                </div>`;
                            $(".divide-main-panel").append(htmladd);
                        }

                    },
                    error: function (jqXHR, textStatus, errorThrown) {
                        toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                    }
                });
            }
            else {
                var selectedItem = $(".divide-item.selected");

                var itemQty = parseFloat(selectedItem.attr("data-qty"));
                var hasPromotion = selectedItem.data("promotion");
                if (hasPromotion == "True") return;
                var newQty = (itemQty / qty);
                selectedItem.attr("data-qty", newQty);
                selectedItem.find(".divide-item-qty").text(newQty.toFixed(2));
                var source = selectedItem.closest(".divide-account").data("divideid");
                var removed = false;
                for (var i = 0; i < qty; i++) {
                    if (i + 1 > $(".divide-account").length) {
                        $(".divide-main-panel").find(".divide-account-add").remove();
                        removed = true;
                        var html = `<div class="divide-account card m-2" data-divideid=${i + 1}>
                                                        <div class="divide-account-header p-1">Cuanta  #${i + 1}</div>
                                                        <div class="divide-body"></div><div class="divide-account-footer p-1">
                                        <button  type="button" class="btn divide-remove">@ViewLocalizer["Delete"]</button>
                                        <button  type="button" class="btn divide-print">@ViewLocalizer["Print"]</button>
                                </div></div>`;
                        $(".divide-main-panel").append(html);
                    }
                    if (i + 1 != source)
                        CreateItemToAccount(selectedItem, newQty, i + 1);
                }
                if (removed) {
                    var htmladd = `<div class="divide-account-add card m-2" >
                                                        <div class="divide-body" style = "height:50vh;" >
                                                            <div class="divide-item-add" >
                                                                <img src="/vendor/img/icons/plus1.svg" />
                                                            </div>
                                                        </div>
                                                    </div>`;
                    $(".divide-main-panel").append(htmladd);
                }
                $(".divide-item").removeClass("selected");
            }
            $("#dividequantitymodal").modal("hide");

        });

        $("body").on("click", ".divide-remove", function () {
            $(this).closest(".divide-account").find(".divide-item").each(function () {
                MoveItemToAccount($(this), 1, true);
            })

            $(this).closest(".divide-account").remove();
        });

        $("#divide-combine").click(function () {
            $(".divide-account").each(function () {
                var id = $(this).data("divideid");
                if (id != 1) {
                    $(this).find(".divide-item").each(function () {
                        MoveItemToAccount($(this), 1, true);
                    });
                }

            })
        });

        $("#divide-save").click(function () {
            SaveDivide();
        });

        $("#divide-cancel").click(function () {

            $.ajax({
                url: "/POS/GetOrderItems?orderId=@Model.ID",
                type: "POST",
                success: function (data, textStatus, jqXHR) {
                    $("#order-item-list").empty();

                    if (data.order.orderMode == 2) {
                        window.location.replace("/POS/Station");
                    }
                    else {

                        LoadOrderItems();
                        $("#dividemodal").modal("hide");
                    }


                },
                error: function (jqXHR, textStatus, errorThrown) {
                    toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                }
            });
        })

        $("body").on("click", ".divide-account-header", function () {
            var dividerId = parseInt($(this).parent().data("divideid"));
            $("#divide-num").val(dividerId);

            $(".order-client").text("Divide - Cuenta - #" + dividerId);
            SaveDivide(dividerId);
            $("#dividemodal").modal("hide");
        });

        $("#divide-seatsplit").click(function () {
            $.ajax({
                url: "/POS/GetOrderItemsAtDivideSeat?orderId=@Model.ID",
                type: "POST",
                success: function (data, textStatus, jqXHR) {
                    if (data) {
                        $(".divide-main-panel").empty();
                        for (var i = 0; i < data.length; i++) {
                            var d = data[i];

                            var html = `<div class="divide-account card m-2" data-divideid=${i + 1}>
                                                <div class="divide-account-header p-1">Cuanta  #${i + 1}</div>
                                                <div class="divide-body">`;

                            for (var j = 0; j < d.items.length; j++) {
                                var item = d.items[j];
                                var seat = "";
                                if (item.seatNum > 0) seat = item.seatNum;

                                html += `<div class="divide-item" data-itemid="${item.id}" data-promotion="${item.hasPromotion}" data-name="${item.name}" data-seat="${item.seatNum}" data-qty="${item.qty}">
                                                <div class="row">
                                                   <span class="col-2">#${seat}</span>
                                                   <span class="col-7">${item.name}</span>
                                                   <span class="col-3 divide-item-qty">${item.qty.toFixed(2)}</span>
                                                               </div><div class="item-modifiers">`
                                // questions
                                if (item.questions && item.questions.length > 0) {
                                    html += `<div class=" w-100">`;
                                    var divisor = 0;
                                    for (var k = 0; k < item.questions.length; k++) {
                                        var q = item.questions[k];
                                        var divisor_html = '';
                                        if (q.divisor != divisor) {
                                            if (q.divisor == 1) {
                                                divisor_html = `<div class="item justify-content-around d-flex"><span class="">Completa : </span><span class=""></span></div>`;
                                            }
                                            else if (q.divisor == 2) {
                                                divisor_html = `<div class="item justify-content-around d-flex"><span class="">1 Mitad :</span><span class=""></span></div>`;
                                            }
                                            else if (q.divisor == 3) {
                                                divisor_html = `<div class="item justify-content-around d-flex"><span class="">2 Mitad : </span><span class=""></span></div>`;
                                            }

                                            divisor = q.divisor;
                                        }
                                        var showDesc = false;
                                        if (q.isPreSelect) {
                                            if (!q.isActive) {
                                                html += divisor_html;
                                                html += `<div class="item mx-2 justify-content-around d-flex"><span class="">${q.description}</span><span class=""></span></div>`;
                                                showDesc = true;
                                            }
                                            // else if (q.divisor != 0 || q.qty > 1 || q.subDescription) {
                                            //     html += divisor_html;
                                            //     html += `<div class="item mx-2 justify-content-around d-flex"><span class="">${q.description}</span><span class=""></span></div>`;
                                            //     showDesc = true;
                                            // }
                                        }
                                        else {
                                            if (q.canRoll) {
                                                rollprice += q.price;
                                                html += divisor_html;
                                                html += `<div class="item mx-2 justify-content-around d-flex"><span class="">${q.description}</span><span class=""></span></div>`;
                                                showDesc = true;
                                            }
                                            else {
                                                var price = q.price * (q.qty - q.freeChoice);
                                                html += divisor_html;
                                                html += `<div class="item mx-2 justify-content-around d-flex"><span class="">${q.description}</span><span class=""></span></div>`;
                                                showDesc = true;
                                            }
                                        }
                                        if (showDesc && q.subDescription) {
                                            html += `<div class="item mx-2 justify-content-around d-flex"><span class="mx-3"> ${q.subDescription}</span><span class=""></span></div>`;
                                        }
                                    }
                                    html += `</div>`;
                                }
                                // discounts
                                if (item.discounts && item.discounts.length > 0) {
                                    html += `<div class="justify-content-around d-flex w-100">`;
                                    for (var k = 0; k < item.discounts.length; k++) {
                                        var q = item.discounts[k];
                                        html += `<span class="">${q.name}</span><span class=""></span>`;
                                    }
                                    html += `</div>`;
                                }

                                html += `</div></div>`;
                            }

                            if (i == 0) {
                                html += `</div><div class="divide-account-footer p-1">
                                                        <button type="button" class="btn divide-print">@ViewLocalizer["Print"]</button>
                                                </div></div>`
                            }
                            else {
                                html += `</div><div class="divide-account-footer p-1">
                                                    <button type="button" class="btn divide-remove">@ViewLocalizer["Delete"]</button>
                                                    <button type="button" class="btn divide-print">@ViewLocalizer["Print"]</button>
                                            </div></div>`
                            }
                            $(".divide-main-panel").append(html);
                        }
                        var htmladd = `<div class="divide-account-add card m-2" >
                                                    <div class="divide-body" style = "height:50vh;" >
                                                        <div class="divide-item-add" >
                                                            <img src="/vendor/img/icons/plus1.svg" />
                                                        </div>
                                                    </div>
                                                </div>`;
                        $(".divide-main-panel").append(htmladd);
                    }
                    $("#dividemodal").modal("show");
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                }
            });
        });

        $("body").on("click", ".divide-item", function () {
            $(".divide-item").removeClass("selected");
            $(this).addClass("selected");
        });

        $("body").on("click", ".divide-account", function () {
            $(".divide-account").removeClass("selected");
            $(".divide-account-header").removeClass("selected");
            $(this).addClass("selected");
            $(this).find(".divide-account-header").addClass("selected");

            var selectedItem = $(".divide-item.selected");
            if (selectedItem && selectedItem.length > 0) {
                var source = selectedItem.closest(".divide-account").data("divideid");
                var target = $(this).data("divideid");
                if (source != target) {
                    MoveItemToAccount(selectedItem, target)
                }

            }
        });

        $("#btn-order-void").click(function () {
            $("#ordermenuoptionmodal").modal("hide");

            CheckPermission("Permission.POS.VoidOrder", function () {
                $("#voidordermodal").modal("show");
            });
        });

        $("#void-order-submit").click(function () {
            var reasonId = parseInt($("#void-reason-order").data("id"))
            if (!reasonId){
                toastr.error("@ViewLocalizer["Please select a reason"]", {});
                return;
            }
            var pin = $("#input-pin").data("value");
            var data = {
                OrderId: @Model.ID,
                ReasonId: reasonId,
                Pin : pin
            };

            $.ajax({
                url: "/POS/VoidOrder",
                type: "POST",
                data: JSON.stringify(data),
                contentType: 'application/json;',
                dataType: 'json',
                success: function (data, textStatus, jqXHR) {
                    window.location.replace("/POS/Station");
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                }
            });
        });

        $("#order-split").click(function () {
            $("#ordermenuoptionmodal").modal("hide");

            CheckPermission("Permission.POS.Split", function () {
                ShowSplitDialog();
            });
        });

        $("#btn-movetable").click(function () {
            var itemId = $("#menuoptionmodal").data("itemid");
            $("#movetablemodal").data("itemid", itemId);
            $("#menuoptionmodal").modal("hide");
            CheckPermission("Permission.POS.MoveItem", function () {
                $("#movetablemodal").modal("show");
            })
        });

        $("#btn-moveareatable").click(function () {
            var itemId = $("#menuoptionmodal").data("itemid");
            $("#moveareatablemodal").data("itemid", itemId);
            $("#menuoptionmodal").modal("hide");
            CheckPermission("Permission.POS.MoveItemToOtherArea", function () {
                $("#moveareatablemodal").modal("show");
            })
        });

        $("#movetable-submit").click(function () {
            var itemId = parseInt($("#movetablemodal").data("itemid"));
            var table = parseInt($("#another-tables").data("id"));
            if (!table) {
                return;
            }
            var data = {
                ItemId: itemId,
                TableId: table
            }

            $.ajax({
                url: "/POS/MoveItemToAnotherTable",
                type: "POST",
                data: JSON.stringify(data),
                contentType: 'application/json;',
                dataType: 'json',
                success: function (data, textStatus, jqXHR) {
                    LoadOrderItems();
                    $("#movetablemodal").modal("hide");
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                }
            });

        });

        $("#btn-moveseattotable").click(function () {
            var seatnum = $("#seatmenumodal").data("seatnum");
            $("#moveseattablemodal").data("seatnum", seatnum);

            CheckPermission("Permission.POS.MoveSeat", function () {

                $("#moveseattablemodal").modal("show");
            })

            $("#seatmenumodal").modal("hide");
        });

        $("#order-mesa").click(function () {
            $("#mesamenumodal").modal("show");
        });

        $("#moveseattable-submit").click(function () {
            var seatnum = parseInt($("#moveseattablemodal").data("seatnum"));
            var table = parseInt($("#seat-another-tables").val());

            if (!table) {
                return;
            }
            var data = {
                OrderId: @Model.ID,
                SeatNum: seatnum,
                TableId: table
            }

            $.ajax({
                url: "/POS/MoveSeatToAnotherTable",
                type: "POST",
                data: JSON.stringify(data),
                contentType: 'application/json;',
                dataType: 'json',
                success: function (data, textStatus, jqXHR) {
                    CurrentOrder = 1;
                    LoadOrderItems();
                    $("#moveseattablemodal").modal("hide");
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                }
            });
        });

        $("#btn-combineseat").click(function () {
            var seatnum = $("#seatmenumodal").data("seatnum");
            $("#seatcombinemodal").data("seatnum", seatnum);
            var seats = GetAnotherSeats(seatnum);
            if (seats && seats.length > 0) {
                $("#another-seats-combine").empty();
                for (var i = 0; i < seats.length; i++) {
                    var s = seats[i];
                    $("#another-seats-combine").append(`<option value="${s.num}">Seat #${s.num} </option>`);
                }
            }
            else {
                return;
            }
            $("#seatcombinemodal").modal("show");
            $("#seatmenumodal").modal("hide");
        });

        $("#combine-submit").click(function () {
            var source = parseInt($("#seatcombinemodal").data("seatnum"));
            var selected = parseInt($("#another-seats-combine").val());

            var data = {
                OrderId: @Model.ID,
                SourceNum: source,
                TargetNum: selected
            }

            $.ajax({
                url: "/POS/CombineSeat",
                type: "POST",
                data: JSON.stringify(data),
                contentType: 'application/json;',
                dataType: 'json',
                success: function (data, textStatus, jqXHR) {
                    LoadOrderItems();
                    $("#seatcombinemodal").modal("hide");
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                }
            });
        });

        $("#btn-seatinfo").click(function () {
            var seatid = $("#seatmenumodal").data("seatid");
            var seatnum = $("#seatmenumodal").data("seatnum");
            var seatname = $("#seatmenumodal").data("seatname");

            $("#seat-client").val(seatname);
            $("#seatinfomodal").data("seatid", seatid);

            $("#seatinfomodal").modal("show");
            $("#seatmenumodal").modal("hide");
        });

        $("#seatinfo-submit").click(function () {
            var seatId = parseInt($("#seatinfomodal").data("seatid"));
            var clientName = $("#customer-select-seat option:selected").text();
            var customerId = parseInt($("#customer-select-seat").val());
            var data = {
                SeatId: seatId,
                ClientName: clientName,
                ClientId: customerId
            };

            $.ajax({
                url: "/POS/UpdateSeatName",
                type: "POST",
                data: JSON.stringify(data),
                contentType: 'application/json;',
                dataType: 'json',
                success: function (data, textStatus, jqXHR) {
                    LoadOrderItems();
                    $("#seatinfomodal").modal("hide");
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                }
            });
        });

        // item menu
        $("#btn-hold").click(function () {
            var itemId = $("#menuoptionmodal").data("itemid");
            $("#holdordermodal").data("itemid", itemId);

            $("#menuoptionmodal").modal("hide");
            $("#holdordermodal").modal("show");
        });

        $("#hold-submit").click(function () {
            var id = parseInt($("#holdordermodal").data("itemid"));
            var type = parseInt($("#hold-type").val());
            var hour = parseInt($("#hold-hour").val());
            var min = parseInt($("#hold-minutes").val());
            if (type == 2 && hour == 0 && min == 0) {
                toastr.warning("@ViewLocalizer["Please select the time for automatic setting"]", {})
            }
            var data = {
                ItemId: id,
                Type: type,
                Hour: hour,
                Minute: min
            }

            $.ajax({
                url: "/POS/HoldOrderItem",
                type: "POST",
                data: JSON.stringify(data),
                contentType: 'application/json;',
                dataType: 'json',
                success: function (data, textStatus, jqXHR) {
                    LoadOrderItems();
                    $("#holdordermodal").modal("hide");
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                }
            });
        });

        $("#btn-fire").click(function () {
            var itemId = parseInt($("#menuoptionmodal").data("itemid"));

            var data = {
                ItemId: itemId
            }
            $.ajax({
                url: "/POS/FireOrderItem",
                type: "POST",
                data: JSON.stringify(data),
                contentType: 'application/json;',
                dataType: 'json',
                success: function (data, textStatus, jqXHR) {
                    LoadOrderItems();
                    $("#menuoptionmodal").modal("hide");
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                }
            });
        });

        $("#btn-note").click(function () {
            var itemId = parseInt($("#menuoptionmodal").data("itemid"));
            $("#coursenotemodal").data("itemid", itemId);

            $.ajax({
                url: "/POS/GetCourseNote?itemId=" + itemId,
                type: "POST",
                contentType: 'application/json;',
                dataType: 'json',
                success: function (data, textStatus, jqXHR) {
                    if (data.courses) {
                        $("#item-course").empty();
                        for(var i = 0; i < data.courses.length; i++) {
                            var d = data.courses[i];
                            var active = "";
                            if (data.item.courseID == d.id) {
                                active = "active";
                            }
                            $("#item-course").append(`<button class='select-course m-3 btn button8 ${active}' data-id='${d.id}'>${d.name}</button>`)
                        }
                    }

                    $("#item-note").val("");
                    if (data.item.note) {
                        $("#item-note").val(data.item.note);
                    }

                    $("#menuoptionmodal").modal("hide");
                    $("#coursenotemodal").modal("show");
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                }
            });
        });

        $("body").on("click", ".select-course", function () {
            $(".select-course").removeClass("active");
            $(this).addClass("active");
        })

        $("#coursenote-submit").click(function () {
            var itemId = parseInt($("#coursenotemodal").data("itemid"));
            var note = $("#item-note").val();
            var course = parseInt($(".select-course.active").data("id"));
            if (!course) course = 0;
            var data = {
                ItemID : itemId,
                Note: note,
                CourseID: course
            }

            $.ajax({
                url: "/POS/ChangeCourseNote",
                type: "POST",
                data: JSON.stringify(data),
                contentType: 'application/json;',
                dataType: 'json',
                success: function (data, textStatus, jqXHR) {
                    $("#coursenotemodal").modal("hide");
                    LoadOrderItems();
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                }
            });
        })

        $("#btn-void").click(function () {
            var itemId = $("#menuoptionmodal").data("itemid");
            var status = $("#menuoptionmodal").data("status");

            if (status == "0") {
                var data = {
                    ItemId: itemId,
                    ReasonId: 0
                };

                $.ajax({
                    url: "/POS/VoidOrderItem",
                    type: "POST",
                    data: JSON.stringify(data),
                    contentType: 'application/json;',
                    dataType: 'json',
                    success: function (data, textStatus, jqXHR) {
                        LoadOrderItems();
                        $("#menuoptionmodal").modal("hide");
                    },
                    error: function (jqXHR, textStatus, errorThrown) {
                        toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                    }
                });
            }
            else {

                $("#cancelitemmodal").data("itemid", itemId);
                $("#cancelitemmodal").data("status", status);
                $("#menuoptionmodal").modal("hide");
                CheckPermission("Permission.POS.VoidProduct", function () {

                    $("#cancelitemmodal").modal("show");
                })
            }
        });

        $("#void-submit").click(function () {
            var id = parseInt($("#cancelitemmodal").data("itemid"));
            var reasonId = parseInt($("#void-reason").data("id"))
            if (!reasonId) return;

            var pin = $("#input-pin").data("value");
            var data = {
                ItemId: id,
                ReasonId: reasonId,
                Pin: pin
            };

            $.ajax({
                url: "/POS/VoidOrderItem",
                type: "POST",
                data: JSON.stringify(data),
                contentType: 'application/json;',
                dataType: 'json',
                success: function (data, textStatus, jqXHR) {
                    LoadOrderItems();
                    $("#cancelitemmodal").modal("hide");
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                }
            });
        });

        $("#btn-reorder").click(function () {
            var itemId = $("#menuoptionmodal").data("itemid");

            if ('@Model.OrderMode' == "Seat") {
                $("#reorderseat-number").val("");
                $("#reordermodal").data("itemid", itemId);
                $("#reordermodal").modal("show");
                $("#menuoptionmodal").modal("hide");
            }
            else {
                var itemId = parseInt(itemId)
                var data = {
                    ItemId: itemId,
                    SeatNum: 0
                }
                $.ajax({
                    url: "/POS/ReorderItem",
                    type: "POST",
                    data: JSON.stringify(data),
                    contentType: 'application/json;',
                    dataType: 'json',
                    success: function (data, textStatus, jqXHR) {
                        LoadOrderItems();
                        $("#menuoptionmodal").modal("hide");
                    },
                    error: function (jqXHR, textStatus, errorThrown) {
                        toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                    }
                });
            }
        });

        $("#btn-qty").click(function () {
            var itemId = $("#menuoptionmodal").data("itemid");

            $("#qty-number").val("");
            $("#quantitymodal").data("itemid", itemId);
            $("#quantitymodal").modal("show");
            $("#menuoptionmodal").modal("hide");
        });

        $("#submit-qty").click(function () {
            var id = parseInt($("#quantitymodal").data("itemid"));
            var qty = parseInt($("#qty-number").val())
            var data = {
                ItemId: id,
                Qty: qty
            };

            $.ajax({
                url: "/POS/ChangeQtyItem",
                type: "POST",
                data: JSON.stringify(data),
                contentType: 'application/json;',
                dataType: 'json',
                success: function (data, textStatus, jqXHR) {
                    LoadOrderItems();
                    $("#quantitymodal").modal("hide");
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                }
            });
        });

        $("#btn-inventory").click(function () {
            var itemId = $("#menuoptionmodal").data("itemid");

            $.ajax({
                url: "/POS/GetInventory?itemId=" + itemId,
                type: "POST",
                success: function (data, textStatus, jqXHR) {
                    if (data.status == 0) {
                        $("#invqty-number").val(data.product.inventoryCount);
                        if (data.product.inventoryCountDownActive) {
                            $("#inventory-active").val(1).change();
                        }
                        else {
                            $("#inventory-active").val(2).change();
                        }

                        $("#inventorycountdownmodal").data("itemid", itemId);
                        $("#inventorycountdownmodal").modal("show");
                        $("#menuoptionmodal").modal("hide");
                    }
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                }
            });

        });

        $("#submit-invqty").click(function () {
            var itemId = parseInt($("#inventorycountdownmodal").data("itemid"));
            var prodid = parseInt($("#inventorycountdownmodal").data("prodid"));
            var qty = $("#invqty-number").val();
            var active = $("#inventory-active").val() == "1";
            if (!prodid) prodid = 0;
            if (!itemId) itemId = 0;
            var data = {
                ItemId: itemId,
                ProdId: prodid,
                Qty: qty,
                Active: active
            }
            $.ajax({
                url: "/POS/UpdateInventoryCountDown",
                type: "POST",
                data: JSON.stringify(data),
                contentType: 'application/json;',
                dataType: 'json',
                success: function (data, textStatus, jqXHR) {
                    var id = $("#subcategory-panel-main").data("selected");
                    LoadProduct(id);
                    $("#inventorycountdownmodal").modal("hide");
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                }
            });
        });

        $("#btn-discountitem").click(function () {
            $("#discountmodal").data("type", "OrderItem");
            var itemId = $("#menuoptionmodal").data("itemid");
            $("#discountmodal").data("id", itemId);
            $("#menuoptionmodal").modal("hide");
            CheckPermission("Permission.POS.Discounts", function () {
                $("#discountmodal").modal("show");
            });
        });

        $("#btn-order-discount").click(function () {
            $("#discountmodal").data("type", "Order");
            $("#discountmodal").data("id", @Model.ID);
            CheckPermission("Permission.POS.Discounts", function () {
                $("#discountmodal").modal("show");
            });
            $("#ordermenuoptionmodal").modal("hide");
        });

        $("#btn-modifier").click(function () {
            var itemId = $("#menuoptionmodal").data("itemid");
            $.ajax({
                url: "/POS/GetItemModifer?itemId=" + itemId,
                type: "POST",
                success: function (data, textStatus, jqXHR) {
                    if (data.status == 0) {

                        if (data.modifiers!=null) {
                            //Puros modificadores
                            $(".modifier-body").empty();
                            $(".textmen").empty();
                            for (var i = 0; i < data.modifiers.length; i++) {
                                var d = data.modifiers[i];
                                //var html = `<div class="card modifier-item-main">
                                //        <div class="card-header justify-content-between">
                                //            <h6>${d.name}</h6>
                                //            <div class="d-flex">
                                //                        Min: <span class="min-answer-modifier">${d.minAnswer}</span>,  Max: <span class="max-answer-modifier">${d.maxAnswer}</span>, Free Choice: <span class="freechoice">${d.freeChoice}</span>
                                //            </div>
                                //        </div>
                                //        <div class="question-item card-body row pt-0" data-id="${d.id}" data-name="${d.name}" data-min="${d.minAnswer}" data-max="${d.maxAnswer}">`;


                                var html= `<div class="card modifier-item-main" data-min="${d.minAnswer}" data-max="${d.maxAnswer}" style="border:none; margin:0px;">
                                        <div class="card-header justify-content-between" style="padding:0px" >

                                            <div class="d-flex " style="color:white; border:none">
                                                <h6 style=" color:orange">${d.name}: </h6>    &nbsp;&nbsp;
                                                Min: <span class="min-answer-modifier" style="color:white">${d.minAnswer}</span>,  Max: <span class="max-answer-modifier" style="color:white">${d.maxAnswer}</span>, Free Choice: <span class="freechoice" style="color:white">${d.freeChoice}</span>
                                            </div>
                                        </div>
                                        <div>
                                            <div class="question-item card-body row pt-1  justify-content-between gird-products" data-id="${d.id}" data-name="${d.name}" data-min="${d.minAnswer}" data-max="${d.maxAnswer}" style=" grid-template-columns: 19% 19% 19% 19% 19% !important; padding:0px;">`;

                                for (var j = 0; j <= d.answers.length; j++) {
                                    var a = d.answers[j];
                                    if (a){
                                        var active = "";
                                        if (a.isActive) {
                                            active = "active selected";
                                        }
                                        var divisorDefault = "";
                                        if (a.hasDivisor) {
                                            divisorDefault = "data-divisor='1'"
                                        }
                                        //html += `<div class="col-3 answer-item btn button4 ${active}" data-answerid="${a.id}" data-hasqty="${a.hasQty}" data-hasdivisor="${a.hasDivisor}" data-qty='1' ${divisorDefault}  data-smbid=""><span class="before-smb" style="color:lightgray"> </span>${a.product.name}<span class="after-smb" style="color:grey;"></span></div>`;
                                        html += `<div class='product-item-kiosk' style="width:auto !important;">
                                                          <div class="product-item-1 answer-item btn button4 ${active}" data-answerid="${a.id}" data-hasqty="${a.hasQty}" data-hasdivisor="${a.hasDivisor}" data-qty='${a.qty}' ${divisorDefault} data-smbid=""  style="background-color:black !important; color:#FFFFFF">
                                                          <h5 class="product-card-title-noimg" style='color:#FFFFFF'><span class="before-smb" style="color:lightgray"> </span> ${a.product.name} <span class="after-smb" style="color:grey;"></span></h5>
                                                     </div>
                                                </div>`;
                                    }

                                }
                                html += `</div>`

                                html += `<div class="smartbtn-items card-body row pt-1  justify-content-between gird-products" style="margin-top: 20px;  grid-template-columns: 19% 19% 19% 19% 19% !important; padding:0px;" > `;
                                for (var j = 0; j <= d.smartButtons.length; j++) {
                                    var a = d.smartButtons[j];

                                    if (a) {
                                        var after = "after";
                                        if (!a.isAfterText) after = "before";
                                        //html += `<div class="col-2 smartbtn-item btn button5" data-name="${a.button.name}" data-smartbtnid="${a.button.id}" data-after="${after}" > ${a.button.name} <p style="color: lightgray">${after}</p></div>`;
                                        html += `<div class='product-item-kiosk' style="width:auto !important;">
                                                          <div class="product-item-1 btn button5 smartbtn-item " data-name="${a.button.name}" data-smartbtnid="${a.button.id}" data-after="${after}" style="background-color:#637381; color:#FFFFFF; height: initial;" > 
                                                          <h5 class="product-card-title-noimg" style='color:#FFFFFF'>${a.button.name} <p style="color: lightgray">${after}</p></h5>
                                                     </div>
                                                </div>`;
                                    }
                                }
                                html += `</div>`
                                html += `</div>`

                                $(".modifier-body").append(html);
                            }
                            $("#modifiermodal").data("itemid", itemId);
                            CustomModalShow("#modifiercustommodal");
                            $("#menuoptionmodal").modal("hide");
                        }else{  
                        //Puras forzadas
                            $(".question-body").empty();
                            if (data.hasServingSize || data.hasQuestion) {
                                $("#QuestionTitleModal").html(data.productName);
                                if (data.hasServingSize) {
                                    var d = data.servingSizes
                                    var html = `
                                        <div class="card question-main serving-size-main" style="border:none">
                                            <div class="card-header justify-content-between">
                                                <div class="d-flex " style="color:white; border:none">
                                                <h5 style=" color:orange">Serving Sizes: </h5>    &nbsp;&nbsp;
                                            </div>
                                        </div>
                                        <div><div class="serving-size-container card-body row pt-1  justify-content-between gird-products" style="" data-prodid='${data.product}'>`;
                                    for (var j = 0; j < data.servingSizes.length; j++) {
                                        var a = data.servingSizes[j];
                                        var active = "";
                                        if (a.isActive) active = "active"
                                        html +=
                                            `<div class=" card product serving-size-item ${active}" data-id="${a.servingSizeID}" >
                                                <h5 class="saving-size-title">${a.servingSizeName}</h5>
                                            </div>  `
                                    }
                                    html += `</div> </div></div></div> `

                                    $(".question-body").append(html);
                                }
                               
                                    for (var i = 0; i < data.questions.length; i++) {
                                        var d = data.questions[i];

                                        var html = `
                                                  <div class="card question-main" data-min="${d.minAnswer}" data-max="${d.maxAnswer}" style="border:none; margin:0px;">
                                                        <div class="card-header justify-content-between" style="padding:0px" >

                                                            <div class="d-flex " style="color:white; border:none">
                                                            <h6 style=" color:orange">${d.name}: </h6>    &nbsp;&nbsp;
                                                                            Min: <span class="min-answer" style="color:white">${d.minAnswer}</span>,  Max: <span class="max-answer" style="color:white">${d.maxAnswer}</span>, Free Choice: <span class="freechoice" style="color:white">${d.freeChoice}</span>
                                                        </div>
                                                    </div>
                                                    <div>
                                                        <div class="question-item card-body row pt-1  justify-content-between gird-products" data-id="${d.id}" data-name="${d.name}" data-min="${d.minAnswer}" data-max="${d.maxAnswer}" style=" grid-template-columns: 19% 19% 19% 19% 19% !important; padding:0px;">`;
                                        for (var j = 0; j <= d.answers.length; j++) {
                                            var a = d.answers[j];
                                            if (a) {
                                                var active = "";
                                                if (a.isActive) {
                                                    active = "active";
                                                }
                                                var divisorDefault = "";
                                                if (a.hasDivisor) {
                                                    divisorDefault = "data-divisor='1'"
                                                }

                                                if (a.product.photo) {
                                                    html += `
                                            <div class='product-item-kiosk' style="width:auto !important;">
                                            <div class="product-item-1 answer-item ${active}" data-answerid="${a.id}" data-hasqty="${a.hasQty}" data-hasdivisor="${a.hasDivisor}" data-qty='${a.qty}' ${divisorDefault} style="background-color:${a.product.backColor}; color:${a.product.textColor}">
                                                <img class="card-img-1" src="${a.product.photo}" alt="">
                                            <h5 class="product-title-1"  style='color:#FFFFFF'><span class="before-smb" style="color:lightgray"> </span> ${a.product.name} <span class="after-smb" style="color:grey;"></span></h5>

                                        </div> </div> `
                                                }
                                                else {
                                                    html +=
                                                        `<div class='product-item-kiosk' style="width:auto !important;">
                                                          <div class="product-item-1 answer-item ${active}" data-answerid="${a.id}" data-hasqty="${a.hasQty}" data-hasdivisor="${a.hasDivisor}"  data-qty='${a.qty}' ${divisorDefault}  style="background-color:${a.product.backColor}; color:${a.product.textColor}">
                                                          <h5 class="product-card-title-noimg" style='color:#FFFFFF'><span class="before-smb" style="color:lightgray"> </span> ${a.product.name} <span class="after-smb" style="color:grey;"></span></h5>
                                                     </div>
                                                </div>`
                                                }
                                            }

                                        }

                                        html += `</div>`

                                        html += `<div class="smartbtn-items card-body row pt-1  justify-content-between gird-products" style="margin-top: 20px;  grid-template-columns: 19% 19% 19% 19% 19% !important; padding:0px;" > `;
                                        for (var j = 0; j <= d.smartButtons.length; j++) {
                                            var a = d.smartButtons[j];

                                            if (a) {
                                                var after = "after";
                                                if (!a.isAfterText) after = "before";
                                                //html += `<div class="col-2 smartbtn-item btn button5" data-name="${a.button.name}" data-smartbtnid="${a.button.id}" data-after="${after}" > ${a.button.name} <p style="color: lightgray">${after}</p></div>`;
                                                html += `<div class='product-item-kiosk' style="width:auto !important;">
                                                          <div class="product-item-1 btn button5 smartbtn-item " data-name="${a.button.name}" data-smartbtnid="${a.button.id}" data-after="${after}" style="background-color:#637381; color:#FFFFFF; height: initial;" > 
                                                          <h5 class="product-card-title-noimg" style='color:#FFFFFF'>${a.button.name} <p style="color: lightgray">${after}</p></h5>
                                                     </div>
                                                </div>`;
                                            }
                                        }
                                        

                                        html += `</div> </div></div></div> `

                                        $(".question-body").append(html);
                                    }
                                
                                CheckQuestionAvailablity();
                                $("#forcedquestionmodal").data("itemid", data.itemId);
                                CustomModalShow("#forcedquestioncustommodal");
                                $("#menuoptionmodal").modal("hide");
                            }
                        }
                    
                        
                    }
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                }
            });
        });

        $("#btn-moveseat").click(function () {
            var itemId = $("#menuoptionmodal").data("itemid");
            var seatNum = $("#menuoptionmodal").data("seatnum");
            var seats = GetAnotherSeats(seatNum);
            if (seats && seats.length > 0) {
                $("#another-seats-move").empty();
                for (var i = 0; i < seats.length; i++) {
                    var s = seats[i];
                    $("#another-seats-move").append(`<option value="${s.num}">Seat #${s.num} </option>`);
                }
            }
            else {
                return;
            }

            $("#moveseatmodal").data("id", itemId);
            $("#menuoptionmodal").modal("hide");
            $("#moveseatmodal").modal("show");
        });

        $("#moveseat-submit").click(function () {
            var itemId = parseInt($("#moveseatmodal").data("id"));
            var seat = parseInt($("#another-seats-move").val());
            var data = {
                ItemId: itemId,
                SeatNum: seat,
            }

            $.ajax({
                url: "/POS/MoveSeatItem",
                type: "POST",
                data: JSON.stringify(data),
                contentType: 'application/json;',
                dataType: 'json',
                success: function (data, textStatus, jqXHR) {
                    LoadOrderItems();
                    $("#moveseatmodal").modal("hide");
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                }
            });
        });

        $("#btn-seperate").click(function () {
            var itemId = $("#menuoptionmodal").data("itemid");

            $.ajax({
                url: "/POS/SeperateItem?itemId=" + itemId,
                type: "POST",
                success: function (data, textStatus, jqXHR) {
                    LoadOrderItems();
                    $("#menuoptionmodal").modal("hide");
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                }
            });

        });
        // seat menu

        $("#btn-seatpay").click(function () {
            CheckPermission("Permission.POS.Pay", function () {
                var seatnum = $("#seatmenumodal").data("seatnum");
                window.location.replace("/POS/Checkout?OrderId=@Model.ID&Seat=" + seatnum);
            })
        });

        $("#order-cancel").click(function () {
            $.ajax({
                url: "/POS/CancelOrder?orderId=@Model.ID",
                type: "POST",
                success: function (data, textStatus, jqXHR) {
                    window.location.replace("/POS/Station");
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                }
            });
        });

        $("#order-save").click(function () {
            ShowLoader();
            $.ajax({
                url: "/POS/SendOrder?orderId=@Model.ID",
                type: "POST",
                success: function (data, textStatus, jqXHR) {
                    window.location.replace("/POS/Station");
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                }
            });
        });

        $("#order-express").click(function () {
            ShowLoader();
            $.ajax({
                url: "/POS/SendOrder?orderId=@Model.ID",
                type: "POST",
                success: function (data, textStatus, jqXHR) {
                    HideLoader();
                    LoadOrderItems();
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                }
            });
        });
        $("#order-pay").click(function () {
            CheckPermission("Permission.POS.Pay", function () {
                ShowLoader();
                var dividerNum = $("#divide-num").val();
                window.location.replace("/POS/Checkout?OrderId=@Model.ID&DividerId=" + dividerNum);
            })
        });

        $("#question-submit").click(function () {
            $(this).prop("disabled", true);
            var questions = [];
            var valid = true;
            $(".textmen").html("");
            $(".question-body").find(".question-item").each(function () {
                var minAnswer = parseInt($(this).data("min"));
                var id = parseInt($(this).data("id"));
                if (id) {
                    var name = $(this).data("name");
                    var answers = [];
                    var smbs = [];
                    $(this).find(".answer-item.active").each(function () {
                        var id = parseInt($(this).data("answerid"));
                        var order = parseInt($(this).data("order"));
                        var qty = parseInt($(this).data("qty"));
                        if (!qty) qty = 0;
                        var divisor = parseInt($(this).data("divisor"));
                        if (!divisor) divisor = 0;
                        var servingsizeid = parseInt($(this).data("servingsizeid"));
                        if (!servingsizeid) servingsizeid = 0;
                        var subanswers = $(this).data("subanswers");

                        var answer = {
                            Order: 0,
                            AnswerId: id,
                            ServingSizeID: servingsizeid,
                            Divisor: divisor,
                            Qty: qty,
                            SubAnswers: subanswers
                        }

                        answers.push(answer);

                        var smb = parseInt($(this).data("smbid"));
                        if (!smb) smb = 0;

                        smbs.push(smb);
                    });

                    question = {
                        QuestionId: id,
                        Answers: answers,
                        SmartButtons: smbs
                    }
                    questions.push(question);
                }

            });

            var sid = parseInt($(".serving-size-item.active").data("id"));
            if (!sid) {
                sid = 0;
            }
            if (valid) {
                var itemId = $("#forcedquestionmodal").data("itemid");
                $.ajax({
                    url: "/POS/AddQuestionToItem?ItemId=" + itemId + "&servingSizeID=" + sid,
                    type: "POST",
                    data: JSON.stringify(questions),
                    contentType: 'application/json;',
                    dataType: 'json',
                    success: function (data, textStatus, jqXHR) {
                        LoadOrderItems();
                        CustomModalHide("#forcedquestioncustommodal");
                        $("#question-submit").prop("disabled", false);
                    },
                    error: function (jqXHR, textStatus, errorThrown) {
                        toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                        $("#question-submit").prop("disabled", false);
                    }
                });
            }else{
                $("#question-submit").prop("disabled", false);
            }

            
        });

        
        $("#modifier-submit").click(function () {
            var controlSubmit = this;
            $(controlSubmit).prop("disabled", true);
            var questions = [];
            var valid = true;
            $(".modifier-body").find(".question-item").each(function () {
                var minAnswer = parseInt($(this).data("min"));
                var id = parseInt($(this).data("id"));
                if (id) {
                    var name = $(this).data("name");
                    var answers = [];
                    var smbs = [];
                    $(this).find(".answer-item.active").each(function () {
                        var id = parseInt($(this).data("answerid"));
                        var order = parseInt($(this).data("order"));
                        var qty = parseInt($(this).data("qty"));
                        if (!qty) qty = 0;
                        var divisor = parseInt($(this).data("divisor"));
                        if (!divisor) divisor = 0;

                        var subanswers = $(this).data("subanswers");

                        var answer = {
                            Order: 0,
                            AnswerId: id,
                            ServingSizeID: 0,
                            Divisor: divisor,
                            Qty: qty,
                            SubAnswers: subanswers
                        }

                        answers.push(answer);

                        var smb = parseInt($(this).data("smbid"));
                        if (!smb) smb = 0;

                        smbs.push(smb);
                    });

                    question = {
                        QuestionId: id,
                        Answers: answers,
                        SmartButtons: smbs
                    }
                    questions.push(question);
                }

            });

            if (valid) {
                var itemId = $("#modifiermodal").data("itemid");
                $.ajax({
                    url: "/POS/AddModifierToItem?ItemId=" + itemId,
                    type: "POST",
                    data: JSON.stringify(questions),
                    contentType: 'application/json;',
                    dataType: 'json',
                    success: function (data, textStatus, jqXHR) {
                        LoadOrderItems();
                        CustomModalHide("#modifiercustommodal");
                        $(controlSubmit).prop("disabled", false);
                    },
                    error: function (jqXHR, textStatus, errorThrown) {
                        toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                        $(controlSubmit).prop("disabled", false);
                    }
                });
            }
        });

        $("#modifier-cancel").click(function () {
            $(".popover").remove();
            showPopover = false;
            CustomModalHide("#modifiercustommodal");
        });

        $("body").on("click", ".group-item", function () {
            $(".group-item").removeClass("active");
            $(this).addClass("active");

            var id = $(this).data("id");
            LoadCategory(id);
        });

        $("body").on("click", ".category-item", function () {
            $(".category-item").removeClass("active");
            $(this).addClass("active");

            var id = $(this).data("id");
            LoadSubCategory(id);
        });

        $("body").on("click", ".order-item", function () {
            $(".order-item").removeClass("active");
            $(".order-group").removeClass("active");
            $(this).addClass("active");


            var id = $(this).data("id");
            var status = $(this).data("status");
            var promotion = $(this).data("promotion");
            var seatnum = $(this).closest(".group-content").data("seatnum");

            $("#menuoptionmodal").data("itemid", id);
            $("#menuoptionmodal").data("status", status);
            $("#menuoptionmodal").data("seatnum", seatnum);
            if (status == "0") {
                $("#btn-reorder").parent().hide();
                $("#btn-qty").parent().show();
                $("#btn-hold").parent().show();
                $("#btn-modifier").parent().show();
            }
            else {
                $("#btn-reorder").parent().show();
                $("#btn-qty").parent().hide();
                $("#btn-hold").parent().hide();
                $("#btn-modifier").parent().hide();
            }
            if (status == "2" || status == "3") {
                $("#btn-fire").parent().show();
            }
            else {
                $("#btn-fire").parent().hide();
            }

            if (promotion) {
                $("#btn-seperate").parent().hide();
                $("#btn-discountitem").parent().hide();
            }
            else {
                $("#btn-seperate").parent().show();
                $("#btn-discountitem").parent().show();
            }
            $("#menuoptionmodal").modal("show");
        });

        $("body").on("click", ".seat-add", function () {
            $.ajax({
                url: "/POS/AddNewSeat?orderId=@Model.ID",
                type: "POST",
                contentType: 'application/json;',
                dataType: 'json',
                success: function (data, textStatus, jqXHR) {
                    LoadOrderItems();
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                }
            });
        });

        $("body").on("click", ".edit-orderitem", function () {
            $(".order-item").removeClass("active");
            $(".order-group").removeClass("active");
            $(this).addClass("active");

            var id = $(this).closest(".order-item").data("id");
            var status = $(this).closest(".order-item").data("status");
            var seatnum = $(this).closest(".group-content").data("seatnum");
            $("#menuoptionmodal").data("itemid", id);
            $("#menuoptionmodal").data("status", status);
            $("#menuoptionmodal").data("seatnum", seatnum);
            if (status == "0") {
                $("#btn-reorder").parent().hide();
                $("#btn-qty").parent().show();
            }
            else {
                $("#btn-reorder").parent().show();
                $("#btn-qty").parent().hide();
            }
            if (status == "2" || status == "3") {
                $("#btn-fire").parent().show();
            }
            else {
                $("#btn-fire").parent().hide();
            }

            $("#menuoptionmodal").modal("show");
        });

        $("body").on("click", ".edit-seatitem", function () {
            var seatNum = $(this).data("seatnum");
            CurrentSeat = seatNum;
            $(".order-item").removeClass("active");
            var group = $(this).closest(".order-group");
            if (group.hasClass("active")) {
                var id = $(this).data("seatid");
                var num = $(this).data("seatnum");
                var name = $(this).data("seatname");

                $("#seatmenumodal").data("seatid", id);
                $("#seatmenumodal").data("seatnum", num);
                $("#seatmenumodal").data("seatname", name);
                $("#seatmenumodal").modal("show");
            }
            else {
                $(".order-group").removeClass("active");
                $(this).closest(".order-group").addClass("active");
            }
        });

        $(".reorder-keyboard").click(function () {
            var txt = $(this).text();
            var current = $("#reorderseat-number").val();

            if (txt == 'C') {
                current = "";
            }
            else if (txt == '←') {
                current = current.substring(0, current.length - 1);
            }
            else {
                current += txt;
            }

            var val = parseInt(current);
            if (!val || val == 0) {
                $("#reorderseat-number").val("");
            }
            else {
                $("#reorderseat-number").val(val);
            }
        });

        $("#reorder-submit").click(function () {
            var seatNum = parseInt($("#reorderseat-number").val())
            if (!seatNum) return;

            var itemId = parseInt($("#reordermodal").data("itemid"))
            var data = {
                ItemId: itemId,
                SeatNum: seatNum
            }
            $.ajax({
                url: "/POS/ReorderItem",
                type: "POST",
                data: JSON.stringify(data),
                contentType: 'application/json;',
                dataType: 'json',
                success: function (data, textStatus, jqXHR) {
                    LoadOrderItems();
                    $("#reordermodal").modal("hide");
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                }
            });
        });

        $(".qty-keyboard").click(function () {
            var txt = $(this).text();
            var current = $("#qty-number").val();

            if (txt == 'C') {
                current = "";
            }
            else if (txt == '←') {
                current = current.substring(0, current.length - 1);
            }
            else {
                current += txt;
            }

            var val = parseInt(current);
            if (!val || val == 0) {
                $("#qty-number").val("");
            }
            else {
                $("#qty-number").val(val);
            }
        });

        $(".invqty-keyboard").click(function () {
            var txt = $(this).text();
            var current = $("#invqty-number").val();

            if (txt == 'C') {
                current = "";
            }
            else if (txt == '←') {
                current = current.substring(0, current.length - 1);
            }
            else {
                current += txt;
            }

            var val = parseInt(current);
            if (!val || val == 0) {
                $("#invqty-number").val("");
            }
            else {
                $("#invqty-number").val(val);
            }
        });

        $(".divideqty-keyboard").click(function () {
            var txt = $(this).text();
            var current = $("#divideqty-number").val();

            if (txt == 'C') {
                current = "";
            }
            else if (txt == '←') {
                current = current.substring(0, current.length - 1);
            }
            else {
                current += txt;
            }

            var val = parseInt(current);
            if (!val || val == 0) {
                $("#divideqty-number").val("");
            }
            else {
                $("#divideqty-number").val(val);
            }
        });

        $(".seat-keyboard").click(function () {
            var txt = $(this).text();
            var current = $("#seat-number").val();

            if (txt == 'C') {
                current = "";
            }
            else if (txt == '←') {
                current = current.substring(0, current.length - 1);
            }
            else {
                current += txt;
            }

            var val = parseInt(current);
            if (!val || val == 0) {
                $("#seat-number").val("");
            }
            else {
                $("#seat-number").val(val);
            }
        });

        $("body").on("click", ".subcategory-item", function () {
            $(".subcategory-item").removeClass("active");
            $(this).addClass("active");

            var id = $(this).data("id");
            LoadProduct(id);
        });

        $("#submit-seatnum").click(function () {
            var seatnum = parseInt($("#seat-number").val());
            if (!seatnum) {
                return;
            }

            var mid = parseInt($("#seatcountmodal").data("mid"));
            var productid = parseInt($("#seatcountmodal").data("product"));
            AddOrderItem(productid, mid, 1, seatnum);
            $("#seatcountmodal").modal("hide");
        });

        $("body").on("click", ".product-item", function () {
            var id = parseInt($(this).data("id"));
            var productid = parseInt($(this).data("productid"));

            if ('@Model.OrderMode' == "Seat") {
                var activeGroup = $(".order-group.active");
                if (!activeGroup) return;

                var seatNum = activeGroup.find(".edit-seatitem").data("seatnum");
                CurrentSeat = seatNum;
                AddOrderItem(productid, id, 1, seatNum);

            }
            else {
                AddOrderItem(productid, id, 1, 0)
            }
        });

        $("body").on("click", ".serving-size-item", function () {

            $(".serving-size-item").removeClass("active");
            $(this).addClass("active");

            var servingSizeID = $(this).data("id");
            var prodid = $(this).closest(".serving-size-container").data("prodid");

            $.ajax({
                url: "/POS/CheckAnswerSizesByServingSize?productID=" + prodid + "&servingSizeID=" + servingSizeID,
                type: "POST",
                success: function (data, textStatus, jqXHR) {
                    if (data) {
                        $(".answer-item").each(function() {
                            var answerid = $(this).data("answerid")
                            var d = data.find(obj => {
                                return obj.answerID == answerid
                            })

                            if (d) {
                                if (d.matchSize && !d.hasSize) {
                                    $(this).removeClass("active");
                                    $(this).hide();
                                    $(".textmen").find("[data-answerid='" + answerid + "']").remove();
                                }
                                else{
                                    $(this).show();
                                }
                            }
                            else{
                                $(this).show();
                            }
                        })
                    }
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                }
            });

            CheckQuestionAvailablity();
        });

        $("body").on("click", ".sub-serving-size-item", function () {

            $(".sub-serving-size-item").removeClass("active");
            $(this).addClass("active");
        });

        $("body").on("click", ".sub-answer-item", function () {
            var question = $(this).closest(".sub-question-main");

            var max = parseInt(question.find(".question-max").text());
            if($(this).hasClass("active")) {
                $(this).toggleClass("active");
                var answerId = $(this).data("answerid");
                $(".textmen").find("[data-answerid='" + answerId + "']").remove();
            }
            else{
                var answers = question.find(".sub-answer-item.active");
                if (answers.length < max) {
                    $(this).toggleClass("active");
                }
            }
        })
        
        function SmartButtonChecker(crtActual){
            var lstSmarts = $(crtActual).closest(".card").find(".smartbtn-item.active");

            $.each(lstSmarts, function( index, value ) {
                
                var smb = $(value).data("smartbtnid");
                var after = $(value).data("after");
                var name = $(value).data("name");
                if ($(this).hasClass("active")) {
                    //$(this).removeClass("active");
                    //var main = $(this).closest(".modifier-item-main");
                    var sel = $(crtActual); // main.find(".answer-item.active.selected");
                    if (smb && sel) {
                        sel.data("smbid", smb);
                        if (after == "after") {
                            sel.find(".after-smb").text(" " + name);
                        }
                        else {
                            sel.find(".before-smb").text(name + " ");
                        }
                    }
                }
                else {
                    //$(".smartbtn-item").removeClass("active");
                    //$(this).addClass("active");
                    /*var main = $(this).closest(".modifier-item-main");
                    var sel = main.find(".answer-item.active.selected");
                    if (smb && sel) {
                        sel.data("smbid", smb);
                        if (after == "after") {
                            sel.find(".after-smb").text(" " + name);
                        }
                        else {
                            sel.find(".before-smb").text(name + " ");
                        }
                    }*/
                }
            });
            
            if(lstSmarts && lstSmarts.length>0){
                return(true);
            }else{
                return(false);
            }
            
        }

        $("body").on("click", ".answer-item", function () {
            if (showPopover) return;

            if(SmartButtonChecker(this)) return;
            
            var question = $(this).closest(".question-item");
            var max = parseInt(question.data("max"));
            var hasQty = $(this).data("hasqty");
            var hasDivisor = $(this).data("hasdivisor");
            var answers = question.find(".answer-item.active");
            var answerid = $(this).data("answerid");

            if ($(this).hasClass("active")) {

                $(this).find(".before-smb").text("");
                $(this).find(".after-smb").text("");
                
                if (hasQty || hasDivisor) {
                    var html = `<span class='hidden answer-id'>${answerid}</span>`;
                    if (hasDivisor) {
                        html += `<div class='d-flex gap-5 m-5'>
                                    <div class='pie-1 answer-divisor active' data-divisor='1'><span class='sub-divisor hidden' >1</span></div><span class='lbl-divisor'>Completa</span>
                                    <div class='pie-2 answer-divisor'  data-divisor='2'><span class='sub-divisor hidden' >2</span></div><span class='lbl-divisor'>1 Mitad</span>
                                        <div class='pie-3 answer-divisor'  data-divisor='3'><span class='sub-divisor hidden' >3</span></div><span class='lbl-divisor'>2 Mitad</span>
                                </div>`;
                    }
                    if (hasQty) {
                        html += `<div class='d-flex gap-4 py-3 px-5 mx-5'>
                                    <a class='btn button9 answer-qty ' data-qty='1'>1</a>
                                    <a class='btn button9 answer-qty ' data-qty='2'>2</a>
                                    <a class='btn button9 answer-qty ' data-qty='3'>3</a>
                                    <a class='btn button9 answer-qty ' data-qty='4'>4</a>
                                </div>`
                    }

                    $(".popover").remove();
                    $(this).popover({
                        placement: 'top',
                        html: true,
                        trigger:'manual',
                        container: "body",
                        title: function () {
                            return `<div class='d-flex justify-content-between' data-answerid='3'><h3 class='pt-3 px-5'>Rojo & Qty</h3><div><a class='btn btn-danger answer-qty-remover p-3 px-5' >Remover</a><a class='btn btn-success answer-qty-ok p-3 px-5 ocultar' >OK</a></div></div>`
                        },
                        content: function () {
                            return html;
                        }
                    });
                    $(this).popover("show");
                    showPopover = true;
                    $("#question-submit").prop("disabled", true);
                }
                else {
                    $(this).toggleClass("active");
                    var answerId = $(this).data("answerid");
                    $(".textmen").find("[data-answerid='" + answerId + "']").remove();
                    $(".popover").remove();
                    showPopover = false;
                }
            }
            else {

                if (answers.length < max) {
                    $(this).toggleClass("active");
                    $(this).data("order", answers.length + 1);
                    var buttonName = $(this).text();
                    var questionName = question.data("name");

                    

                    var textToAppend = `<span style="color: orange;">${questionName}</span><br> ${buttonName}`;
                    $(".textmen").append(`<div data-answerid='${$(this).data("answerid")}'>${textToAppend}</div>`);




                    if (hasQty || hasDivisor) {
                        var html = `<span class='hidden answer-id'>${answerid}</span>`;
                        if (hasDivisor) {
                            html += `<div class='d-flex gap-5 m-5'>
                                    <div class='pie-1 answer-divisor active' data-divisor='1'><span class='sub-divisor hidden' >1</span></div><span class='lbl-divisor'>Completa</span>
                                    <div class='pie-2 answer-divisor'  data-divisor='2'><span class='sub-divisor hidden' >2</span></div><span class='lbl-divisor'>1 Mitad</span>
                                        <div class='pie-3 answer-divisor'  data-divisor='3'><span class='sub-divisor hidden' >3</span></div><span class='lbl-divisor'>2 Mitad</span>
                                </div>`;
                        }
                        if (hasQty) {
                            html += `<div class='d-flex gap-4 py-3 px-5 mx-5'>
                                    <a class='btn button9 answer-qty ' data-qty='1'>1</a>
                                    <a class='btn button9 answer-qty ' data-qty='2'>2</a>
                                    <a class='btn button9 answer-qty ' data-qty='3'>3</a>
                                    <a class='btn button9 answer-qty ' data-qty='4'>4</a>
                                </div>`
                        }

                        $(".popover").remove();
                        $(this).popover({
                            placement: 'top',
                            html: true,
                            trigger:'manual',
                            container: "body",
                            title: function () {
                                return `<div class='d-flex justify-content-between' data-answerid='3'><h3 class='pt-3 px-5'>Rojo & Qty</h3><div><a class='btn btn-danger answer-qty-remover p-3 px-5' >Remover</a><a class='btn btn-success answer-qty-ok p-3 px-5 ocultar' >OK</a></div></div>`
                            },
                            content: function () {
                                return html;
                            }
                        });
                        $(this).popover("show");
                        showPopover = true;
                        $("#question-submit").prop("disabled", true);
                    }
                    else {
                        var element = $(this);

                        LoadAnswerQuestion(element);
                    }

                }
            }

            CheckQuestionAvailablity();
        });

        $("body").on("click", ".answer-divisor", function () {
            $(".answer-divisor").removeClass("active");
            $(this).addClass("active");
            var container = $(this).closest(".popover");
            if($(container).find(".answer-qty").length<=0){
                var ctrOK = container.find(".answer-qty-ok")[0];
                $(ctrOK).click();
            }
            

        })
        $("body").on("click", ".answer-qty", function () {
            $(".answer-qty").removeClass("active");
            $(this).addClass("active");
        })

        function LoadAnswerQuestion(element)
        {
            var sid = parseInt($(".serving-size-item.active").data("id"));
            if (!sid) {
                sid = 0;
            }
            var answerid = element.data("answerid");
            $.ajax({
                url: "/POS/GetAnswerDetail?answerID=" + answerid + "&servingSizeID=" + sid,
                type: "POST",
                contentType: 'application/json;',
                dataType: 'json',
                success: function (data, textStatus, jqXHR) {
                    if (data.status == 0) {
                        var html = `<div>`;

                        if (data.subquestion) {
                            var d = data.subquestion;
                            html += `
                                                      <div class="card sub-question-main" data-min="${d.minAnswer}" data-max="${d.maxAnswer}" style="border:none">
                                                            <span class='hidden question-min'>${d.minAnswer}</span>
                                                            <span class='hidden question-max'>${d.maxAnswer}</span>
                                                            <span class='hidden answer-id'>${answerid}</span>
                                                            <div class="card-header justify-content-between" >
                                                                <div class="d-flex " style="color:white; border:none">
                                                                <h6 style=" color:orange">${d.name}: </h6>    &nbsp;&nbsp;
                                                                                Min: <span class="min-answer" style="color:white">${d.minAnswer}</span>,  Max: <span class="max-answer" style="color:white">${d.maxAnswer}</span>, Free Choice: <span class="freechoice" style="color:white">${d.freeChoice}</span>
                                                            </div>
                                                        </div>
                                                        <div>
                                                            <div class="sub-question-item card-body row pt-1  justify-content-between gird-products" data-id="${d.id}" data-questionname="${d.name}" data-min="${d.minAnswer}" data-max="${d.maxAnswer}" style="">`;
                            for (var j = 0; j <= d.answers.length; j++) {
                                var a = d.answers[j];
                                if (a) {
                                    var active = "";
                                    if (a.isPreSelected) {
                                        active = "active";
                                    }
                                    if (a.product.photo) {
                                        html += `
                                                    <div class="card product sub-answer-item ${active}" data-answerid="${a.id}" data-hasqty="${a.hasQty}" data-hasdivisor="${a.hasDivisor}" style="background-color:${a.product.backColor}; color:${a.product.textColor}">
                                                    <img class="card-img" src="${a.product.photo}" alt="">
                                                <div class="card-img-overlay">
                                                            <div class="product-title">${a.product.name}</div>    <span class='hidden sub-answer-id'>${a.id}</span>
                                                </div>
                                            </div> `
                                    }
                                    else {
                                        html +=
                                            `
                                            <div class=" card product sub-answer-item ${active}" data-answerid="${a.id}" data-hasqty="${a.hasQty}" data-hasdivisor="${a.hasDivisor}" style="background-color:${a.product.backColor}; color:${a.product.textColor}">
                                            <h5 class="product-title">${a.product.name}</h5>
                                                <span class='hidden sub-answer-id'>${a.id}</span>
                                        </div>  `
                                    }
                                }

                            }
                            html += `</div> </div></div></div> `
                        }
                        html += `</div>`;


                        element.popover({
                            placement: 'top',
                            html: true,
                            trigger: 'manual',
                            container: "body",
                            title: function () {
                                return `<div class='d-flex justify-content-between' data-answerid='3'><span></span><div><a class='btn btn-danger mx-2 answer-sub-cancel  p-3 px-5'>Cancel</a><a class='btn btn-success answer-sub-ok  p-3 px-5'>OK</a></div></div>`
                            },
                            content: function () {
                                return html;
                            }
                        });
                        element.popover("show");
                        showPopover = true;
                    }
                    else if (data.status == 2){
                        toastr.error("@ViewLocalizer["There is not match serving size."]", {})
                        element.removeClass("active");
                        $(".textmen").find("[data-answerid='" + answerid + "']").remove();
                    }
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                }
            });
        }

        $("body").on("click", ".answer-sub-ok", function () {
            if (showPopover) return;
            var container = $(this).closest(".popover");
            var answerid = container.find(".answer-id").text();
            var servingsizeid = container.find(".sub-serving-size-item.active").find(".serving-size-id").text();
            var servingsizename = container.find(".sub-serving-size-item.active").find(".sub-saving-size-title").text();
            var max = parseInt(container.find(".question-max").text());
            var min = parseInt(container.find(".question-min").text());

            var subanswerids = [];
            var subanswers = ""
            container.find(".sub-answer-item.active").each(function () {
                var prod = $(this).find(".product-title").text();
                var id = parseInt($(this).find(".sub-answer-id").text());
                subanswerids.push(id);
                subanswers += `<br /><span class='ml-3'>${prod}</span>`
            })

            var element = $(".answer-item[data-answerid='" + answerid + "']");
            element.data("servingsizeid", servingsizeid);
            element.data("servingsizename", servingsizename);
            element.data("subanswers", subanswerids.toString());

            var qty = element.data("qty");
            var qtystr = "";
            if (qty){
                qtystr = " " + qty;
            }

            var divisor = element.data("divisor");
            var divisortxt = "";
            if (divisor == "1") divisortxt = "Completa";
            if (divisor == "2") divisortxt = "1 Mitad";
            if (divisor == "3") divisortxt = "2 Mitad";

            $(".textmen").find("[data-answerid='" + answerid + "']").remove();
            var question = element.closest(".question-item");
            var questionName = question.data("name");
            var buttonName = element.text();
            var textToAppend = `<span style="color: orange;">${questionName}</span><br>${divisortxt}  ${buttonName} X ${qtystr} ${subanswers}`;
            $(".textmen").append(`<div data-answerid='${answerid}'>${textToAppend}</div>`);

            element.popover("dispose");
            CheckQuestionAvailablity();
            showPopover = false;
        });

        $("body").on("click", ".answer-sub-cancel", function () {
            $(".popover").remove();
            showPopover = false;
            CheckQuestionAvailablity();
        });

        

        $("body").on("click", ".answer-qty-remover", function () {
            var container = $(this).closest(".popover");
            var answerid = container.find(".answer-id").text();
            var element = $(".answer-item[data-answerid='" + answerid + "']");
            
            $(element).removeClass("active");
            $(element).removeClass("selected");
            $(".textmen").find("[data-answerid='" + answerid + "']").remove();
            $(".popover").remove();
            $(element).find(".before-smb").text("");
            $(element).find(".after-smb").text("");
            showPopover = false;
            
        });
        
        $("body").on("click", ".answer-qty", function () {
            var container = $(this).closest(".popover");
            var ctrOK = container.find(".answer-qty-ok")[0];
            $(ctrOK).click();
        });

        $("body").on("click", ".answer-qty-ok", function () {
            var container = $(this).closest(".popover");
            var divisor = container.find(".answer-divisor.active").find(".sub-divisor").text();
            var qty = container.find(".answer-qty.active").text();
            var answerid = container.find(".answer-id").text();

            var element = $(".answer-item[data-answerid='" + answerid + "']");
            element.data("divisor", divisor);
            element.data("qty", qty);

            $(".textmen").find("[data-answerid='" + answerid + "']").remove();
            $(".popover").remove();
            showPopover = false;
            var divisortxt = "";

            if (divisor) {
                divisortxt = "Completa";
                if (divisor == "2") divisortxt = "1 Mitad";
                if (divisor == "3") divisortxt = "2 Mitad";
            }

            var question = element.closest(".question-item");
            var questionName = question.data("name");
            var buttonName = element.text();
            var textToAppend = `<span style="color: orange;">${questionName}</span><br>${divisortxt} ${buttonName} x ${qty}`;
            $(".textmen").append(`<div data-answerid='${answerid}'>${textToAppend}</div>`);

            element.popover("dispose");
            LoadAnswerQuestion(element);
            CheckQuestionAvailablity();
        })


        $("body").on("click", ".modifier-item-main .answer-item", function () {
            //$(this).toggleClass("active");
            //$(".modifier-item-main").find(".answer-item").removeClass("selected");

            //$(this).addClass("selected");
            
            if(SmartButtonChecker(this)) return;

            if (!$(this).hasClass("active")) {
                $(this).find(".before-smb").text("");
                $(this).find(".after-smb").text("");
                $(this).data("smbid", "");
                $(this).removeClass("active");
                $(this).removeClass("selected");
                $(".smartbtn-item").removeClass("active");
                $(".smartbtn-item").removeClass("selected");
            }else{
                $(this).addClass("selected");
                $(this).addClass("active");
            }
        });

        $("body").on("click", ".smartbtn-item", function () {
            var smb = $(this).data("smartbtnid");
            var after = $(this).data("after");
            var name = $(this).data("name");
            if ($(this).hasClass("active")) {
                $(this).removeClass("active");
                /*var main = $(this).closest(".modifier-item-main");
                var sel = main.find(".answer-item.active.selected");
                if (smb && sel) {
                    sel.data("smbid", "");
                    sel.find(".after-smb").text(" ");
                    if (after == "after") {
                        sel.find(".after-smb").text("");
                    }
                    else {
                        sel.find(".before-smb").text("");
                    }
                }*/
            }
            else {
                $(".smartbtn-item").removeClass("active");
                $(this).addClass("active");
                /*var main = $(this).closest(".modifier-item-main");
                var sel = main.find(".answer-item.active.selected");
                if (smb && sel) {
                    sel.data("smbid", smb);
                    if (after == "after") {
                        sel.find(".after-smb").text(" " + name);
                    }
                    else {
                        sel.find(".before-smb").text(name + " ");
                    }
                }*/
            }

        });
    });

    function ShowSplitDialog() {
        $.ajax({
            url: "/POS/GetOrderItemsAtDivide?orderId=@Model.ID",
            type: "POST",
            success: function (data, textStatus, jqXHR) {
                if (data) {
                    $(".divide-main-panel").empty();
                    var rollprice = 0;
                    for (var i = 0; i < data.length; i++) {
                        var d = data[i];

                        var html = `<div class="divide-account card m-2" data-divideid=${d.divideId}>
                                                        <div class="divide-account-header p-1">Cuanta  #${d.divideId}</div>
                                                        <div class="divide-body">`;

                        for (var j = 0; j < d.items.length; j++) {
                            var item = d.items[j];
                            var seat = "";
                            if (item.seatNum > 0) seat = item.seatNum;

                            html += `<div class="divide-item" data-itemid="${item.id}" data-promotion="${item.hasPromotion}" data-name="${item.name}" data-seat="${item.seatNum}" data-qty="${item.qty}">
                                                        <div class="row">
                                                           <span class="col-2">#${seat}</span>
                                                           <span class="col-7">${item.name}</span>
                                                           <span class="col-3 divide-item-qty">${item.qty.toFixed(2)}</span>
                                                                    </div><div class="item-modifiers">`
                            // questions
                            if (item.questions && item.questions.length > 0) {
                                html += `<div class=" w-100">`;
                                var divisor = 0;
                                for (var k = 0; k < item.questions.length; k++) {
                                    var q = item.questions[k];
                                    var divisor_html = '';
                                    if (q.divisor != divisor) {
                                        if (q.divisor == 1) {
                                            divisor_html = `<div class="item justify-content-around d-flex"><span class="">Completa : </span><span class=""></span></div>`;
                                        }
                                        else if (q.divisor == 2) {
                                            divisor_html = `<div class="item justify-content-around d-flex"><span class="">1 Mitad :</span><span class=""></span></div>`;
                                        }
                                        else if (q.divisor == 3) {
                                            divisor_html = `<div class="item justify-content-around d-flex"><span class="">2 Mitad : </span><span class=""></span></div>`;
                                        }

                                        divisor = q.divisor;
                                    }
                                    var showDesc = false;
                                    if (q.isPreSelect) {
                                        if (!q.isActive) {
                                            html += divisor_html;
                                            html += `<div class="item mx-2 justify-content-around d-flex"><span class="">${q.description}</span><span class=""></span></div>`;
                                            showDesc = true;
                                        }
                                        // else if (q.divisor != 0 || q.qty > 1 || q.subDescription) {
                                        //     html += divisor_html;
                                        //     html += `<div class="item mx-2 justify-content-around d-flex"><span class="">${q.description}</span><span class=""></span></div>`;
                                        //     showDesc = true;
                                        // }
                                    }
                                    else {
                                        if (q.canRoll) {
                                            rollprice += q.price;
                                            html += divisor_html;
                                            html += `<div class="item mx-2 justify-content-around d-flex"><span class="">${q.description}</span><span class=""></span></div>`;
                                            showDesc = true;
                                        }
                                        else {
                                            var price = q.price * (q.qty - q.freeChoice);
                                            html += divisor_html;
                                            html += `<div class="item mx-2 justify-content-around d-flex"><span class="">${q.description}</span><span class=""></span></div>`;
                                            showDesc = true;
                                        }
                                    }
                                    if (showDesc && q.subDescription) {
                                        html += `<div class="item mx-2 justify-content-around d-flex"><span class="mx-3"> ${q.subDescription}</span><span class=""></span></div>`;
                                    }
                                }
                                html += `</div>`;
                            }
                            // discounts
                            if (item.discounts && item.discounts.length > 0) {
                                html += `<div class="justify-content-around d-flex w-100">`;
                                for (var k = 0; k < item.discounts.length; k++) {
                                    var q = item.discounts[k];
                                    html += `<span class="">${q.name}</span><span class=""></span>`;
                                }
                                html += `</div>`;
                            }

                            html += `</div></div>`;

                        }

                        if (i == 0) {
                            html += `</div><div class="divide-account-footer p-1">
                                                        <button type="button" class="btn divide-print">@ViewLocalizer["Print"]</button>
                                                    </div></div>`
                        }
                        else {
                            html += `</div><div class="divide-account-footer p-1">
                                                        <button type="button" class="btn divide-remove">@ViewLocalizer["Delete"]</button>
                                                    <button type="button" class="btn divide-print">@ViewLocalizer["Print"]</button>
                                                </div></div>`
                        }
                        $(".divide-main-panel").append(html);
                    }
                    var htmladd = `<div class="divide-account-add card m-2" >
                                                        <div class="divide-body" style = "height:50vh;" >
                                                            <div class="divide-item-add" >
                                                                <img src="/vendor/img/icons/plus1.svg" />
                                                            </div>
                                                        </div>
                                                    </div>`;
                    $(".divide-main-panel").append(htmladd);
                }
                $("#dividemodal").modal("show");
            },
            error: function (jqXHR, textStatus, errorThrown) {
                toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
            }
        });
    }

    function CheckPermission(permission, callback) {
        $.ajax({
            url: "/POS/CheckPermission?permission=" + permission,
            type: "POST",
            success: function (data, textStatus, jqXHR) {
                if (data.status == 0) {
                    callback();
                }
                else {
                    ShowPermissionError(permission);
                }
            },
            error: function (jqXHR, textStatus, errorThrown) {
                toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
            }
        });
    }

    function ShowPermissionError(permission) {
        $("#permissionpinmodal").data("permission", permission)
        $("#permissionpinmodal").modal("show");
        isPermission = true;
        $("#input-pin").data("value", "");
        $(".display-pin").html("");
    }

    function SaveDivide(seldivide) {
        var items = [];
        $(".divide-account").each(function () {
            var divideid = parseInt($(this).data("divideid"));

            $(this).find(".divide-item").each(function () {

                var itemid = parseInt($(this).data("itemid"));
                var seat = parseInt($(this).data("seat"));
                var qty = parseFloat($(this).data("qty"));
                var item = {
                    DivideId: divideid,
                    ItemId: itemid,
                    SeatNum: seat,
                    Qty: qty
                }
                items.push(item);
            });
        });
        if (!seldivide) seldivide = 0;
        $.ajax({
            url: "/POS/SaveDivideResult?orderId=@Model.ID&divideId=" + seldivide,
            type: "POST",
            data: JSON.stringify(items),
            contentType: 'application/json;',
            dataType: 'json',
            success: function (data, textStatus, jqXHR) {
                if (data.status == 1){
                    window.location.replace("/POS/Checkout?orderId=@Model.ID&DividerId=" + seldivide);
                }
                else if (data.status == 0){
                    if (seldivide > 0) {
                        LoadOrderItems();
                    }
                    else {
                        window.location.replace("/POS/Station");
                    }
                }
            },
            error: function (jqXHR, textStatus, errorThrown) {
                toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
            }
        });
    }

    function CreateItemToAccount(item, qty, dividerId) {
        var target;
        $(".divide-account").each(function () {
            var id = $(this).data("divideid");
            if (id == dividerId) {
                target = $(this);
            }
        })

        if (target) {
            var itemid = item.data("itemid");
            var exist = false;
            target.find(".divide-item").each(function () {
                var itemid1 = $(this).data("itemid");
                var qty1 = parseFloat($(this).attr("data-qty"));
                if (itemid == itemid1) {
                    qty = qty + qty1;
                    $(this).attr("data-qty", qty);
                    $(this).find(".divide-item-qty").text(qty.toFixed(2));
                    exist = true;
                }
            })
            if (!exist) {
                target.find(".divide-body").append(item.wrap("</p>").parent().html());
                item.unwrap();

            }
        }
    }

    function MoveItemToAccount(item, dividerId, remove) {
        var target;
        $(".divide-account").each(function () {
            var id = $(this).data("divideid");
            if (id == dividerId) {
                target = $(this);
            }
        })

        if (target) {
            var itemid = item.data("itemid");
            var qty = parseFloat(item.attr("data-qty"));
            var exist = false;
            target.find(".divide-item").each(function () {
                var itemid1 = $(this).data("itemid");
                var qty1 = parseFloat($(this).attr("data-qty"));
                if (itemid == itemid1) {
                    qty = qty + qty1;
                    $(this).attr("data-qty", qty);
                    $(this).find(".divide-item-qty").text(qty.toFixed(2))
                    exist = true;
                }
            })
            if (!exist) {
                target.find(".divide-body").append(item.wrap("</p>").parent().html());
                item.unwrap();
            }
            item.remove();
        }
    }

    function CheckQuestionAvailablity() {
        var valid = true;

        var servingsize = $(".serving-size-item");
        if (servingsize.length > 0){
            var activeserving = $(".serving-size-item.active");
            if (activeserving.length == 0) {
                valid = false;
                activeserving.addClass("invalid");
            }
        }

        $(".question-item").each(function () {
            var min = parseInt($(this).data("min"));

            var answers = $(this).find(".answer-item.active");
            if (min > 0 && min > answers.length) {
                valid = false;
                $(this).addClass("invalid");
            }

            answers.each(function () {
                var hasQty = $(this).data("hasqty");
                var hasDivisor = $(this).data("hasdivisor");

                var qty = $(this).data("qty");
                var divisor = $(this).data("divisor");
                if (hasQty && !qty) {
                    valid = false;
                    $(this).addClass("invalid");
                }
                if (hasDivisor && !divisor) {
                    valid = false;
                    $(this).addClass("invalid");
                }
            });

        })

        if (!valid) {
            $("#question-submit").prop("disabled", true);
        }
        else {
            $("#question-submit").prop("disabled", false);
        }
    }

    function AddOrderItem2(barcode) {

        var data = {
            OrderId: @Model.ID,
            Barcode: barcode,
        }

        $.ajax({
            url: "/POS/AddProductToOrderItemWithBarcode",
            type: "POST",
            data: data,
            success: function (data, textStatus, jqXHR) {
                $("#scannedBarcode").val("")
                if (data.status == 0) {
                    LoadOrderItems();
                }
                else if (data.status == 1) {

                }
            },
            error: function (jqXHR, textStatus, errorThrown) {
                toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
            }
        });
    }

    var bProcesandoAddOrderItem = false;
    function AddOrderItem(product, menupid, qty, seat) {
    //Evitamos que se procese varias veces
        if (!bProcesandoAddOrderItem){
        
        var divideNum = parseInt($("#divide-num").val());

        var data = {
            OrderId: @Model.ID,
            ProductId: product,
            MenuProductId: menupid,
            Qty: qty,
            SeatNum: seat,
            DividerNum: divideNum
        }

        bProcesandoAddOrderItem = true;
        $.ajax({
            url: "/POS/AddProductToOrderItem",
            type: "POST",
            data: data,
            success: function (data, textStatus, jqXHR) {
                if (data.status == 0) {
                    $(".question-body").empty();
                    if (data.hasServingSize || data.hasQuestion) {
                        $("#QuestionTitleModal").html(data.productName);
                        if (data.hasServingSize) {
                            var d = data.servingSizes
                            var html = `
                                        <div class="card question-main serving-size-main" style="border:none">
                                            <div class="card-header justify-content-between">
                                                <div class="d-flex " style="color:white; border:none">
                                                <h5 style=" color:orange">Serving Sizes: </h5>    &nbsp;&nbsp;
                                            </div>
                                        </div>
                                        <div><div class="serving-size-container card-body row pt-1  justify-content-between gird-products" style="" data-prodid='${product}'>`;
                            for (var j = 0; j < data.servingSizes.length; j++) {
                                var a = data.servingSizes[j];
                                var active = "";
                                if (a.isDefault) active = "active"
                                        html +=
                                            `<div class=" card product serving-size-item ${active}" data-id="${a.servingSizeID}" >
                                                <h5 class="saving-size-title">${a.servingSizeName}</h5>
                                            </div>  `
                            }
                            html += `</div> </div></div></div> `

                            $(".question-body").append(html);
                        }
                        if (data.hasQuestion) {
                            for (var i = 0; i < data.questions.length; i++) {
                                var d = data.questions[i];

                                var html = `
                                                  <div class="card question-main" data-min="${d.minAnswer}" data-max="${d.maxAnswer}" style="border:none; margin:0px;">
                                                        <div class="card-header justify-content-between" style="padding:0px" >

                                                            <div class="d-flex " style="color:white; border:none">
                                                            <h6 style=" color:orange">${d.name}: </h6>    &nbsp;&nbsp;
                                                                            Min: <span class="min-answer" style="color:white">${d.minAnswer}</span>,  Max: <span class="max-answer" style="color:white">${d.maxAnswer}</span>, Free Choice: <span class="freechoice" style="color:white">${d.freeChoice}</span>
                                                        </div>
                                                    </div>
                                                    <div>
                                                        <div class="question-item card-body row pt-1  justify-content-between gird-products" data-id="${d.id}" data-name="${d.name}" data-min="${d.minAnswer}" data-max="${d.maxAnswer}" style=" grid-template-columns: 19% 19% 19% 19% 19% !important; padding:0px;">`;
                                for (var j = 0; j <= d.answers.length; j++) {
                                    var a = d.answers[j];
                                    if (a) {
                                        var active = "";
                                        if (a.isPreSelected) {
                                            active = "active";
                                        }
                                        var divisorDefault = "";
                                        if (a.hasDivisor) {
                                            divisorDefault = "data-divisor='1'"
                                        }

                                        if (a.product.photo) {
                                            html += `
                                            <div class='product-item-kiosk' style="width:auto !important;">
                                            <div class="product-item-1 answer-item ${active}" data-answerid="${a.id}" data-hasqty="${a.hasQty}" data-hasdivisor="${a.hasDivisor}" data-qty='1' ${divisorDefault} style="background-color:${a.product.backColor}; color:${a.product.textColor}">
                                                <img class="card-img-1" src="${a.product.photo}" alt="">
                                            <h5 class="product-title-1"  style='color:#FFFFFF'><span class="before-smb" style="color:lightgray"> </span> ${a.product.name} <span class="after-smb" style="color:grey;"></span></h5>

                                        </div> </div> `
                                        }
                                        else {
                                            html +=
                                                `<div class='product-item-kiosk' style="width:auto !important;">
                                                          <div class="product-item-1 answer-item ${active}" data-answerid="${a.id}" data-hasqty="${a.hasQty}" data-hasdivisor="${a.hasDivisor}"  data-qty='1' ${divisorDefault}  style="background-color:${a.product.backColor}; color:${a.product.textColor}">
                                                          <h5 class="product-card-title-noimg" style='color:#FFFFFF'><span class="before-smb" style="color:lightgray"> </span> ${a.product.name} <span class="after-smb" style="color:grey;"></span></h5>
                                                     </div>
                                                </div>`
                                        }
                                    }

                                }

                                html += `</div>`

                                html += `<div class="smartbtn-items card-body row pt-1  justify-content-between gird-products" style="margin-top: 20px;  grid-template-columns: 19% 19% 19% 19% 19% !important; padding:0px;" > `;
                                for (var j = 0; j <= d.smartButtons.length; j++) {
                                    var a = d.smartButtons[j];

                                    if (a) {
                                        var after = "after";
                                        if (!a.isAfterText) after = "before";
                                        //html += `<div class="col-2 smartbtn-item btn button5" data-name="${a.button.name}" data-smartbtnid="${a.button.id}" data-after="${after}" > ${a.button.name} <p style="color: lightgray">${after}</p></div>`;
                                        html += `<div class='product-item-kiosk' style="width:auto !important;">
                                                          <div class="product-item-1 btn button5 smartbtn-item " data-name="${a.button.name}" data-smartbtnid="${a.button.id}" data-after="${after}" style="background-color:#637381; color:#FFFFFF; height: initial;" > 
                                                          <h5 class="product-card-title-noimg" style='color:#FFFFFF'>${a.button.name} <p style="color: lightgray">${after}</p></h5>
                                                     </div>
                                                </div>`;
                                    }
                                }

                                html += `</div> </div></div></div> `

                                $(".question-body").append(html);
                            }
                        }
                        CheckQuestionAvailablity();
                        $("#forcedquestionmodal").data("itemid", data.itemId);
                        CustomModalShow("#forcedquestioncustommodal");
                    }

                    else {
                        LoadOrderItems();
                    }
                }
                else if (data.status == 3) {
                    toastr.error("@ViewLocalizer["Out of stock."]", {})

                    $("#invqty-number").val(data.product.inventoryCount);
                    if (data.product.inventoryCountDownActive) {
                        $("#inventory-active").val(1).change();
                    }
                    else {
                        $("#inventory-active").val(2).change();
                    }
                    $("#inventorycountdownmodal").data("prodid", data.product.id);
                    $("#inventorycountdownmodal").data("itemid", 0);
                    $("#inventorycountdownmodal").modal("show");
                }

                bProcesandoAddOrderItem=false;
            },
            error: function (jqXHR, textStatus, errorThrown) {
                toastr.error("@ViewLocalizer["There was an error in processing the request."]", {});
                bProcesandoAddOrderItem=false;
            }
        });
        }
    }

    $("#order-cancel").click(function () {
        window.location.replace("/POS/Station")
    })

    function LoadGroup() {
        $.ajax({
            url: "/POS/GetMenuGroupList",
            type: "POST",
            success: function (data, textStatus, jqXHR) {
                $("#group-panel-main").empty();
                $("#group-panel-main").data("selected", "");
                $("#category-panel-main").empty();
                $("#category-panel-main").data("selected", "");
                $("#subcategory-panel-main").empty();
                $("#subcategory-panel-main").data("selected", "");
                $("#product-panel-main").empty();

                for (var i = 0; i < data.length; i++) {
                    var d = data[i];
                    var active = "";
                    if (i == 0) {
                        active = "active";
                        $("#group-panel-main").data("selected", d.id);
                        LoadCategory(d.id);
                    }
                    var html =
                        `
                                <button class="group-item btn btn-nostyle ${active}" data-id='${d.id}' style='background-color:${d.backColor}; color: ${d.textColor}'>${d.name}</button>
                            `
                    $("#group-panel-main").append(html);


                }

            },
            error: function (jqXHR, textStatus, errorThrown) {
                toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
            }
        });
    }

    function LoadCategory(id) {

        $.ajax({
            url: "/POS/GetMenuCategoryList?groupId=" + id,
            type: "POST",
            success: function (data, textStatus, jqXHR) {
                $("#category-panel-main").empty();
                $("#category-panel-main").data("selected", "");
                $("#subcategory-panel-main").empty();
                $("#subcategory-panel-main").data("selected", "");
                $("#product-panel-main").empty();

                for (var i = 0; i < data.length; i++) {
                    var d = data[i];
                    var active = "";
                    if (i == 0) {
                        active = "active";
                        $("#category-panel-main").data("selected", d.id);
                        LoadSubCategory(d.id);
                    }

                    // var html =
                    //     `
                    //              <button class="category-item btn button3 ${active}" data-id='${d.id}' style='background-color:#C00000; color: ${d.textColor}'>${d.name}</button>
                    //         `
                    var html =
                        `
                                 <button class="category-item btn button3 ${active}" data-id='${d.id}'>${d.name}</button>
                            `
                    $("#category-panel-main").append(html);
                }
            },
            error: function (jqXHR, textStatus, errorThrown) {
                toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
            }
        });
    }

    function LoadSubCategory(id) {
        $.ajax({
            url: "/POS/GetMenuSubCategoryList?categoryId=" + id,
            type: "POST",
            success: function (data, textStatus, jqXHR) {
                $("#subcategory-panel-main").empty();
                $("#subcategory-panel-main").data("selected", "");
                $("#product-panel-main").empty();

                for (var i = 0; i < data.length; i++) {
                    var d = data[i];
                    var active = "";
                    if (i == 0) {
                        active = "active";
                        $("#subcategory-panel-main").data("selected", d.id);
                        LoadProduct(d.id);
                    }

                    var html =
                        `
                                <button class="subcategory-item btn btn-nostyle ${active}"  data-id='${d.id}'>${d.name}</button>
                            `
                    $("#subcategory-panel-main").append(html);
                }

            },
            error: function (jqXHR, textStatus, errorThrown) {
                toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
            }
        });
    }

    function LoadProduct(id) {
        $.ajax({
            url: "/POS/GetMenuProductList?subCategoryId=" + id,
            type: "POST",
            success: function (data, textStatus, jqXHR) {
                $("#product-panel-main").empty();

                for (var i = 0; i < data.length; i++) {
                    var d = data[i];

                    var inventory_html = '';
                    if (d.product.inventoryCountDownActive) {
                        inventory_html = `<div class="inventory-qty"><span>${d.product.inventoryCount}</span></div>`;
                    }

                    if (d.product.photo) {
                        var html =
                            `
                                    <div class="product-item card product product-item-kiosk" data-invactive="${d.product.inventoryCountDownActive}" data-inv="${d.product.inventoryCount}"  data-id='${d.id}' data-productid='${d.product.id}' style="border-bottom: solid 4px ${d.product.backColor}; color:${d.product.textColor}">
                                            <img class="card-img" src="${d.product.photo}" alt="">
                                        <div class="card-img-overlay">
                                                <div class="product-title">${d.product.name}</div>
                                        </div>
                                        ${inventory_html}
                                    </div>

                                    `
                        $("#product-panel-main").append(html);
                    }
                    else {
                        var html =
                            `
                                        <div class="product-item card product product-item-kiosk" data-invactive="${d.product.inventoryCountDownActive}" data-inv="${d.product.inventoryCount}"  data-id='${d.id}' data-productid='${d.product.id}' style="border-bottom: solid 4px ${d.product.backColor}; color:${d.product.textColor}">
                                                 <h5 class="product-card-title">${d.product.name}</h5>
                                             ${inventory_html}
                                    </div>

                                    `
                        $("#product-panel-main").append(html);
                    }
                }
            },
            error: function (jqXHR, textStatus, errorThrown) {
                toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
            }
        });
    }

    function AdjustHeight() {
        var top = $(".order-table").position();
        var bottom = $(".order-summary").position();
        //$("#order-item-table").css("height", '' + (bottom.top - top.top - 90) + 'px');

    }

    drag("#order-item-list");
    drag("#product-panel-main");
    drag(".categories");
    drag(".sub-category");
    function LoadOrderItems() {
        var dividerid = $("#divide-num").val();

        ShowLoader();
        $.ajax({
            url: "/POS/GetOrderItems?orderId=@Model.ID&dividerId=" + dividerid,
            type: "POST",
            success: function (data, textStatus, jqXHR) {
                $("#order-item-list").empty();
                HideLoader();

                if (dividerid > 0) {
                    $(".order-client").text(data.client);
                }

                $(".seat-add-div").hide();
                var itemCount = 0;
                if (data.order.orderMode == 1) {

                    var haveActiveSeat = false;
                    $(".seat-add-div").show();
                    for (var i = 0; i < data.seats.length; i++) {
                        var seat = data.seats[i];
                        var client = "";
                        if (seat.clientName && seat.clientName != "") client = " - " + seat.clientName;

                        var num = (i + 1) % seatcolors.length;
                        var color = seatcolors[num];
                        var active = '';
                        if (seat.seatNum == CurrentSeat) {
                            active = 'active';
                            haveActiveSeat = true;
                        }
                        var html = ` <div class="order-group ${active}">
                                            <div class="edit-seatitem group-heading d-flex justify-content-between"  data-seatnum="${seat.seatNum}" data-seatid="${seat.id}" data-seatname="${seat.clientName}" style='background:${color}'><span>Seat #${seat.seatNum} ${client}</span></div>
                                            <div class="group-content" data-seatnum=${seat.seatNum}>`;

                        for (var j = 0; j < seat.items.length; j++) {
                            var d = seat.items[j];
                            html += GetItemHtml(d);
                            itemCount++;
                        }

                        html += `</div></div>`;
                        $("#order-item-list").append(html);
                    }

                    if (!haveActiveSeat) {
                        $(".order-group").each(function () {
                            if (!haveActiveSeat) {
                                 $(this).addClass("active");
                                CurrentSeat = parseInt($(this).find(".edit-seatitem").data("seatnum"))
                                haveActiveSeat = true;
                            }
                        })
                    }
                }
                else if (data.order.orderMode == 0) {

                    var html = ``;
                    var course = "";
                    for (var i = 0; i < data.items.length; i++) {
                        var d = data.items[i];
                        if (d.course != course) {
                            html += `<div class="course-item" style='background-color:#555'><span class="">${d.course} </span><span class=""></span></div>`;
                            course = d.course;
                        }
                        html += GetItemHtml(d);
                        itemCount++;
                    }
                    $("#order-item-list").append(html);
                }
                else if (data.order.orderMode == 2) {
                    var html = ``;
                    var course = "";
                    for (var i = 0; i < data.items.length; i++) {
                        var d = data.items[i];
                        if (d.course != course) {
                            html += `<div class="course-item" style='background-color:#555'><span class="">${d.course} </span><span class=""></span></div>`;
                            course = d.course;
                        }
                        html += GetItemHtml(d);
                        itemCount++;
                    }

                    $("#order-item-list").append(html);
                }
                if (itemCount == 0){
                    $("#order-save").prop("disabled", true);
                }
                else{
                    $("#order-save").prop("disabled", false);
                }
                var total = numberWithCommas(data.order.totalPrice.toFixed(2))
                $("#order-total").text("$" + total);
                $("#order-tax").text("$" + data.order.tax.toFixed(2));
                $("#order-tip").text("$" + data.order.tip.toFixed(2));
                if (data.order.delivery) {
                    $("#order-delivery-cost").text("$" + data.order.delivery.toFixed(2));
                } else {
                    $("#order-delivery-cost").text("$" + (0.0).toFixed(2));
                }

                $(".order-tax-items").empty();
                if (data.order.taxes && data.order.taxes.length > 0) {
                    html = `<div class="sub-items subitems-tax">`;
                    for (var k = 0; k < data.order.taxes.length; k++) {
                        var q = data.order.taxes[k];
                        html += `<div class="item px-3 d-flex justify-content-between"><span class="">${q.description}</span><span class="">$${q.amount.toFixed(2)}</span></div>`;
                    }
                    html += `</div>`;
                    $(".order-tax-items").append(html);
                }
                $("#order-propina").text("$" + data.order.propina.toFixed(2));
                $(".order-propina-items").empty();
                if (data.order.propinas && data.order.propinas.length > 0) {
                    html = `<div class="sub-items subitems-propina">`;
                    for (var k = 0; k < data.order.propinas.length; k++) {
                        var q = data.order.propinas[k];
                        html += `<div class="item px-3 d-flex justify-content-between"><span class="">${q.description}</span><span class="">$${q.amount.toFixed(2)}</span></div>`;
                    }
                    html += `</div>`;
                    $(".order-propina-items").append(html);
                }

                $("#order-subtotal").text("$" + data.order.subTotal.toFixed(2));
                $("#order-discount").text("$" + data.order.discount.toFixed(2));
                $(".order-discount-items").empty();
                if (data.order.discounts && data.order.discounts.length > 0) {
                    html = `<div class="sub-items subitems-discount">`;
                    for (var k = 0; k < data.order.discounts.length; k++) {
                        var q = data.order.discounts[k];
                        html += `<div class="item px-3 d-flex justify-content-between"><span class="">${q.name}</span><span class="">$${q.amount.toFixed(2)}</span></div>`;
                    }
                    html += `</div>`;
                    $(".order-discount-items").append(html);
                }

                $("#order-paid-total").text(data.order.payAmount);
                if (data.order.paymentStatus == 0) {
                    $("#payment-status").text("Not Paid");
                }
                else if (data.order.paymentStatus == 1) {
                    $("#payment-status").text("Partly Paid");
                }
                else if (data.order.paymentStatus == 2) {
                    $("#payment-status").text("Paid");
                }
                else if (data.order.paymentStatus == 3) {
                    $("#payment-status").text("Seat Paid");
                }
                else if (data.order.paymentStatus == 4) {
                    $("#payment-status").text("Divide Paid");
                }
            },
            error: function (jqXHR, textStatus, errorThrown) {
                toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
            }
        });
    }

    function GetItemHtml(d) {
        var html = ``;
        var status = "";
        if (d.status == 1) {
            status = "fa-check text-primary";
        }
        else if (d.status == 2 || d.status == 3) {
            status = "fa-stopwatch text-info";
        }
        else if (d.status == 4) {
            status = "fa-checkall text-success";
        }

        var question_html = ``;
        var rollprice = 0;
        if (d.questions && d.questions.length > 0) {
            var divisor = 0;
            question_html += `<div class="sub-items">`;
            for (var k = 0; k < d.questions.length; k++) {
                var q = d.questions[k];
                var divisor_html = '';
                var showDesc = false;
                
                if (q.divisor != divisor){
                    if (q.divisor == 1){
                        divisor_html = `<div class="item"><span class="">Completa : </span><span class=""></span></div>`;
                    }
                    else if (q.divisor == 2){
                        divisor_html = `<div class="item"><span class="">1 Mitad :</span><span class=""></span></div>`;
                        showDesc= true;
                    }
                    else if (q.divisor == 3) {
                        divisor_html = `<div class="item"><span class="">2 Mitad : </span><span class=""></span></div>`;
                        showDesc= true;
                    }

                    divisor = q.divisor;
                }
                
                if (q.isPreSelect) {
                    if (!q.isActive || q.qty>1 || showDesc || q.showDesc) {
                        question_html += divisor_html;
                        question_html += `<div class="item mx-2"><span class="">${q.description}</span><span class=""></span></div>`;
                        showDesc = true;
                    }
                    // else if (q.divisor != 0 || q.qty > 1 || q.subDescription) {
                    //     question_html += divisor_html;
                    //     question_html += `<div class="item mx-2"><span class="">${q.description}</span><span class=""></span></div>`;
                    //     showDesc = true;
                    // }
                }
                else {
                    if (q.canRoll) {
                        rollprice += q.price;
                        question_html += divisor_html;
                        question_html += `<div class="item mx-2"><span class="">${q.description}</span><span class=""></span></div>`;
                        showDesc = true;
                    }
                    else {
                        var price = q.price * (q.qty - q.freeChoice);
                        question_html += divisor_html;
                        question_html += `<div class="item mx-2"><span class="">${q.description}</span><span class="">${price.toFixed(2)}</span></div>`;
                        showDesc = true;
                    }
                }
                if (showDesc && q.subDescription) {
                    question_html += `<div class="item mx-2"><span class="mx-3"> ${q.subDescription}</span><span class=""></span></div>`;
                }
            }
            question_html += `</div>`;
        }
        var subtotal = d.subTotal;

        var servingSize = "";
        if (d.servingSizeName) {
            servingSize = "(" + d.servingSizeName + ")";
        }

        html += `
                        <div class="order-item tr" data-id="${d.id}" data-status="${d.status}"  data-promotion="${d.hasPromotion}">
                            <div class="td text-start">${d.name}${servingSize}</div>
                            <div class="td"><span class="fa ${status}"></span></div>
                            <div class="td">${d.qty.toFixed(2)}</div>
                            <div class="td">${d.price.toFixed(2)}</div>
                            <div class="td">${subtotal.toFixed(2)}</div>

                        `;
        html += question_html;
        if (d.discounts && d.discounts.length > 0) {
            html += `<div class="sub-items sub-items-discount">`;
            for (var k = 0; k < d.discounts.length; k++) {
                var q = d.discounts[k];
                html += `<div class="item"><span class="">${q.name}</span><span class="">-${q.amount.toFixed(2)}</span></div>`;
            }
            html += `</div>`;
        }

        html += `</div>`;
        return html;
    }

    function SelectDiscount(discountid) {
        var type = $("#discountmodal").data("type");
        var id = parseInt($("#discountmodal").data("id"));
        var dividerid = parseInt($("#divide-num").val());
        var data = {
            Type: type,
            TargetId: id,
            DiscountId: discountid,
            DivideId: dividerid
        }

        $.ajax({
            url: "/POS/AddDiscount",
            type: "POST",
            data: JSON.stringify(data),
            contentType: 'application/json;',
            dataType: 'json',
            success: function (data, textStatus, jqXHR) {
                if (data.status == 0) {
                    if (data.type == "order") {
                        $("#btn-discountitem").hide();
                    }
                    else if (data.type == "item" ) {
                        $("#btn-order-discount").hide();
                    }
                    LoadOrderItems();
                    AdjustHeight();
                    $("#discountmodal").modal("hide");
                }

            },
            error: function (jqXHR, textStatus, errorThrown) {
                toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
            }
        });
    }

    function GetAnotherSeats(current) {
        var seats = [];
        $(".edit-seatitem").each(function () {
            var num = $(this).data("seatnum");
            if (num != current) {
                var seat = {
                    id: $(this).data("seatid"),
                    num: $(this).data("seatnum"),
                    name: $(this).data("seatname")
                }

                seats.push(seat)

            }
        });
        return seats;
    }

    function SelectCustomer(customer, borrar=false) {
        if (customer) {
            console.log(customer);
            $(".order-client").text(customer.name);
            $(".order-comprobante").text(customer.voucher);
            var dividerid = parseInt($("#divide-num").val());
            if (!dividerid) dividerid = 0;
            var data = {
                OrderId: @Model.ID,
                ClientName: customer.name,
                CustomerId: customer.id,
                DividerId: dividerid
            };
            $.ajax({
                url: "/POS/UpdateOrderInfo",
                type: "POST",
                data: JSON.stringify(data),
                contentType: 'application/json;',
                dataType: 'json',
                success: function (data, textStatus, jqXHR) {
                    $(".order-client").text(data.customerName);
                    $(".order-comprobante").text(data.comprobanteName);
                    $("#orderinfo").modal("hide");
                    LoadOrderItems();
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                }
            });

        }
        
        if(borrar){
            var dividerid = parseInt($("#divide-num").val());
            if (!dividerid) dividerid = 0;
            var data = {
                OrderId: @Model.ID,
                ClientName: "",
                CustomerId: 0,
                DividerId: dividerid
            };
            $.ajax({
                url: "/POS/UpdateOrderInfo",
                type: "POST",
                data: JSON.stringify(data),
                contentType: 'application/json;',
                dataType: 'json',
                success: function (data, textStatus, jqXHR) {
                    $(".order-client").text(data.customerName);
                    $(".order-comprobante").text(data.comprobanteName);
                    $("#orderinfo").modal("hide");
                    LoadOrderItems();
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                }
            });
        }


        $.ajax({
            url: "/Setting/GetActiveCustomers",
            type: "POST",
            success: function (data, textStatus, jqXHR) {

                $("#customer-select").empty();
                $("#customer-select").append("<option value='' selected>@ViewLocalizer["Choose customer"]</option>")
                for (var i = 0; i < data.length; i++) {
                    var d = data[i];

                    $("#customer-select").append("<option value='" + d.id + "' data-address='" + d.address1 + "' data-zone='" + d.deliveryZoneID + "'>" + d.name + "</option>")
                }
                $("#customer-select").select2({ dropdownParent: $('#orderinfo .modal-body') });
                if (customer) {
                    $("#customer-select").val(customer.id).change();
                }
                else {
                    $("#customer-select").val(0).change();
                }
                $("#customer-select-seat").empty();
                $("#customer-select-seat").append("<option value='' selected>@ViewLocalizer["Choose customer"]</option>")
                for (var i = 0; i < data.length; i++) {
                    var d = data[i];

                    $("#customer-select-seat").append("<option value='" + d.id + "'  data-address='" + d.address1 + "' data-zone='" + d.deliveryZoneID + "'>" + d.name + "</option>")
                }
                $("#customer-select-seat").select2({
                    dropdownParent: $("#seatinfomodal")
                });
                if (customer) {
                    $("#customer-select-seat").val(customer.id).change();
                }
                else {
                    $("#customer-select-seat").val(0).change();
                }
            },
            error: function (jqXHR, textStatus, errorThrown) {
                toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
            }
        });

        $("#listcustomer").modal("hide");
    }

    $("#customer-select").change(function () {
        var customer = $('#customer-select').find(":selected");
        var address = customer.data("address");
        var zone = customer.data("zone");

        $("#customer-address").val(address);
        $("#customer-zone1").val(zone).change();
    });

    $("#customer-select-phone").change(function () {
        var id = $(this).val();
        $("#customer-select").val(id).change();
    })



    function SelectCustomerPhone(customer) {
        $.ajax({
            url: "/Setting/GetActiveCustomers",
            type: "POST",
            success: function (data, textStatus, jqXHR) {
                $("#customer-select-phone").empty();
                $("#customer-select-phone").append("<option value='' selected>@ViewLocalizer["Choose phone number"]</option>");

                for (var i = 0; i < data.length; i++) {
                    var d = data[i];

                    $("#customer-select-phone").append("<option value='" + d.id + "' >" + d.phone + "</option>")
                }
                $("#customer-select-phone").select2({ dropdownParent: $('#orderinfo .modal-body') });
                if (customer) {
                    $("#customer-select-phone").val(customer.id).change();
                }
                else {
                    $("#customer-select-phone").val(0).change();
                }
            },
            error: function (jqXHR, textStatus, errorThrown) {
                toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
            }
        });

        $("#listcustomer").modal("hide");
    }

    function EditCustomer(id) {
        $('#label-rnc-validado').prop('hidden', true);
        $('#label-rnc-novalidado').prop('hidden', true);

        $.ajax({
            url: "/Setting/GetCustomer?customerId=" + id,
            type: "POST",
            success: function (customer, textStatus, jqXHR) {
                if (customer) {
                    $("#customer-name").val(customer.name);
                    $("#customer-rnc").val(customer.rnc);
                    $("#customer-address1").val(customer.address1);
                    $("#customer-address2").val(customer.address2);
                    $("#customer-phone").val(customer.phone);
                    $("#customer-email").val(customer.email);
                    $("#customer-zone").val(customer.deliveryZoneID).change();
                    $('#compania-name').val(customer.company);

                    if (customer.voucher) {
                        $("#customer-voucher").val(customer.voucher.id).change();
                    } else {
                        $("#customer-voucher").val(null).change();
                    }


                    $("#addcustomer").data("id", customer.id);
                    $("#addcustomer").modal("show");
                }
            },
            error: function (jqXHR, textStatus, errorThrown) {
                toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
            }
        });
    }

    function AddCustomer() {
        $("#customer-name").val("");
        $("#customer-rnc").val("");
        $("#customer-phone").val("");
        $("#customer-email").val("");
        $("#customer-voucher").val(0).change();
        $('#compania-name').val("");

        $("#addcustomer").data("id", 0);
        $("#addcustomer").modal("show");
        $('#listcustomer').modal("hide");

        $('#label-rnc-validado').prop('hidden', true);
        $('#label-rnc-novalidado').prop('hidden', true);

        SelectVoucher();
        SelectZones();
    }

    $("#customer-list").DataTable({
        "processing": true, // for show progress bar
        "serverSide": true, // for process server side
        "filter": true, // this is for disable filter (search box)
        "orderMulti": false, // for disable multiple column at once
        "ajax": {
            "url": "/Setting/GetActiveCustomerList",
            "type": "POST",
            "datatype": "json"
        },
        'select': {
            'style': 'multi'
        },
        "pageLength": 10,
        "lengthMenu": [25, 25, 50],
        "columnDefs": [{ className: 'side-by-side', targets: 0 }],
        "order": [[2, 'desc']],
        "columns": [
            {

                'data': 'action', 'name': 'action',
                render: function (data, type, row) {
                    console.log(JSON.stringify(row));
                    return "<div class='add-icon'><a class='me-3' href='javascript:void(0);'  onclick=EditCustomer('" + row.id + "'); ><img src='/vendor/img/icons/edit-set.svg' alt='img'></a></div><div class='add-icon'><a class='me-3' href='javascript:void(0);' onclick='SelectCustomer(" + JSON.stringify(row) + ")'><img src='/vendor/img/icons/plus1.svg' alt='img'></a></div>";
                },
            },
            { "data": "name", "name": "name", "autoWidth": true },
            { "data": "phone", "name": "phone", "autoWidth": true },
            { "data": "address1", "name": "Dirección", "autoWidth": true },
        ]
    });

    $("#edit-customer").click(function () {
        var name = $("#customer-name").val();
        if (!name || name == "") {
            toastr.warning("@ViewLocalizer["Please input the name."]", { showMethod: "fadeIn", hideMethod: "fadeOut", timeOut: 2e3 })
            return;
        }

        var phone = $("#customer-phone").val();

        var email = $("#customer-email").val();
        var rnc = $("#customer-rnc").val();
        var address1 = $("#customer-address1").val();
        var address2 = $("#customer-address2").val();
        var zone = parseInt($("#customer-zone").val())
        var voucher = parseInt($("#customer-voucher").val())
        var id = parseInt($("#addcustomer").data("id"));
        var company = $('#compania-name').val();
        var data = {
            id: id,
            RNC: rnc,
            name: name,
            Phone: phone,
            Email: email,
            Address1: address1,
            Address2: address2,
            ZoneId: zone,
            VoucherId: voucher,
            Company: company
        }

        $.ajax({
            url: "/Setting/EditCustomerSimple",
            type: "POST",
            data: JSON.stringify(data),
            contentType: 'application/json;',
            dataType: 'json',
            success: function (dataResponse, textStatus, jqXHR) {
                if (dataResponse.status == 0) {
                    $("#customer-list").DataTable().draw();
                    $("#addcustomer").modal("hide");
                    $("#orderinfo").modal("hide");
                    data.id = dataResponse.customerid;
                    SelectCustomer(data);
                }
                else if (dataResponse.status == 2) {
                    toastr.error("@ViewLocalizer["The customer with same contact info already exists. Please confirm or check if the one exists."]", {})
                }
                else {
                    toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                }
            },
            error: function (jqXHR, textStatus, errorThrown) {
                toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
            }
        });

    });

    function SelectVoucher(voucher) {
        $.ajax({
            url: "/Setting/GetActiveVoucherList",
            type: "POST",
            success: function (data, textStatus, jqXHR) {
                $("#customer-voucher").empty();
                $("#customer-voucher").append("<option value='' selected>Choose comprobantes</option>")
                for (var i = 0; i < data.length; i++) {
                    var d = data[i];

                    $("#customer-voucher").append("<option value='" + d.id + "' >" + d.name + "</option>")
                }
                $("#customer-voucher").select2();
                if (voucher) {
                    $("#customer-voucher").val(voucher.id).change();
                }
                else {
                    $("#customer-voucher").val(0).change();
                }

                // for (var i = 0; i < data.length; i++) {
                //     var d = data[i];

                //     if (d.isPrimary) {
                //         $("#customer-voucher").val(d.id).change();
                //     }
                // }



            },
            error: function (jqXHR, textStatus, errorThrown) {
                toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
            }
        });

        $("#listvoucher").modal("hide");
    }

    function SelectZones() {
        $.ajax({
            url: "/Setting/GetActiveDeliveryZoneList",
            type: "POST",
            success: function (data, textStatus, jqXHR) {
                //Delivery
                $("#delivery-zone").empty();
                $("#delivery-zone").append("<option value='' selected>@ViewLocalizer["Choose Zone"]</option>")
                for (var i = 0; i < data.length; i++) {
                    var d = data[i];

                    $("#delivery-zone").append("<option value='" + d.id + "' >" + d.name + "</option>")
                }
                $("#delivery-zone").select2();

                $("#delivery-zone").val(0).change();


                //Customer
                $("#customer-zone").empty();
                $("#customer-zone").append("<option value='' selected>@ViewLocalizer["Choose Zone"]</option>")
                for (var i = 0; i < data.length; i++) {
                    var d = data[i];

                    $("#customer-zone").append("<option value='" + d.id + "' >" + d.name + "</option>")
                }
                $("#customer-zone").select2();

                $("#customer-zone").val(0).change();

                for (var i = 0; i < data.length; i++) {
                    var d = data[i];

                    if (d.isPrimary) {
                        $("#customer-zone").val(d.id).change();
                    }
                }

                //Customer
                $("#customer-zone1").empty();
                $("#customer-zone1").append("<option value='' selected>@ViewLocalizer["Choose Zone"]</option>")
                for (var i = 0; i < data.length; i++) {
                    var d = data[i];

                    $("#customer-zone1").append("<option value='" + d.id + "' >" + d.name + "</option>")
                }
                $("#customer-zone1").select2();

                $("#customer-zone1").val(0).change();
            },
            error: function (jqXHR, textStatus, errorThrown) {
                toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
            }
        });

        $("#listvoucher").modal("hide");
    }

    $("#edit-order-delivery").click(function () {
        var id = 0;
        var address1 = $("#delivery-address1").val();
        var address2 = $("#delivery-address2").val();
        var comments = $("#delivery-comments").val();
        var zone = $("#delivery-zone").val();
        var orderid = @Model.ID;

        if (!address1 || address1 == "") {
            toastr.warning("@ViewLocalizer["Please input the address."]", { showMethod: "fadeIn", hideMethod: "fadeOut", timeOut: 2e3 })
            return;
        }

        if (!zone || zone == "") {
            toastr.warning("@ViewLocalizer["Please select the zone."]", { showMethod: "fadeIn", hideMethod: "fadeOut", timeOut: 2e3 })
            return;
        }

        var data = {
            OrderId: orderid,
            Address1: address1,
            Address2: address2,
            Comments: comments,
            ZoneId: zone
        }

        $.ajax({
            url: "/POS/EditDelivery",
            type: "POST",
            data: JSON.stringify(data),
            contentType: 'application/json;',
            dataType: 'json',
            success: function (data, textStatus, jqXHR) {
                if (data.status == 0) {
                    $("#order-delivery-cost").text('$' + data.cost);
                    $("#order-delivery-time").text(data.time + ' minutos');

                    LoadOrderItems();
                    $("#orderdeliverymodal").modal("hide");
                }
                else {
                    toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
                }
            },
            error: function (jqXHR, textStatus, errorThrown) {
                toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
            }
        });

    });

    var isPermission = false;
    // permission pin
    $("body").on("click", ".pin", function () {
        var val = $(this).data("num");
        AddValue(val);

    });

    $("body").on("keydown", function (e) {
        var code = e.keyCode || e.which;
        if (isPermission)
        {
            if (code == 8)
                AddValue("del");

            if (code < 58 && code > 47) {
                AddValue("" + (code - 48));
            }
            if (code < 106 && code > 95) {
                AddValue("" + (code - 96));
            }
        }

    });

    $("#cancel-pin").click(function () {
        $("#permissionpinmodal").modal("hide");
        isPermission = false;
    });

    function SubmitResult() {
        var pin = $("#input-pin").data("value");
        var permission = $("#permissionpinmodal").data("permission");
        if (pin.length < 4) return;
        var data = {
            Pin: pin,
            Permission: permission
        }
        $.ajax({
            url: "/POS/AllowPermission",
            type: "POST",
            data: JSON.stringify(data),
            contentType: 'application/json;',
            dataType: 'json',
            success: function (data, textStatus, jqXHR) {
                if (data.status == 0) {
                    if (permission == "Permission.POS.Discounts") {
                        $("#discountmodal").modal("show");
                    }
                    else if (permission == "Permission.POS.VoidOrder") {
                        $("#voidordermodal").modal("show");
                    }
                    else if (permission == "Permission.POS.VoidProduct") {
                        $("#cancelitemmodal").modal("show");
                    }
                    else if (permission == "Permission.POS.Split") {
                        ShowSplitDialog();
                    }
                    else if (permission == "Permission.POS.MoveSeat") {
                        $("#moveseattablemodal").modal("show");
                    }
                    else if (permission == "Permission.POS.MoveItem") {
                        $("#movetablemodal").modal("show");
                    }
                    else if (permission == "Permission.POS.MoveItemToOtherArea") {
                        $("#moveareatablemodal").modal("show");
                    }
                    else if (permission == "Permission.POS.Pay") {
                        ShowLoader();
                        var dividerNum = $("#divide-num").val();
                        window.location.replace("/POS/Checkout?OrderId=@Model.ID&DividerId=" + dividerNum);
                    }


                    $("#permissionpinmodal").modal("hide");
                    isPermission = false;
                }
                else if (data.status = 1) {
                    toastr.error("@ViewLocalizer["Wrong pin was inputed."]", {})
                }

            },
            error: function (jqXHR, textStatus, errorThrown) {
                toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
            }
        });
    }

    // print
    $("#order-print").click(function () {
        var dividerNum = $("#divide-num").val();
        ShowLoader();
        $.ajax({
            url: "/POS/PrintOrder?OrderID=@Model.ID&DivideNum=" + dividerNum,
            type: "POST",
            success: function (data, textStatus, jqXHR) {
                if (data.status == 0) {
                    LoadOrderItems();
                }
                HideLoader();
            },
            error: function (jqXHR, textStatus, errorThrown) {
                toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
            }
        });
    });

    $("body").on("click", ".divide-print", function () {
        var dividernum = $(this).closest(".divide-account").data("divideid");
        ShowLoader();
        $.ajax({
            url: "/POS/PrintOrder?OrderID=@Model.ID&DivideNum=" + dividernum,
            type: "POST",
            success: function (data, textStatus, jqXHR) {
                if (data.status = 0) {


                }
                HideLoader();
            },
            error: function (jqXHR, textStatus, errorThrown) {
                toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
            }
        });

    });

    $("#divide-print").click(function () {
        ShowLoader();
        $.ajax({
            url: "/POS/PrintDivideOrder?OrderID=@Model.ID",
            type: "POST",
            success: function (data, textStatus, jqXHR) {
                if (data.status = 0) {
                }
                HideLoader();
            },
            error: function (jqXHR, textStatus, errorThrown) {
                toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
            }
        });
    });

    $("#btn-printseat").click(function () {
        var seatnum = $("#seatmenumodal").data("seatnum");
        ShowLoader();
        $.ajax({
            url: "/POS/PrintOrderSeat?OrderID=@Model.ID&Seat=" + seatnum,
            type: "POST",
            success: function (data, textStatus, jqXHR) {
                if (data.status = 0) {
                }
                HideLoader();
            },
            error: function (jqXHR, textStatus, errorThrown) {
                toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
            }
        });
    });

    function changeVisualMode() {
        if (!isClearMode()) {
            setCookie("clear_mode", true, 1);
        } else {
            eraseCookie("clear_mode");
        }

        setVisualMode();
    }

    function setVisualMode() {
        if (isClearMode()) {
            $('body').attr("data-theme", "clear");
        } else {
            $('body').attr("data-theme", "dark");
        }
    }

    function isClearMode() {
        var vMode = getCookie("clear_mode");

        if (!vMode) {
            return false;
        } else {
            return true;
        }
    }

    function setCookie(name, value, days) {
        var expires = "";
        if (days) {
            var date = new Date();
            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
            expires = "; expires=" + date.toUTCString();
        }
        document.cookie = name + "=" + (value || "") + expires + "; path=/";
    }

    function getCookie(name) {
        var nameEQ = name + "=";
        var ca = document.cookie.split(';');
        for (var i = 0; i < ca.length; i++) {
            var c = ca[i];
            while (c.charAt(0) == ' ') c = c.substring(1, c.length);
            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);
        }
        return null;
    }

    function eraseCookie(name) {
        document.cookie = name + '=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;';
    }

    //Modal Personalizado
    function CustomModalShow(modalid) {
        $(modalid).show();
        $(".product-content").find(".main").hide();
        $(".product-content").find(".sub-category").hide();
    }

    function CustomModalHide(modalid) {
        $(modalid).hide();
        $(".product-content").find(".main").show();
        $(".product-content").find(".sub-category").show();
    }

    function GetWorkDay() {
        $.ajax({
            url: "/Setting/GetDiaTrabajo",
            type: "GET",
            success: function (data, textStatus, jqXHR) {
                if (data == null) {
                    window.location.replace("/POS/logout");
                    return false;
                } else {
                    // Nada
                }
            },
            error: function (jqXHR, textStatus, errorThrown) {
                toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
            }
        });
    }

    $("#another-area").change(function () {
        var area = $(this).val();

        $.ajax({
            url: "/POS/GetAreaObjectsInArea?areaID=" + area,
            type: "POST",
            contentType: 'application/json',
            success: function (data, textStatus, jqXHR) {
                $("#another-area-tables").empty();
                $("#another-area-tables").append("<option>@ViewLocalizer["Choose target table"]</option>")
                if (data) {
                    for (var i = 0; i < data.objects.length; i++) {
                        if (obj.objectType == 1) {
                            $("#another-area-tables").append(`<option value="${obj.id}">${obj.name}</opion>`);
                        }
                    }
                }
            },
            error: function (jqXHR, textStatus, errorThrown) {
                toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
            }
        });
    })

    $("#moveareatable-submit").click(function () {
        var itemId = parseInt($("#moveareatablemodal").data("itemid"));
        var area = parseInt($("#another-area").val());
        var table = parseInt($("#another-area-tables").val());
        if (!area || !table) {
            toastr.error("@ViewLocalizer["Please select the area and table"]", {})
            return;
        }
        var data = {
            ItemId: itemId,
            TableId: table,
        }

        $.ajax({
            url: "/POS/MoveItemToAnotherTable",
            type: "POST",
            data: JSON.stringify(data),
            contentType: 'application/json;',
            dataType: 'json',
            success: function (data, textStatus, jqXHR) {
                LoadOrderItems();
                $("#movetablemodal").modal("hide");
            },
            error: function (jqXHR, textStatus, errorThrown) {
                toastr.error("@ViewLocalizer["There was an error in processing the request."]", {})
            }
        });

    });

    $("body").on("click", '.select-reason', function () {
        $(".select-reason").removeClass("active");
        $(this).addClass("active");
        $("#void-reason").data("id", $(this).data("id"));
    })
    
    $("body").on("click", '.select-reason-order', function () {
        $(".select-reason-order").removeClass("active");
        $(this).addClass("active");
        $("#void-reason-order").data("id", $(this).data("id"));
    })

    $("body").on("click", '.select-discount', function () {
        $(".select-discount").removeClass("active");
        $(this).addClass("active");
        $("#discount-list").data("id", $(this).data("id"));
    })
   
    $("body").on("click", '#discount-apply', function () {

          var id = $("#discount-list").data("id");
          SelectDiscount(id);
    })

    
    $("body").on("click", '.select-table', function () {
        $(".select-table").removeClass("active");
        $(this).addClass("active");
        $("#another-tables").data("id", $(this).data("id"));
    })

</script>



